# HG changeset patch
# User Johnny Stenback <jst@mozilla.com>
# Date 1303842998 25200
# Node ID 543d9d37ac76d7ae5929ba0715353af60ddc8870
# Parent  1594fc4ac379322cdb92e643aab5837ad1d969e1
Fix bug 649795. Crash when accessing mOwner which might not always be set.  r=bsmedberg

diff --git a/dom/plugins/base/nsPluginStreamListenerPeer.cpp b/dom/plugins/base/nsPluginStreamListenerPeer.cpp
--- a/dom/plugins/base/nsPluginStreamListenerPeer.cpp
+++ b/dom/plugins/base/nsPluginStreamListenerPeer.cpp
@@ -869,17 +869,17 @@ nsresult nsPluginStreamListenerPeer::Ser
     // Should call GetPluginPort() here.
     // This part is copied from nsPluginInstanceOwner::GetPluginPort(). 
     nsCOMPtr<nsIWidget> widget;
     ((nsPluginNativeWindow*)window)->GetPluginWidget(getter_AddRefs(widget));
     if (widget) {
       window->window = widget->GetNativeData(NS_NATIVE_PLUGIN_PORT);
     }
 #endif
-    mOwner->SetWindow();
+    owner->SetWindow();
   }
   
   mSeekable = PR_FALSE;
   mPStreamListener->OnStartBinding(this);
   mStreamOffset = 0;
   
   // force the plugin to use stream as file
   mStreamType = NP_ASFILE;
