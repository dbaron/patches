From: L. David Baron <dbaron@dbaron.org>

Give nsCSSFontFaceRule a copy-constructor that doesn't copy the reference count.  (Bug 601437)  r=bzbarsky  a2.0=blocking2.0:final

diff --git a/layout/style/crashtests/601437-1.html b/layout/style/crashtests/601437-1.html
new file mode 100644
--- /dev/null
+++ b/layout/style/crashtests/601437-1.html
@@ -0,0 +1,7 @@
+<!DOCTYPE html>
+<html>
+<head>
+<link id="s" rel="stylesheet" href="data:text/css,@font-face { font-family: 'F'; src: url('file:///404/'); }">
+</head>
+<body onload="document.getElementById('s').sheet.media.appendMedium('x');"></body>
+</html>
diff --git a/layout/style/crashtests/crashtests.list b/layout/style/crashtests/crashtests.list
--- a/layout/style/crashtests/crashtests.list
+++ b/layout/style/crashtests/crashtests.list
@@ -56,8 +56,9 @@ load 524252-1.html
 load font-face-truncated-src.html 
 load 536789-1.html
 load 565248-1.html
 load 558943-1.xhtml
 load 571105-1.xhtml
 load 573127-1.html
 load 580685.html
 load 592698-1.html
+load 601437-1.html
diff --git a/layout/style/nsCSSRules.h b/layout/style/nsCSSRules.h
--- a/layout/style/nsCSSRules.h
+++ b/layout/style/nsCSSRules.h
@@ -257,16 +257,22 @@ private:
   void* operator new(size_t size) CPP_THROW_NEW;
 };
 
 class NS_FINAL_CLASS nsCSSFontFaceRule : public nsCSSRule,
                                          public nsICSSRule,
                                          public nsIDOMCSSFontFaceRule
 {
 public:
+  nsCSSFontFaceRule() {}
+
+  nsCSSFontFaceRule(const nsCSSFontFaceRule& aCopy)
+    // copy everything except our reference count
+    : nsCSSRule(aCopy), mDecl(aCopy.mDecl) {}
+
   NS_DECL_ISUPPORTS
 
   // nsIStyleRule methods
 #ifdef DEBUG
   virtual void List(FILE* out = stdout, PRInt32 aIndent = 0) const;
 #endif
 
   // nsICSSRule methods
