Make things inside foreignObject reflow in response to style changes that cause reflow.  b=328829

diff -r aae58f19ba10 layout/svg/base/src/nsSVGForeignObjectFrame.cpp
--- a/layout/svg/base/src/nsSVGForeignObjectFrame.cpp	Thu Jan 25 13:59:55 2007 -0800
+++ b/layout/svg/base/src/nsSVGForeignObjectFrame.cpp	Thu Jan 25 14:23:36 2007 -0800
@@ -144,6 +144,20 @@ nsSVGForeignObjectFrame::DidSetStyleCont
   return NS_OK;
 }
 
+/* virtual */ void
+nsSVGForeignObjectFrame::MarkIntrinsicWidthsDirty()
+{
+  // Use the fact that we get a MarkIntrinsicWidthsDirty whenever
+  // there's a style change that requires reflow to actually cause that
+  // reflow, since the SVG outer frame doesn't know to reflow us.
+  nsIFrame* kid = GetFirstChild(nsnull);
+  if (!kid)
+    return;
+  kid->AddStateBits(NS_FRAME_IS_DIRTY);
+  GetPresContext()->PresShell()->FrameNeedsReflow(kid,
+                                                  nsIPresShell::eStyleChange);
+}
+
 NS_IMETHODIMP
 nsSVGForeignObjectFrame::Reflow(nsPresContext*           aPresContext,
                                 nsHTMLReflowMetrics&     aDesiredSize,
diff -r aae58f19ba10 layout/svg/base/src/nsSVGForeignObjectFrame.h
--- a/layout/svg/base/src/nsSVGForeignObjectFrame.h	Thu Jan 25 13:59:55 2007 -0800
+++ b/layout/svg/base/src/nsSVGForeignObjectFrame.h	Thu Jan 25 14:10:21 2007 -0800
@@ -78,6 +78,7 @@ public:
   }
 
   NS_IMETHOD DidSetStyleContext();
+  virtual void MarkIntrinsicWidthsDirty();
 
   NS_IMETHOD Reflow(nsPresContext*           aPresContext,
                     nsHTMLReflowMetrics&     aDesiredSize,
diff -r aae58f19ba10 layout/svg/base/src/nsSVGOuterSVGFrame.cpp
--- a/layout/svg/base/src/nsSVGOuterSVGFrame.cpp	Thu Jan 25 13:59:55 2007 -0800
+++ b/layout/svg/base/src/nsSVGOuterSVGFrame.cpp	Thu Jan 25 14:24:41 2007 -0800
@@ -228,10 +228,6 @@ nsSVGOuterSVGFrame::Reflow(nsPresContext
     // This means that something happened to one of our descendants
     // (excluding those inside svg:foreignObject, since
     // nsSVGForeignObjectFrame is a reflow root).
-
-    // XXXldb If this incremental reflow was the result of a style
-    // change to something that *contains* a foreignObject, then we're
-    // dropping the change completely on the floor!
     aStatus = NS_FRAME_COMPLETE;
     return NS_OK;
   }
