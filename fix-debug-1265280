From: L. David Baron <dbaron@dbaron.org>

Fix temporary debugging patch for bug 1265280 so we'll hit the condition.

MozReview-Commit-ID: 11gaY1Fz9nf

diff --git a/layout/base/nsDisplayList.cpp b/layout/base/nsDisplayList.cpp
--- a/layout/base/nsDisplayList.cpp
+++ b/layout/base/nsDisplayList.cpp
@@ -53,16 +53,17 @@
 #include "nsCanvasFrame.h"
 #include "StickyScrollContainer.h"
 #include "mozilla/AnimationPerformanceWarning.h"
 #include "mozilla/AnimationUtils.h"
 #include "mozilla/EffectCompositor.h"
 #include "mozilla/EventStates.h"
 #include "mozilla/LookAndFeel.h"
 #include "mozilla/PendingAnimationTracker.h"
+#include "mozilla/Poison.h"
 #include "mozilla/Preferences.h"
 #include "mozilla/UniquePtr.h"
 #include "mozilla/unused.h"
 #include "ActiveLayerTracker.h"
 #include "nsContentUtils.h"
 #include "nsPrintfCString.h"
 #include "UnitTransforms.h"
 #include "LayersLogging.h"
@@ -2158,17 +2159,17 @@ static bool IsContentLEQ(nsDisplayItem* 
   return nsLayoutUtils::CompareTreePosition(content1, content2, commonAncestor) <= 0;
 }
 
 static bool IsZOrderLEQ(nsDisplayItem* aItem1, nsDisplayItem* aItem2,
                         void* aClosure) {
   {
     // TEMPORARY debugging code for bug 1265280
     nsIFrame* f2 = aItem2->Frame();
-    if (!f2 || !f2->StyleContext()) {
+    if (uintptr_t(f2->StyleContext()) == mozPoisonValue()) {
       NS_RUNTIMEABORT(nsPrintfCString("bad display item %p type %s frame %p",
                                       aItem2, aItem2->Name(), f2).get());
     }
   }
   // Note that we can't just take the difference of the two
   // z-indices here, because that might overflow a 32-bit int.
   return aItem1->ZIndex() <= aItem2->ZIndex();
 }
