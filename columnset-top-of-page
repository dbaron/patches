From: L. David Baron <dbaron@dbaron.org>

Make nsColumnSetFrame set mIsTopOfPage only in an unconstrained-height situation, so it doesn't try to place things that don't fit in a set of columns at the very bottom of a page (or a containing column).  (FIXME: write patch and tests)

diff --git a/layout/generic/nsColumnSetFrame.cpp b/layout/generic/nsColumnSetFrame.cpp
--- a/layout/generic/nsColumnSetFrame.cpp
+++ b/layout/generic/nsColumnSetFrame.cpp
@@ -633,16 +633,18 @@ nsColumnSetFrame::ReflowChildren(nsHTMLR
       }
   
       if (reflowNext)
         child->AddStateBits(NS_FRAME_IS_DIRTY);
 
       nsHTMLReflowState kidReflowState(PresContext(), aReflowState, child,
                                        availSize, availSize.width,
                                        aReflowState.ComputedHeight());
+      // XXXldb We should only set mIsTopOfPage to true when we're
+      // currently in an unconstrained-height situation.
       kidReflowState.mFlags.mIsTopOfPage = PR_TRUE;
       kidReflowState.mFlags.mTableIsSplittable = PR_FALSE;
           
 #ifdef DEBUG_roc
       printf("*** Reflowing child #%d %p: availHeight=%d\n",
              columnCount, (void*)child,availSize.height);
 #endif
 
