From: L. David Baron <dbaron@dbaron.org>

Make the three CSS_PROP_INCLUDE_NOT_CSS properties much more like normal CSS properties, and (importantly) give them property IDs in the longhand range.  (Bug 636039)

diff --git a/layout/style/nsCSSDataBlock.cpp b/layout/style/nsCSSDataBlock.cpp
--- a/layout/style/nsCSSDataBlock.cpp
+++ b/layout/style/nsCSSDataBlock.cpp
@@ -331,18 +331,20 @@ nsCSSExpandedDataBlock::~nsCSSExpandedDa
 }
 
 const size_t
 nsCSSExpandedDataBlock::kOffsetTable[] = {
     #define CSS_PROP(name_, id_, method_, flags_, datastruct_, member_,        \
                      parsevariant_, kwtable_, stylestruct_, stylestructoffset_,\
                      animtype_)                                                \
         offsetof(nsCSSExpandedDataBlock, m##datastruct_.member_),
+    #define CSS_PROP_STUB_NOT_CSS size_t(-1),
     #include "nsCSSPropList.h"
     #undef CSS_PROP
+    #undef CSS_PROP_STUB_NOT_CSS
 };
 
 void
 nsCSSExpandedDataBlock::DoExpand(nsCSSCompressedDataBlock *aBlock,
                                  PRBool aImportant)
 {
     /*
      * Save needless copying and allocation by copying the memory
diff --git a/layout/style/nsCSSPropList.h b/layout/style/nsCSSPropList.h
--- a/layout/style/nsCSSPropList.h
+++ b/layout/style/nsCSSPropList.h
@@ -3267,51 +3267,57 @@ CSS_PROP_SVG(
     eStyleAnimType_EnumU8)
 
 // Callers that want information on the properties that are in
 // the style structs but not in the nsCSS* structs should define
 // |CSS_PROP_INCLUDE_NOT_CSS|.  (Some of these are also in nsRuleData*,
 // and a distinction might be needed at some point.)
 // The first 3 parameters don't matter, but some compilers don't like
 // empty arguments to macros.
-#ifdef CSS_PROP_INCLUDE_NOT_CSS
+#ifndef CSS_PROP_LIST_EXCLUDE_INTERNAL
+#ifdef CSS_PROP_STUB_NOT_CSS
+CSS_PROP_STUB_NOT_CSS
+CSS_PROP_STUB_NOT_CSS
+CSS_PROP_STUB_NOT_CSS
+#else
 CSS_PROP_VISIBILITY(
-    X,
-    X,
+    -x-lang,
+    _x_lang,
     Lang,
-    CSS_PROPERTY_PARSE_VALUE,
+    CSS_PROPERTY_PARSE_INACCESSIBLE,
     Display,
     mLang,
     0,
     nsnull,
     CSS_PROP_NO_OFFSET,
     eStyleAnimType_None)
 CSS_PROP_TABLE(
-    X,
-    X,
+    -x-cols,
+    _x_cols,
     Cols,
-    CSS_PROPERTY_PARSE_VALUE,
+    CSS_PROPERTY_PARSE_INACCESSIBLE,
     Table,
     mCols,
     0,
     nsnull,
     CSS_PROP_NO_OFFSET,
     eStyleAnimType_None)
 CSS_PROP_TABLE(
-    X,
-    X,
+    -x-span,
+    _x_span,
     Span,
-    CSS_PROPERTY_PARSE_VALUE,
+    CSS_PROPERTY_PARSE_INACCESSIBLE,
     Table,
     mSpan,
     0,
     nsnull,
     CSS_PROP_NO_OFFSET,
     eStyleAnimType_None)
-#endif /* defined(CSS_PROP_INCLUDE_NOT_CSS) */
+#endif /* !defined(CSS_PROP_STUB_NOT_CSS) */
+#endif /* !defined(CSS_PROP_EXCLUDE_INTERNAL) */
 
 #ifdef USED_CSS_PROP
 
 #undef USED_CSS_PROP
 #undef CSS_PROP_FONT
 #undef CSS_PROP_COLOR
 #undef CSS_PROP_BACKGROUND
 #undef CSS_PROP_LIST
