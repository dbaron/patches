From: L. David Baron <dbaron@dbaron.org>

Some additional debugging for bug 589457.

diff --git a/content/base/test/file_x-frame-options_page.sjs b/content/base/test/file_x-frame-options_page.sjs
--- a/content/base/test/file_x-frame-options_page.sjs
+++ b/content/base/test/file_x-frame-options_page.sjs
@@ -15,10 +15,10 @@ function handleRequest(request, response
     response.setHeader("X-Frame-Options", "DENY", false);
   }
   else if (query['xfo'] == "sameorigin") {
     response.setHeader("X-Frame-Options", "SAMEORIGIN", false);
   }
 
   // from the test harness we'll be checking for the presence of this element
   // to test if the page loaded
-  response.write("<h1 id=\"test\">" + query["testid"] + "</h1>");
+  response.write("<h1 id=\"test\" data-querystring=\"" + request.queryString + "\" data-xfo=\"" + query['xfo'] + "\">" + query["testid"] + "</h1>");
 }
diff --git a/content/base/test/test_x-frame-options.html b/content/base/test/test_x-frame-options.html
--- a/content/base/test/test_x-frame-options.html
+++ b/content/base/test/test_x-frame-options.html
@@ -78,16 +78,21 @@ var testFramesLoaded = function() {
   frame = harness.contentDocument.getElementById("sameorigin1");
   var test4 = frame.contentDocument.getElementById("test").textContent;
   is(test4, "sameorigin1", "test sameorigin1");
 
   // iframe from different origin, X-F-O: SAMEORIGIN - should not load
   frame = harness.contentDocument.getElementById("sameorigin2");
   var test5 = frame.contentDocument.getElementById("test");
   is(test5, null, "test sameorigin2");
+  if (test5) {
+    ok(false, "testid is " + test5.textContent);
+    ok(false, "queryString is " + test5.getAttribute("data-querystring"));
+    ok(false, "xfo is " + test5.getAttribute("data-xfo"));
+  }
 
   // call tests to check principal comparison, e.g. a document can open a window
   // to a data: or javascript: document which frames an
   // X-Frame-Options: SAMEORIGIN document and the frame should load
   testFrameInJSURI();
 }
 
 // test that a document can be framed under a javascript: URL opened by the
