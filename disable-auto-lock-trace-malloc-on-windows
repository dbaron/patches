From: L. David Baron <dbaron@dbaron.org>

Disable the nsAutoLock trace-malloc hooks on Windows, because the stack walking code is too slow there.

diff --git a/xpcom/glue/nsAutoLock.cpp b/xpcom/glue/nsAutoLock.cpp
--- a/xpcom/glue/nsAutoLock.cpp
+++ b/xpcom/glue/nsAutoLock.cpp
@@ -280,17 +280,18 @@ nsAutoLockBase::nsAutoLockBase(void* add
         if (stackTop->mAddr == addr) {
             // Ignore reentry: it's legal for monitors, and NSPR will assert
             // if you reenter a PRLock.
         } else if (!addr) {
             // Ignore null addresses: the caller promises not to use the
             // lock at all, and NSPR will assert if you enter it.
         } else {
             const void* node =
-#ifdef NS_TRACE_MALLOC
+// This is too slow for dbaron on Windows!
+#if defined(NS_TRACE_MALLOC) && (!defined(DEBUG_dbaron) || !defined(XP_WIN))
                 (const void*)NS_TraceMallocGetStackTrace();
 #else
                 nsnull
 #endif
                 ;
             nsNamedVector* vec1;
             nsNamedVector* vec2;
             PRUint32 i2;
