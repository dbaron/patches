From: L. David Baron <dbaron@dbaron.org>

Bug 980419 / 1230397 - Fix cases where B2G sets preferences off the main thread.

diff --git a/widget/gonk/nsAppShell.cpp b/widget/gonk/nsAppShell.cpp
--- a/widget/gonk/nsAppShell.cpp
+++ b/widget/gonk/nsAppShell.cpp
@@ -927,21 +927,23 @@ nsAppShell::CheckPowerKey()
     uint32_t deviceId = 0;
     int32_t powerState = AKEY_STATE_UNKNOWN;
 
     // EventHub doesn't report the number of devices.
     while (powerState != AKEY_STATE_DOWN && deviceId < 32) {
         powerState = mEventHub->getKeyCodeState(deviceId++, AKEYCODE_POWER);
     }
 
+#if 0
     // If Power is pressed while we startup, mark safe mode.
     // Consumers of the b2g.safe_mode preference need to listen on this
     // preference change to prevent startup races.
     Preferences::SetCString("b2g.safe_mode",
                             (powerState == AKEY_STATE_DOWN) ? "yes" : "no");
+#endif
     mPowerKeyChecked = true;
 }
 
 NS_IMETHODIMP
 nsAppShell::Observe(nsISupports* aSubject,
                     const char* aTopic,
                     const char16_t* aData)
 {
