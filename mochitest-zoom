From: L. David Baron <dbaron@dbaron.org>

Convert use of zoom API in style system mochitests to SpecialPowers.  (Bug 653461, patch 3)

diff --git a/layout/style/test/test_moz_device_pixel_ratio.html b/layout/style/test/test_moz_device_pixel_ratio.html
--- a/layout/style/test/test_moz_device_pixel_ratio.html
+++ b/layout/style/test/test_moz_device_pixel_ratio.html
@@ -24,28 +24,19 @@ https://bugzilla.mozilla.org/show_bug.cg
 <div id="zoom3" class="zoom-test"></div>
 <script class="testbody" type="application/javascript">
 
 /** Test for Bug 474356 **/
 
 SimpleTest.waitForExplicitFinish();
 
 function run() {
-  netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
-  viewer = window.QueryInterface(Components.interfaces.nsIInterfaceRequestor)
-                 .getInterface(Components.interfaces.nsIWebNavigation)
-                 .QueryInterface(Components.interfaces.nsIDocShell)
-                 .contentViewer
-                 .QueryInterface(Components.interfaces.nsIMarkupDocumentViewer);
-
-
   function zoom(factor) {
-    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
-    var previous = viewer.fullZoom;
-    viewer.fullZoom = factor;
+    var previous = SpecialPowers.getFullZoom(window);
+    SpecialPowers.setFullZoom(window, factor);
     return previous;
   }
 
   function isVisible(divName) {
     return window.getComputedStyle(document.getElementById(divName), null).visibility == "visible";
   }
 
   function getZoomRatio() {
