Fix incorrect uses of aInherited rather than inherited so that we can make aInherited const.  (Bug 476598)  r+sr=bzbarsky

diff --git a/layout/reftests/bugs/476598-1-ref.html b/layout/reftests/bugs/476598-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/476598-1-ref.html
@@ -0,0 +1,16 @@
+<!DOCTYPE HTML>
+<title>Test for incorrect inherited/aInherited use in -moz-transform-origin handling</title>
+<style type="text/css">
+
+p {
+  height: 20px;
+  width: 20px;
+  background: green;
+  margin: 0;
+}
+
+</style>
+<!-- scaled from bottom right -->
+<p style="margin-top: 40px; margin-left: 40px;"></p>
+<!-- scaled from 2x times bottom right -->
+<p style="margin-top: 30px; margin-left: 30px;"></p>
diff --git a/layout/reftests/bugs/476598-1-ref2.html b/layout/reftests/bugs/476598-1-ref2.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/476598-1-ref2.html
@@ -0,0 +1,15 @@
+<!DOCTYPE HTML>
+<title>Test for incorrect inherited/aInherited use in -moz-transform-origin handling</title>
+<style type="text/css">
+
+p {
+  -moz-transform: scale(2);
+  height: 10px;
+  width: 10px;
+  background: green;
+  margin: 50px;
+}
+
+</style>
+<p style="-moz-transform-origin: 10px 10px"></p>
+<p style="-moz-transform-origin: 20px 20px"></p>
diff --git a/layout/reftests/bugs/476598-1a.html b/layout/reftests/bugs/476598-1a.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/476598-1a.html
@@ -0,0 +1,16 @@
+<!DOCTYPE HTML>
+<title>Test for incorrect inherited/aInherited use in -moz-transform-origin handling</title>
+<style type="text/css">
+
+p {
+  -moz-transform-origin: 1em 1em;
+  -moz-transform: scale(2);
+  height: 10px;
+  width: 10px;
+  background: green;
+  margin: 50px;
+}
+
+</style>
+<p style="font-size: 10px"></p>
+<p style="font-size: 20px"></p>
diff --git a/layout/reftests/bugs/476598-1b.html b/layout/reftests/bugs/476598-1b.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/476598-1b.html
@@ -0,0 +1,20 @@
+<!DOCTYPE HTML>
+<title>Test for incorrect inherited/aInherited use in -moz-transform-origin handling</title>
+<style type="text/css">
+
+p {
+  -moz-transform-origin: inherit;
+  -moz-transform: scale(2);
+  height: 10px;
+  width: 10px;
+  background: green;
+  margin: 50px;
+}
+
+</style>
+<div style="-moz-transform-origin: 10px 10px">
+<p style="font-size: 10px"></p>
+</div>
+<div style="-moz-transform-origin: 20px 20px">
+<p style="font-size: 20px"></p>
+</div>
diff --git a/layout/reftests/bugs/reftest.list b/layout/reftests/bugs/reftest.list
--- a/layout/reftests/bugs/reftest.list
+++ b/layout/reftests/bugs/reftest.list
@@ -1037,8 +1037,13 @@ fails == 461512-1.html 461512-1-ref.html
 == 473847-1.xul 473847-1-ref.xul
 == 474336-1.xul 474336-1-ref.xul
 == 474417-1.html 474417-1-ref.html
 == 474472-1.html 474472-1-ref.html
 == 476063-1.html 476063-1-ref.html
 == 476063-2.html 476063-2-ref.html
 != 476063-3.html 476063-3-ref.html
 == 476063-4.xhtml 476063-4-ref.xhtml
+== 476598-1a.html 476598-1-ref.html
+== 476598-1a.html 476598-1-ref2.html
+== 476598-1b.html 476598-1-ref.html
+== 476598-1b.html 476598-1-ref2.html
+!= 476598-1-ref.html about:blank
diff --git a/layout/style/nsRuleNode.cpp b/layout/style/nsRuleNode.cpp
--- a/layout/style/nsRuleNode.cpp
+++ b/layout/style/nsRuleNode.cpp
@@ -3612,17 +3612,17 @@ nsRuleNode::ComputeDisplayData(void* aSt
       /* Convert lengths, percents, and inherit.  Default value is 50%. */
 #ifdef DEBUG
       PRBool result =
 #endif
         SetCoord(displayData.mTransformOrigin.mXValue,
                  display->mTransformOrigin[0],
                  parentDisplay->mTransformOrigin[0],
                  SETCOORD_LPH | SETCOORD_INITIAL_HALF,
-                 aContext, mPresContext, aInherited);
+                 aContext, mPresContext, inherited);
       NS_ASSERTION(result, "Malformed -moz-transform-origin parse!");
     }
 
     /* If Y coordinate is an enumerated type, handle it explicitly. */
     if (eCSSUnit_Enumerated == displayData.mTransformOrigin.mYValue.GetUnit())
       display->mTransformOrigin[1].SetPercentValue
         (GetFloatFromBoxPosition
          (displayData.mTransformOrigin.mYValue.GetIntValue()));
@@ -3630,17 +3630,17 @@ nsRuleNode::ComputeDisplayData(void* aSt
       /* Convert lengths, percents, initial, inherit. */
 #ifdef DEBUG
       PRBool result =
 #endif
         SetCoord(displayData.mTransformOrigin.mYValue,
                  display->mTransformOrigin[1],
                  parentDisplay->mTransformOrigin[1],
                  SETCOORD_LPH | SETCOORD_INITIAL_HALF,
-                 aContext, mPresContext, aInherited);
+                 aContext, mPresContext, inherited);
       NS_ASSERTION(result, "Malformed -moz-transform-origin parse!");
     }
   }
 
   COMPUTE_END_RESET(Display, display)
 }
 
 const void*
