From: Boris Zbarsky <bzbarsky@mit.edu>, L. David Baron <dbaron@dbaron.org>

Bug 1301500 - Add reftest.

(Test by bzbarsky; reference by dbaron.)

MozReview-Commit-ID: 7oIQFD8QKUn

diff --git a/layout/reftests/transform/dynamic-add-without-change-cb-1-ref.html b/layout/reftests/transform/dynamic-add-without-change-cb-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/transform/dynamic-add-without-change-cb-1-ref.html
@@ -0,0 +1,8 @@
+<!DOCTYPE html>
+<html>
+  The green square below should be centered.
+  <div style="width: 400px; height: 400px; position: absolute;
+              perspective: 600px; left: calc(50% - 200px);
+              top: calc(50% - 200px); background: green;">
+  </div>
+</html>
diff --git a/layout/reftests/transform/dynamic-add-without-change-cb-1.html b/layout/reftests/transform/dynamic-add-without-change-cb-1.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/transform/dynamic-add-without-change-cb-1.html
@@ -0,0 +1,11 @@
+<!DOCTYPE html>
+<html>
+  The green square below should be centered.
+  <div style="width: 400px; height: 400px; position: absolute;
+              perspective: 600px; left: 50%; top: 50%; background: green;">
+  </div>
+  <script>
+    document.body.offsetWidth;
+    document.querySelector("div").style.transform = "translate(-50%, -50%)";
+  </script>
+</html>
diff --git a/layout/reftests/transform/reftest.list b/layout/reftests/transform/reftest.list
--- a/layout/reftests/transform/reftest.list
+++ b/layout/reftests/transform/reftest.list
@@ -132,8 +132,10 @@ pref(svg.transform-box.enabled,true) == 
 == transform-origin-svg-1a.svg transform-origin-svg-1-ref.svg
 == transform-origin-svg-1b.svg transform-origin-svg-1-ref.svg
 == transform-origin-svg-2a.svg transform-origin-svg-2-ref.svg
 == transform-origin-svg-2b.svg transform-origin-svg-2-ref.svg
 # Bug 1122526
 == animate-layer-scale-inherit-1.html animate-layer-scale-inherit-1-ref.html
 == animate-layer-scale-inherit-2.html animate-layer-scale-inherit-2-ref.html
 == animate-layer-scale-inherit-3.html animate-layer-scale-inherit-1-ref.html
+# Bug 1301500
+== dynamic-add-without-change-cb-1.html dynamic-add-without-change-cb-1-ref.html
