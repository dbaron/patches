From: L. David Baron <dbaron@dbaron.org>

Add nsRuleData::ValueForBackgroundColor, etc., methods for each CSS property.  (Bug 636039)

diff --git a/layout/style/nsCSSPropList.h b/layout/style/nsCSSPropList.h
--- a/layout/style/nsCSSPropList.h
+++ b/layout/style/nsCSSPropList.h
@@ -59,17 +59,18 @@
   -. 'id' should be the same as 'name' except that all hyphens ('-')
   in 'name' are converted to underscores ('_') in 'id'. This lets us
   do nice things with the macros without having to copy/convert strings
   at runtime.  These are the names used for the enum values of the
   nsCSSProperty enumeration defined in nsCSSProps.h.
 
   -. 'method' is designed to be as input for CSS2Properties and similar
   callers.  It must always be the same as 'name' except it must use
-  InterCaps and all hyphens ('-') must be removed.
+  InterCaps and all hyphens ('-') must be removed.  This name is also
+  used by internal methods (nsRuleData::ValueFor*).
 
   -. 'flags', a bitfield containing CSS_PROPERTY_* flags.
 
   -. 'datastruct' says which nsRuleData* struct this property goes in.
 
   -. 'member' gives the name of the member variable in the nsRuleData
   struct.
 
diff --git a/layout/style/nsRuleData.h b/layout/style/nsRuleData.h
--- a/layout/style/nsRuleData.h
+++ b/layout/style/nsRuleData.h
@@ -106,11 +106,51 @@ struct nsRuleData
   /**
    * Return a pointer to the value object within |this| corresponding
    * to property |aProperty|.
    *
    * This function must only be called if the given property is in
    * mSIDs.
    */
   nsCSSValue* ValueFor(nsCSSProperty aProperty);
+
+  /**
+   * Getters like ValueFor(aProperty), but for each property by name
+   * (ValueForBackgroundColor, etc.), and more efficient than ValueFor.
+   * These use the names used for the property on DOM interfaces (the
+   * 'method' field in nsCSSPropList.h).
+   *
+   * Like ValueFor(), the caller must check that the property is within
+   * mSIDs.
+   */
+  #define CSS_PROP_INCLUDE_NOT_CSS
+  #define CSS_PROP(name_, id_, method_, flags_, datastruct_, member_,        \
+                   parsevariant_, kwtable_, stylestruct_, stylestructoffset_,\
+                   animtype_)                                                \
+    nsCSSValue* ValueFor##method_() {                                        \
+      NS_ABORT_IF_FALSE(mSIDs & NS_STYLE_INHERIT_BIT(stylestruct_),          \
+                        "Calling nsRuleData::ValueFor" #method_ " without "  \
+                        "NS_STYLE_INHERIT_BIT(" #stylestruct_ " in mSIDs."); \
+      nsRuleData##datastruct_ *cssstruct = m##datastruct_##Data;             \
+      NS_ABORT_IF_FALSE(cssstruct, "nsRuleNode::Get" #stylestruct_ "Data "   \
+                                   "set up nsRuleData incorrectly");         \
+      return &cssstruct->member_;                                            \
+    }                                                                        \
+    const nsCSSValue* ValueFor##method_() const {                            \
+      NS_ABORT_IF_FALSE(mSIDs & NS_STYLE_INHERIT_BIT(stylestruct_),          \
+                        "Calling nsRuleData::ValueFor" #method_ " without "  \
+                        "NS_STYLE_INHERIT_BIT(" #stylestruct_ " in mSIDs."); \
+      const nsRuleData##datastruct_ *cssstruct = m##datastruct_##Data;       \
+      NS_ABORT_IF_FALSE(cssstruct, "nsRuleNode::Get" #stylestruct_ "Data "   \
+                                   "set up nsRuleData incorrectly");         \
+      return &cssstruct->member_;                                            \
+    }
+  #define CSS_PROP_BACKENDONLY(name_, id_, method_, flags_, datastruct_,     \
+                               member_, parsevariant_, kwtable_)             \
+    /* empty; backend-only structs are not in nsRuleData  */
+  #include "nsCSSPropList.h"
+  #undef CSS_PROP_INCLUDE_NOT_CSS
+  #undef CSS_PROP
+  #undef CSS_PROP_BACKENDONLY
+
 };
 
 #endif
