From: L. David Baron <dbaron@dbaron.org>

Bug 1270626 - Explicitly suppress exceptions from media query listeners, rather than having them assert.

I'm acting under the assumption that this is what's closest to what the
code does now, except without asserting in ~ErrorResult.

This code should presumably go away when we change this code to use
EventListeners in bug 1265622, so I don't think there's any spec that
covers this.

MozReview-Commit-ID: 5kxp6jzGzX8

diff --git a/layout/base/nsPresContext.cpp b/layout/base/nsPresContext.cpp
--- a/layout/base/nsPresContext.cpp
+++ b/layout/base/nsPresContext.cpp
@@ -1912,16 +1912,17 @@ nsPresContext::MediaFeatureValuesChanged
     }
 
     if (!notifyList.IsEmpty()) {
       for (uint32_t i = 0, i_end = notifyList.Length(); i != i_end; ++i) {
         nsAutoMicroTask mt;
         MediaQueryList::HandleChangeData &d = notifyList[i];
         ErrorResult result;
         d.callback->Call(*d.mql, result);
+        result.SuppressException();
       }
     }
 
     // NOTE:  When |notifyList| goes out of scope, our destructor could run.
   }
 }
 
 void
