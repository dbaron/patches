# HG changeset patch
# User Julian Hector <julian.r.hector@gmail.com>
# Date 1468340694 -7200
# Node ID a8f4a928118799ec2087127d3f478b73f81599d2
# Parent  94c926911767cbaf285badaccc65b0365ae5bae0
Bug 1286119 - Allow sys_mremap when jemalloc is disabled. r=gcp

diff --git a/security/sandbox/linux/SandboxFilter.cpp b/security/sandbox/linux/SandboxFilter.cpp
--- a/security/sandbox/linux/SandboxFilter.cpp
+++ b/security/sandbox/linux/SandboxFilter.cpp
@@ -551,18 +551,18 @@ public:
       // Some fcntls have significant side effects like sending
       // arbitrary signals, and there's probably nontrivial kernel
       // attack surface; this should be locked down more if possible.
       return Allow();
 
     case __NR_mprotect:
     case __NR_brk:
     case __NR_madvise:
-#if defined(ANDROID) && !defined(MOZ_MEMORY)
-      // Android's libc's realloc uses mremap.
+#if !defined(MOZ_MEMORY)
+      // libc's realloc uses mremap (Bug 1286119).
     case __NR_mremap:
 #endif
       return Allow();
 
     case __NR_sigaltstack:
       return Allow();
 
 #ifdef __NR_set_thread_area
