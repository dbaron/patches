From: L. David Baron <dbaron@dbaron.org>

Reduce scope of :hover quirk:  make it apply normally if it has a class selector, and be quirky (only apply to links) only when actually global.  (Bug 197686)

diff --git a/layout/style/nsCSSRuleProcessor.cpp b/layout/style/nsCSSRuleProcessor.cpp
--- a/layout/style/nsCSSRuleProcessor.cpp
+++ b/layout/style/nsCSSRuleProcessor.cpp
@@ -1908,19 +1908,19 @@ static PRBool SelectorMatches(Element* a
 
       default:
         NS_ABORT_IF_FALSE(PR_FALSE, "How did that happen?");
       }
     } else {
       // Bit-based pseudo-classes
       if (statesToCheck.HasAtLeastOneOfStates(NS_EVENT_STATE_HOVER | NS_EVENT_STATE_ACTIVE) &&
           aTreeMatchContext.mCompatMode == eCompatibility_NavQuirks &&
-          // global selector (but don't check .class):
+          // global selector:
           !aSelector->HasTagSelector() && !aSelector->mIDList && 
-          !aSelector->mAttrList &&
+          !aSelector->mClassList && !aSelector->mAttrList &&
           // This (or the other way around) both make :not() asymmetric
           // in quirks mode (and it's hard to work around since we're
           // testing the current mNegations, not the first
           // (unnegated)). This at least makes it closer to the spec.
           !isNegated &&
           // important for |IsQuirkEventSensitive|:
           aElement->IsHTML() && !nsCSSRuleProcessor::IsLink(aElement) &&
           !IsQuirkEventSensitive(aElement->Tag())) {
