From: L. David Baron <dbaron@dbaron.org>

Avoid serializing calc() expressions in computed style when the calc() expression has no percentages and we have no percentage basis.  (Bug 585715)  r=bzbarsky

diff --git a/layout/style/nsComputedDOMStyle.cpp b/layout/style/nsComputedDOMStyle.cpp
--- a/layout/style/nsComputedDOMStyle.cpp
+++ b/layout/style/nsComputedDOMStyle.cpp
@@ -3939,18 +3939,21 @@ nsComputedDOMStyle::SetValueToCoord(nsRO
 
     case eStyleUnit_None:
       aValue->SetIdent(eCSSKeyword_none);
       break;
 
     default:
       if (aCoord.IsCalcUnit()) {
         nscoord percentageBase;
-        if (aPercentageBaseGetter &&
-            (this->*aPercentageBaseGetter)(percentageBase)) {
+        if (!aCoord.CalcHasPercent()) {
+          nscoord val = nsRuleNode::ComputeCoordPercentCalc(aCoord, 0);
+          aValue->SetAppUnits(NS_MAX(aMinAppUnits, NS_MIN(val, aMaxAppUnits)));
+        } else if (aPercentageBaseGetter &&
+                   (this->*aPercentageBaseGetter)(percentageBase)) {
           nscoord val =
             nsRuleNode::ComputeCoordPercentCalc(aCoord, percentageBase);
           aValue->SetAppUnits(NS_MAX(aMinAppUnits, NS_MIN(val, aMaxAppUnits)));
         } else {
           nsAutoString tmp;
           StyleCoordSerializeCalcOps ops(tmp);
           css::SerializeCalc(aCoord, ops);
           aValue->SetString(tmp); // not really SetString
