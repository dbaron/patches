Fix a static constructor in nsViewSourceHTML.

diff --git a/parser/htmlparser/src/nsParserModule.cpp b/parser/htmlparser/src/nsParserModule.cpp
--- a/parser/htmlparser/src/nsParserModule.cpp
+++ b/parser/htmlparser/src/nsParserModule.cpp
@@ -151,6 +151,7 @@ Shutdown(nsIModule* aSelf)
     nsDTDContext::ReleaseGlobalObjects();
     nsParser::Shutdown();
     CNewlineToken::FreeNewline();
+    CViewSourceHTML::Shutdown();
     gInitialized = PR_FALSE;
   }
 }
diff --git a/parser/htmlparser/src/nsViewSourceHTML.cpp b/parser/htmlparser/src/nsViewSourceHTML.cpp
--- a/parser/htmlparser/src/nsViewSourceHTML.cpp
+++ b/parser/htmlparser/src/nsViewSourceHTML.cpp
@@ -145,8 +145,15 @@ public:
   }
 
   static CSharedVSContext& GetSharedContext() {
-    static CSharedVSContext gSharedVSContext;
-    return gSharedVSContext;
+    if (!gSharedVSContext) {
+      gSharedVSContext = new CSharedVSContext;
+    }
+    return *gSharedVSContext;
+  }
+
+  static void Shutdown() {
+    delete gSharedVSContext;
+    gSharedVSContext = nsnull;
   }
 
   nsCParserNode       mEndNode;
@@ -155,7 +162,12 @@ public:
   CIndirectTextToken  mITextToken;
   nsCParserStartNode  mErrorNode;
   nsCParserNode       mEndErrorNode;
+
+private:
+  static CSharedVSContext *gSharedVSContext;
 };
+
+/* static */ CSharedVSContext *CSharedVSContext::gSharedVSContext = nsnull;
 
 enum {
   kStartTag = 0,
@@ -292,6 +304,11 @@ CViewSourceHTML::CViewSourceHTML()
  */
 CViewSourceHTML::~CViewSourceHTML(){
   mParser=0; //just to prove we destructed...
+}
+
+/* static */ void
+CViewSourceHTML::Shutdown(){
+  CSharedVSContext::Shutdown();
 }
 
 /**
diff --git a/parser/htmlparser/src/nsViewSourceHTML.h b/parser/htmlparser/src/nsViewSourceHTML.h
--- a/parser/htmlparser/src/nsViewSourceHTML.h
+++ b/parser/htmlparser/src/nsViewSourceHTML.h
@@ -67,6 +67,8 @@ public:
     CViewSourceHTML();
     virtual ~CViewSourceHTML();
 
+    static void Shutdown();
+
     /**
      * Set this to TRUE if you want the DTD to verify its
      * context stack.
