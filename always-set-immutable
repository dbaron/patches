From: L. David Baron <dbaron@dbaron.org>

Bug 978833 patch 14 - Always call Declaration::SetImmutable when we match a rule.

If we didn't make this change prior to patch 17, it would cause a
regression, because we'd only call SetImmutable on a StyleRule's first
mDeclaration.

diff --git a/layout/style/StyleRule.cpp b/layout/style/StyleRule.cpp
--- a/layout/style/StyleRule.cpp
+++ b/layout/style/StyleRule.cpp
@@ -1447,18 +1447,19 @@ NS_INTERFACE_MAP_END
 NS_IMPL_ADDREF(StyleRule)
 NS_IMPL_RELEASE(StyleRule)
 
 void
 StyleRule::RuleMatched()
 {
   if (!mWasMatched) {
     mWasMatched = true;
-    mDeclaration->SetImmutable();
   }
+
+  mDeclaration->SetImmutable();
 }
 
 /* virtual */ int32_t
 StyleRule::GetType() const
 {
   return Rule::STYLE_RULE;
 }
 
