Merge patch for when I apply both bug-368774-from-peterv and cycle-collector-debug-known-objects.

diff --git a/xpcom/base/nsCycleCollector.cpp b/xpcom/base/nsCycleCollector.cpp
--- a/xpcom/base/nsCycleCollector.cpp
+++ b/xpcom/base/nsCycleCollector.cpp
@@ -1806,8 +1806,9 @@ struct explainWalker : public GraphWalke
 struct explainWalker : public GraphWalker
 {
     explainWalker(GCTable &tab,
-                  nsCycleCollectionLanguageRuntime **runtimes)
-        : GraphWalker(tab, runtimes) 
+                  nsCycleCollectionLanguageRuntime **runtimes,
+                  nsCycleCollectionHelper *helpers) 
+        : GraphWalker(tab, runtimes, helpers) 
     {}
 
     PRBool ShouldVisitNode(void *p, PtrInfo const & pi) 
@@ -1856,7 +1857,7 @@ nsCycleCollector::ExplainLiveExpectedGar
         return;
     }
 
-    for (PRUint32 i = 0; i <= nsIProgrammingLanguage::MAX; ++i) {
+    for (PRUint32 i = 0; i <= NATIVE_LANG; ++i) {
         if (mRuntimes[i])
             mRuntimes[i]->BeginCycleCollection();
     }
@@ -1879,14 +1880,14 @@ nsCycleCollector::ExplainLiveExpectedGar
     for (int i = 0; i < mBufs[0]->GetSize(); ++i) {
         nsISupports *s = NS_STATIC_CAST(nsISupports *, mBufs[0]->ObjectAt(i));
         s = canonicalize(s);
-        explainWalker(mGraph, mRuntimes).Walk(s); 
+        explainWalker(mGraph, mRuntimes, mHelpers).Walk(s); 
     }
 
     mGraph.Clear();
 
     mCollectionInProgress = PR_FALSE;
 
-    for (PRUint32 i = 0; i <= nsIProgrammingLanguage::MAX; ++i) {
+    for (PRUint32 i = 0; i <= NATIVE_LANG; ++i) {
         if (mRuntimes[i])
             mRuntimes[i]->FinishCycleCollection();
     }    
