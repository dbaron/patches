From: L. David Baron <dbaron@dbaron.org>

Make trace-malloc work again on Linux following mozalloc landing.  (Bug 576776)

diff --git a/tools/trace-malloc/lib/Makefile.in b/tools/trace-malloc/lib/Makefile.in
--- a/tools/trace-malloc/lib/Makefile.in
+++ b/tools/trace-malloc/lib/Makefile.in
@@ -65,14 +65,16 @@ EXPORTS         = nsTraceMalloc.h
 
 EXTRA_DSO_LDOPTS = $(NSPR_LIBS) $(XPCOM_LIBS)
 
 ifeq ($(OS_ARCH),WINNT)
 CPPSRCS		+= nsDebugHelpWin32.cpp nsWinTraceMalloc.cpp
 OS_LIBS		+= shell32.lib ole32.lib uuid.lib imagehlp.lib
 endif
 
+DEFINES		+= -DMOZ_NO_MOZALLOC
+
 ifdef WRAP_SYSTEM_INCLUDES
 DEFINES		+= -DWRAP_SYSTEM_INCLUDES
 endif
 
 include $(topsrcdir)/config/rules.mk
 
