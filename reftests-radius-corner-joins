From: L. David Baron <dbaron@dbaron.org>

Add reftests for bug 500141.

diff --git a/layout/reftests/border-radius/corner-joins-1-ref.xhtml b/layout/reftests/border-radius/corner-joins-1-ref.xhtml
new file mode 100644
--- /dev/null
+++ b/layout/reftests/border-radius/corner-joins-1-ref.xhtml
@@ -0,0 +1,62 @@
+<?xml version="1.0"?>
+<html xmlns="http://www.w3.org/1999/xhtml"
+      xmlns:svg="http://www.w3.org/2000/svg">
+<title>border</title>
+<style type="text/css">
+@namespace url("http://www.w3.org/1999/xhtml");
+@namespace svg url("http://www.w3.org/2000/svg");
+
+div.wrapper {
+  float: left;
+  margin-left: 20pt;
+  margin-top: 10pt;
+}
+
+svg|svg {
+	display: block;
+	width: 146pt;
+	height: 122pt;
+	margin-right: -2pt;
+	margin-bottom: 20pt;
+}
+
+</style>
+<div class="wrapper">
+<svg:svg>
+  <svg:rect x="0" y="0" width="144pt" height="122pt" rx="61pt" ry="61pt"
+            fill="blue"/>
+  <svg:rect x="0" y="18pt" width="144pt" height="86pt" rx="61pt" ry="43pt"
+            fill="red"/>
+</svg:svg>
+<svg:svg>
+  <svg:clipPath id="topclip">
+    <svg:rect x="0" y="0" width="144pt" height="61pt"/>
+  </svg:clipPath>
+  <svg:clipPath id="botclip">
+    <svg:rect x="0" y="61pt" width="144pt" height="61pt"/>
+  </svg:clipPath>
+  <svg:rect x="0" y="0" width="144pt" height="122pt" rx="61pt" ry="61pt"
+            fill="black" clip-path="url(#topclip)"/>
+  <svg:rect x="0" y="0" width="144pt" height="122pt" rx="61pt" ry="61pt"
+            fill="blue" clip-path="url(#botclip)"/>
+  <svg:rect x="0" y="18pt" width="144pt" height="86pt" rx="61pt" ry="43pt"
+            fill="red"/>
+</svg:svg>
+</div>
+<div class="wrapper">
+<svg:svg>
+  <svg:rect x="0" y="0" width="146pt" height="122pt" rx="61pt" ry="61pt"
+            fill="blue"/>
+  <svg:rect x="0" y="18pt" width="146pt" height="86pt" rx="61pt" ry="43pt"
+            fill="red"/>
+</svg:svg>
+<svg:svg>
+  <svg:rect x="0" y="0" width="144pt" height="122pt" rx="61pt" ry="61pt"
+            fill="black" clip-path="url(#topclip)"/>
+  <svg:rect x="0" y="0" width="144pt" height="122pt" rx="61pt" ry="61pt"
+            fill="blue" clip-path="url(#botclip)"/>
+  <svg:rect x="0" y="18pt" width="144pt" height="86pt" rx="61pt" ry="43pt"
+            fill="red"/>
+</svg:svg>
+</div>
+</html>
diff --git a/layout/reftests/border-radius/corner-joins-1.xhtml b/layout/reftests/border-radius/corner-joins-1.xhtml
new file mode 100644
--- /dev/null
+++ b/layout/reftests/border-radius/corner-joins-1.xhtml
@@ -0,0 +1,51 @@
+<?xml version="1.0"?>
+<html xmlns="http://www.w3.org/1999/xhtml">
+<title>border</title>
+<style type="text/css">
+
+div.wrapper {
+  float: left;
+  margin-left: 20pt;
+  margin-top: 10pt;
+}
+
+div.test {
+	width: 144pt;
+	height: 86pt;
+	border-radius: 72pt;
+	border-top: 18pt solid;
+	border-bottom: 18pt solid;
+	background: red;
+	margin-bottom: 20pt;
+}
+
+#one {
+	border-color: blue;
+}
+
+#two {
+	border-bottom-color: blue;
+}
+
+#three {
+	border-color: blue;
+	border-left: 0.01px solid red;
+	border-right: 0.01px solid red;
+}
+
+#four {
+	border-bottom-color: blue;
+	border-left: 0.001px solid red;
+	border-right: 0.001px solid red;
+}
+
+</style>
+<div class="wrapper">
+<div class="test" id="one"></div>
+<div class="test" id="two"></div>
+</div>
+<div class="wrapper">
+<div class="test" id="three"></div>
+<div class="test" id="four"></div>
+</div>
+</html>
diff --git a/layout/reftests/border-radius/reftest.list b/layout/reftests/border-radius/reftest.list
--- a/layout/reftests/border-radius/reftest.list
+++ b/layout/reftests/border-radius/reftest.list
@@ -64,8 +64,11 @@ fails-if(cocoaWidget) == intersecting-cl
 # when border-collapse: collapse
 
 == invalidate-1a.html invalidate-1-ref.html
 == invalidate-1b.html invalidate-1-ref.html
 
 # test that border-radius is reduced for scrollbars
 == scrollbar-clamping-1.html scrollbar-clamping-1-ref.html
 == scrollbar-clamping-2.html scrollbar-clamping-2-ref.html
+
+# Test for bad corner joins.
+== corner-joins-1.xhtml corner-joins-1-ref.xhtml
