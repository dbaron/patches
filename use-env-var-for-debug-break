From: Nick Thomas <nthomas@mozilla.com>

When the XPCOM_DEBUG_BREAK environment variable is already set, don't override it.  This will make assertions fatal again on the leak test tinderboxes.  (Bug 463681)  r=ted.mielczarek

diff --git a/build/leaktest.py.in b/build/leaktest.py.in
--- a/build/leaktest.py.in
+++ b/build/leaktest.py.in
@@ -70,17 +70,18 @@ if __name__ == '__main__':
     t = threading.Thread(target=httpd.serve_forever)
     t.setDaemon(True)
     t.start()
 
     automation.initializeProfile(PROFILE_DIRECTORY)
     browserEnv = dict(os.environ)
 
     browserEnv["NO_EM_RESTART"] = "1"
-    browserEnv["XPCOM_DEBUG_BREAK"] = "warn"
+    if not "XPCOM_DEBUG_BREAK" in browserEnv:
+        browserEnv["XPCOM_DEBUG_BREAK"] = "stack"
     if automation.UNIXISH:
         browserEnv["LD_LIBRARY_PATH"] = os.path.join(SCRIPT_DIR, DIST_BIN)
         browserEnv["MOZILLA_FIVE_HOME"] = os.path.join(SCRIPT_DIR, DIST_BIN)
         browserEnv["GNOME_DISABLE_CRASH_DIALOG"] = "1"
 
     automation.runApp("http://localhost:%d/bloatcycle.html" % PORT, browserEnv,
                       os.path.join(SCRIPT_DIR, automation.DEFAULT_APP),
                       PROFILE_DIRECTORY, extraArgs)
