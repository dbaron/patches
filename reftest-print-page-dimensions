From: L. David Baron <dbaron@dbaron.org>

Add reftests to check that the reftest-print page dimensions are as expected.

diff --git a/layout/reftests/reftest-sanity/page-height-2.1in.html b/layout/reftests/reftest-sanity/page-height-2.1in.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/reftest-sanity/page-height-2.1in.html
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML>
+<html class="reftest-print">
+<title>Test that reftest-print page content height is 2 inches (3 inch page, half inch margins)</title>
+<style>
+body { margin: 0 }
+div { height: 2.1in; }
+</style>
+<div>hello</div>
diff --git a/layout/reftests/reftest-sanity/page-height-2in.html b/layout/reftests/reftest-sanity/page-height-2in.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/reftest-sanity/page-height-2in.html
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML>
+<html class="reftest-print">
+<title>Test that reftest-print page content height is 2 inches (3 inch page, half inch margins)</title>
+<style>
+body { margin: 0 }
+div { height: 2in; }
+</style>
+<div>hello</div>
diff --git a/layout/reftests/reftest-sanity/page-height-forcebreak.html b/layout/reftests/reftest-sanity/page-height-forcebreak.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/reftest-sanity/page-height-forcebreak.html
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML>
+<html class="reftest-print">
+<title>Test that reftest-print page content height is 2 inches (3 inch page, half inch margins)</title>
+<style>
+body { margin: 0 }
+</style>
+<div>hello</div>
+<div style="page-break-before: always">&nbsp;</div>
diff --git a/layout/reftests/reftest-sanity/page-height-nobreak.html b/layout/reftests/reftest-sanity/page-height-nobreak.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/reftest-sanity/page-height-nobreak.html
@@ -0,0 +1,7 @@
+<!DOCTYPE HTML>
+<html class="reftest-print">
+<title>Test that reftest-print page content height is 2 inches (3 inch page, half inch margins)</title>
+<style>
+body { margin: 0 }
+</style>
+<div>hello</div>
diff --git a/layout/reftests/reftest-sanity/page-width-3.9in.html b/layout/reftests/reftest-sanity/page-width-3.9in.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/reftest-sanity/page-width-3.9in.html
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML>
+<html class="reftest-print">
+<title>Test that reftest-print page content width is 4 inches (5 inch page, half inch margins)</title>
+<style>
+body { margin: 0 }
+div { background: blue; color: white; width: 3.9in; }
+</style>
+<div>hello</div>
diff --git a/layout/reftests/reftest-sanity/page-width-4.1in.html b/layout/reftests/reftest-sanity/page-width-4.1in.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/reftest-sanity/page-width-4.1in.html
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML>
+<html class="reftest-print">
+<title>Test that reftest-print page content width is 4 inches (5 inch page, half inch margins)</title>
+<style>
+body { margin: 0 }
+div { background: blue; color: white; width: 4.1in; }
+</style>
+<div>hello</div>
diff --git a/layout/reftests/reftest-sanity/page-width-4in.html b/layout/reftests/reftest-sanity/page-width-4in.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/reftest-sanity/page-width-4in.html
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML>
+<html class="reftest-print">
+<title>Test that reftest-print page content width is 4 inches (5 inch page, half inch margins)</title>
+<style>
+body { margin: 0 }
+div { background: blue; color: white; width: 4in; }
+</style>
+<div>hello</div>
diff --git a/layout/reftests/reftest-sanity/page-width-auto.html b/layout/reftests/reftest-sanity/page-width-auto.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/reftest-sanity/page-width-auto.html
@@ -0,0 +1,8 @@
+<!DOCTYPE HTML>
+<html class="reftest-print">
+<title>Test that reftest-print page content width is 4 inches (5 inch page, half inch margins)</title>
+<style>
+body { margin: 0 }
+div { background: blue; color: white; }
+</style>
+<div>hello</div>
diff --git a/layout/reftests/reftest-sanity/reftest.list b/layout/reftests/reftest-sanity/reftest.list
--- a/layout/reftests/reftest-sanity/reftest.list
+++ b/layout/reftests/reftest-sanity/reftest.list
@@ -65,8 +65,16 @@ include scripttests.list
 # test url-prefix
 include urlprefixtests.list
 
 # test that all corners are visible
 != corners-1.html corners-1-ref.html
 != corners-2.html corners-2-ref.html
 != corners-3.html corners-3-ref.html
 != corners-4.html corners-4-ref.html
+
+# Test that the harness gives the correct page dimensions.
+!= page-width-3.9in.html page-width-4in.html
+== page-width-4.1in.html page-width-4in.html
+== page-width-auto.html page-width-4in.html
+!= page-height-2in.html page-height-2.1in.html
+== page-height-2in.html page-height-nobreak.html
+== page-height-2.1in.html page-height-forcebreak.html
