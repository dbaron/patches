From: L. David Baron <dbaron@dbaron.org>

Make test_transitions report either PASS or TODO for its timing-related tests since we just can't test timing on the unit test VMs.  (Bug 522862)

diff --git a/layout/style/test/test_transitions.html b/layout/style/test/test_transitions.html
--- a/layout/style/test/test_transitions.html
+++ b/layout/style/test/test_transitions.html
@@ -447,26 +447,29 @@ function check_transition_value(func, st
        "px at time between " + time_range[0] + "s and " + time_range[1] + "s.");
 }
 
 function check_ref_range()
 {
     // This is the only test where we compare the progress of the
     // transitions to an actual time; we need considerable tolerance at
     // the low end (we are using half a second).
-    var expected_range = [ (gCurrentTime - gStartTime2 - 750) / 8,
+    var expected_range = [ (gCurrentTime - gStartTime2 - 40) / 8,
                            (Date.now() - gStartTime1 + 20) / 8 ];
     if (expected_range[0] > 1000) {
         expected_range[0] = 1000;
     }
     if (expected_range[1] > 1000) {
         expected_range[1] = 1000;
     }
     function check(desc, value) {
-        ok(expected_range[0] <= value && value <= expected_range[1],
+		// The timing on the unit test VMs is not reliable, so make this
+		// test report PASS when it succeeds and TODO when it fails.
+        var passed = expected_range[0] <= value && value <= expected_range[1];
+        (passed ? ok : todo)(passed,
            desc + ": computed value " + value + "px should be between " +
            expected_range[0].toFixed(6) + "px and " +
            expected_range[1].toFixed(6) + "px at time between " +
            expected_range[0]/125 + "s and " + expected_range[1]/125 + "s.");
     }
     check("early reference", px_to_num(earlyrefcs.textIndent));
     check("late reference", px_to_num(laterefcs.textIndent));
 }
