# HG changeset patch
# Parent 4911af40708f1b1dcf5bd563264b0dff973625bc
Bug 597676. If there's no rootPresContext, we should never detect DOM modification. Makes printing paint again. r=dbaron a=blocking2.0:beta7

diff --git a/layout/base/FrameLayerBuilder.cpp b/layout/base/FrameLayerBuilder.cpp
--- a/layout/base/FrameLayerBuilder.cpp
+++ b/layout/base/FrameLayerBuilder.cpp
@@ -1691,17 +1691,17 @@ FrameLayerBuilder::DrawThebesLayer(Thebe
   if (setClipRect) {
     aContext->Restore();
   }
 }
 
 PRBool
 FrameLayerBuilder::CheckDOMModified()
 {
-  if (mRootPresContext &&
+  if (!mRootPresContext ||
       mInitialDOMGeneration == mRootPresContext->GetDOMGeneration())
     return PR_FALSE;
   if (mDetectedDOMModification) {
     // Don't spam the console with extra warnings
     return PR_TRUE;
   }
   mDetectedDOMModification = PR_TRUE;
   // Painting is not going to complete properly. There's not much
