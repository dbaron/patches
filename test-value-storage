Get test_value_storage running.

diff --git a/layout/style/test/Makefile.in b/layout/style/test/Makefile.in
--- a/layout/style/test/Makefile.in
+++ b/layout/style/test/Makefile.in
@@ -75,6 +75,7 @@ _TEST_FILES = 	test_bug302186.html \
 		test_initial_storage.html \
 		test_property_database.html \
 		test_property_syntax_errors.html \
+		test_value_storage.html \
 		css_properties.js \
 		property_database.js \
 		$(NULL)
diff --git a/layout/style/test/test_value_storage.html b/layout/style/test/test_value_storage.html
--- a/layout/style/test/test_value_storage.html
+++ b/layout/style/test/test_value_storage.html
@@ -114,8 +114,34 @@ function test_property(property)
     test_value(info.other_values[idx]);
 }
 
+// To avoid triggering the slow script dialog, we have to test one
+// property at a time.
+SimpleTest.waitForExplicitFinish();
+var props = [];
 for (var prop in gCSSProperties)
-  test_property(prop);
+  props.push(prop);
+props = props.reverse();
+function do_one(l) {
+  if (l.length == 0) {
+    // SimpleTest.finish() is really slow, so we have to disable the
+    // slow script dialog for this part
+    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
+    var prefService = Components.classes["@mozilla.org/preferences-service;1"].
+                        getService(Components.interfaces.nsIPrefService);
+    var domBranch = prefService.getBranch("dom.");
+    var oldVal = domBranch.getIntPref("max_script_run_time");
+    domBranch.setIntPref("max_script_run_time", 0);
+
+    SimpleTest.finish();
+
+    domBranch.setIntPref("max_script_run_time", oldVal);
+
+    return;
+  }
+  test_property(l.pop());
+  setTimeout(do_one, 0, l);
+}
+setTimeout(do_one, 0, props);
 
 </script>
 </pre>
