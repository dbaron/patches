From: Gavin Sharp <gavin@gavinsharp.com>, L. David Baron <dbaron@dbaron.org>

Fixes to allow MOZ_APP_DISPLAYNAME to have spaces in it.  (Bug 543564)

diff --git a/browser/components/feeds/src/Makefile.in b/browser/components/feeds/src/Makefile.in
--- a/browser/components/feeds/src/Makefile.in
+++ b/browser/components/feeds/src/Makefile.in
@@ -45,18 +45,18 @@ MODULE = browser_feeds
 LIBRARY_NAME = browser_feeds_s
 FORCE_STATIC_LIB = 1
 FORCE_USE_PIC = 1
 ifndef MOZ_MEMORY
 USE_STATIC_LIBS = 1
 endif
 
 DEFINES += \
-	-DMOZ_APP_NAME=$(MOZ_APP_NAME) \
-	-DMOZ_APP_DISPLAYNAME=$(MOZ_APP_DISPLAYNAME) \
+	-DMOZ_APP_NAME="$(MOZ_APP_NAME)" \
+	-DMOZ_APP_DISPLAYNAME="$(MOZ_APP_DISPLAYNAME)" \
 	$(NULL)
 
 EXTRA_PP_COMPONENTS = \
 	FeedConverter.js \
 	FeedWriter.js \
 	WebContentConverter.js \
 	$(NULL)
 
diff --git a/browser/components/preferences/Makefile.in b/browser/components/preferences/Makefile.in
--- a/browser/components/preferences/Makefile.in
+++ b/browser/components/preferences/Makefile.in
@@ -45,18 +45,18 @@ include $(DEPTH)/config/autoconf.mk
 
 ifdef ENABLE_TESTS
 DIRS += tests
 endif
 
 include $(topsrcdir)/config/rules.mk
 
 DEFINES += \
-	-DMOZ_APP_NAME=$(MOZ_APP_NAME) \
-	-DMOZ_APP_DISPLAYNAME=$(MOZ_APP_DISPLAYNAME) \
+	-DMOZ_APP_NAME="$(MOZ_APP_NAME)" \
+	-DMOZ_APP_DISPLAYNAME="$(MOZ_APP_DISPLAYNAME)" \
 	$(NULL)
 
 ifneq (,$(filter windows gtk2 cocoa, $(MOZ_WIDGET_TOOLKIT)))
 DEFINES += -DHAVE_SHELL_SERVICE=1
 endif
 
 ifdef MOZ_UPDATER
 DEFINES += -DMOZ_UPDATER=1
diff --git a/browser/installer/windows/Makefile.in b/browser/installer/windows/Makefile.in
--- a/browser/installer/windows/Makefile.in
+++ b/browser/installer/windows/Makefile.in
@@ -74,20 +74,20 @@ BRANDING_FILES_CONV = \
 
 BRANDING_FILES = \
 	wizHeader.bmp \
 	wizHeaderRTL.bmp \
 	wizWatermark.bmp \
 	$(NULL)
 
 DEFINES += \
-	-DAB_CD=$(AB_CD) \
-	-DMOZ_APP_NAME=$(MOZ_APP_NAME) \
-	-DMOZ_APP_DISPLAYNAME=${MOZ_APP_DISPLAYNAME} \
-	-DMOZILLA_VERSION=${MOZILLA_VERSION} \
+	-DAB_CD="$(AB_CD)" \
+	-DMOZ_APP_NAME="$(MOZ_APP_NAME)" \
+	-DMOZ_APP_DISPLAYNAME="$(MOZ_APP_DISPLAYNAME)" \
+	-DMOZILLA_VERSION="$(MOZILLA_VERSION)" \
 	$(NULL)
 
 include $(topsrcdir)/config/config.mk
 
 installer::
 	$(MAKE) -C .. installer-stage
 	$(MAKE) $(CONFIG_DIR)/setup.exe
 
diff --git a/build/automation-build.mk b/build/automation-build.mk
--- a/build/automation-build.mk
+++ b/build/automation-build.mk
@@ -6,22 +6,22 @@ endif
 
 TARGET_DIST = $(TARGET_DEPTH)/dist
 
 ifeq ($(MOZ_BUILD_APP),camino)
 browser_path = \"$(TARGET_DIST)/Camino.app/Contents/MacOS/Camino\"
 else
 ifeq ($(OS_ARCH),Darwin)
 ifdef MOZ_DEBUG
-browser_path = \"$(TARGET_DIST)/$(MOZ_APP_DISPLAYNAME)Debug.app/Contents/MacOS/$(PROGRAM)\"
+browser_path = "\"$(TARGET_DIST)/$(MOZ_APP_DISPLAYNAME)Debug.app/Contents/MacOS/$(PROGRAM)\""
 else
-browser_path = \"$(TARGET_DIST)/$(MOZ_APP_DISPLAYNAME).app/Contents/MacOS/$(PROGRAM)\"
+browser_path = "\"$(TARGET_DIST)/$(MOZ_APP_DISPLAYNAME).app/Contents/MacOS/$(PROGRAM)\""
 endif
 else
-browser_path = \"$(TARGET_DIST)/bin/$(PROGRAM)\"
+browser_path = "\"$(TARGET_DIST)/bin/$(PROGRAM)\""
 endif
 endif
 
 _PROFILE_DIR = $(TARGET_DEPTH)/_profile/pgo
 
 ABSOLUTE_TOPSRCDIR = $(call core_abspath,$(MOZILLA_DIR))
 _CERTS_SRC_DIR = $(ABSOLUTE_TOPSRCDIR)/build/pgo/certs
 
diff --git a/widget/src/os2/Makefile.in b/widget/src/os2/Makefile.in
--- a/widget/src/os2/Makefile.in
+++ b/widget/src/os2/Makefile.in
@@ -99,17 +99,17 @@ endif
 include $(topsrcdir)/config/rules.mk
 
 CXXFLAGS += $(MOZ_CAIRO_CFLAGS)
 
 DEFINES		+= -D_IMPL_NS_WIDGET
 
 DEFINES += -DUSE_OS2_TOOLKIT_HEADERS
 
-DEFINES += -DMOZ_APP_DISPLAYNAME=\"$(MOZ_APP_DISPLAYNAME)\"
+DEFINES += -DMOZ_APP_DISPLAYNAME="\"$(MOZ_APP_DISPLAYNAME)\""
 
 LOCAL_INCLUDES	= -I. -I$(srcdir)/../xpwidgets -I$(srcdir)
 
 install-readme:	README.$(MOZ_APP_NAME)
 ifneq (,$(filter-out xulrunner sunbird,$(MOZ_APP_NAME)))
 	cp -f $^ $(DIST)/bin/README.txt
 endif
 
