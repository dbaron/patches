Don't call SelectorMatches on document fragments.  b=437170

diff --git a/layout/style/nsCSSRuleProcessor.cpp b/layout/style/nsCSSRuleProcessor.cpp
--- a/layout/style/nsCSSRuleProcessor.cpp
+++ b/layout/style/nsCSSRuleProcessor.cpp
@@ -1736,17 +1736,19 @@ static PRBool SelectorMatchesTree(RulePr
       }
     }
     // for descendant combinators and child combinators, the content
     // to test against is the parent
     else {
       data = prevdata->mParentData;
       if (!data) {
         nsIContent *content = prevdata->mContent->GetParent();
-        if (content) {
+        // GetParent could return a document fragment; we only want
+        // element parents.
+        if (content && content->IsNodeOfType(nsINode::eELEMENT)) {
           data = new (prevdata->mPresContext)
                       RuleProcessorData(prevdata->mPresContext, content,
                                         prevdata->mRuleWalker,
                                         &prevdata->mCompatMode);
           prevdata->mParentData = data;    
         }
       }
     }
