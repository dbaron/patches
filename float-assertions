Keep width of avail space rect at least 0.  (Bug 476372)  r+sr=roc

diff --git a/layout/generic/nsBlockReflowState.cpp b/layout/generic/nsBlockReflowState.cpp
--- a/layout/generic/nsBlockReflowState.cpp
+++ b/layout/generic/nsBlockReflowState.cpp
@@ -348,16 +348,19 @@ nsBlockReflowState::GetAvailableSpace(ns
   PRBool hasFloats;
   mAvailSpaceRect = 
     mFloatManager->GetBand(aY - BorderPadding().top, 
                            aRelaxHeightConstraint ? nscoord_MAX
                                                   : mContentArea.height,
                            mContentArea.width,
                            &hasFloats);
   mBandHasFloats = hasFloats;
+  // Keep the width >= 0 for compatibility with nsSpaceManager.
+  if (mAvailSpaceRect.width < 0)
+    mAvailSpaceRect.width = 0;
 
 #ifdef DEBUG
   if (nsBlockFrame::gNoisyReflow) {
     nsFrame::IndentBy(stdout, nsBlockFrame::gNoiseIndent);
     printf("GetAvailableSpace: band=%d,%d,%d,%d hasfloats=%d\n",
            mAvailSpaceRect.x, mAvailSpaceRect.y,
            mAvailSpaceRect.width, mAvailSpaceRect.height,
            mBandHasFloats);
