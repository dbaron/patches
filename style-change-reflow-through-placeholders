Correctly handle a style change reflow on a subtree that has placeholders with out of flows outside that subtree.  (Bug 363247)

diff --git a/layout/base/nsPresShell.cpp b/layout/base/nsPresShell.cpp
--- a/layout/base/nsPresShell.cpp
+++ b/layout/base/nsPresShell.cpp
@@ -3183,16 +3183,24 @@ PresShell::FrameNeedsReflow(nsIFrame *aF
     nsVoidArray stack;
     stack.AppendElement(aFrame);
 
     while (stack.Count() != 0) {
       nsIFrame *f =
         static_cast<nsIFrame*>(stack.FastElementAt(stack.Count() - 1));
       stack.RemoveElementAt(stack.Count() - 1);
 
+      if (f->GetType() == nsLayoutAtoms::placeholderFrame) {
+        nsPlaceholderFrame *ph = static_cast<nsPlaceholderFrame*>(f);
+        nsIFrame *oof = ph->GetOutOfFlowFrame();
+        if (!nsLayoutUtils::IsProperAncestorFrame(aFrame, oof)) {
+          // XXX enqueue for recursive call at end
+        }
+      }
+
       PRInt32 childListIndex = 0;
       nsIAtom *childListName;
       do {
         childListName = f->GetAdditionalChildListName(childListIndex++);
         for (nsIFrame *kid = f->GetFirstChild(childListName); kid;
              kid = kid->GetNextSibling()) {
           kid->MarkIntrinsicWidthsDirty();
           stack.AppendElement(kid);
