From: L. David Baron <dbaron@dbaron.org>

Bug 960465 patch N - Remove code from RebuildAllStyleData that is designed to deal with animation restyles being posted.

diff --git a/layout/base/RestyleManager.cpp b/layout/base/RestyleManager.cpp
--- a/layout/base/RestyleManager.cpp
+++ b/layout/base/RestyleManager.cpp
@@ -1415,16 +1415,20 @@ RestyleManager::RestyleForRemove(Element
       }
     }
   }
 }
 
 void
 RestyleManager::RebuildAllStyleData(nsChangeHint aExtraHint)
 {
+  // Note that we can *almost* implement this by just posting a style
+  // change -- except we really need to restyle the root frame rather
+  // than the root element's primary frame.
+
   NS_ASSERTION(!(aExtraHint & nsChangeHint_ReconstructFrame),
                "Should not reconstruct the root of the frame tree.  "
                "Use ReconstructDocElementHierarchy instead.");
 
   mRebuildAllStyleData = false;
   NS_UpdateHint(aExtraHint, mRebuildAllExtraHint);
   mRebuildAllExtraHint = nsChangeHint(0);
 
@@ -1495,22 +1499,16 @@ RestyleManager::RebuildAllStyleData(nsCh
                         nsRestyleHint(eRestyle_Subtree |
                                       eRestyle_ForceDescendants));
 
   mPostAnimationRestyles = false;
   mSkipAnimationRules = false;
 #ifdef DEBUG
   mIsProcessingRestyles = false;
 #endif
-
-  // Make sure that we process any pending animation restyles from the
-  // above style change.  Note that we can *almost* implement the above
-  // by just posting a style change -- except we really need to restyle
-  // the root frame rather than the root element's primary frame.
-  ProcessPendingRestyles();
 }
 
 void
 RestyleManager::DoRebuildAllStyleData(RestyleTracker& aRestyleTracker,
                                       nsChangeHint aExtraHint,
                                       nsRestyleHint aRestyleHint)
 {
   // Tell the style set to get the old rule tree out of the way
