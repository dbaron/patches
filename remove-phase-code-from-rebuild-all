From: L. David Baron <dbaron@dbaron.org>

Bug 960465 patch N - Remove code from RebuildAllStyleData that is designed to deal with animation restyles being posted.

diff --git a/layout/base/RestyleManager.cpp b/layout/base/RestyleManager.cpp
--- a/layout/base/RestyleManager.cpp
+++ b/layout/base/RestyleManager.cpp
@@ -1392,16 +1392,20 @@ RestyleManager::RestyleForRemove(Element
       }
     }
   }
 }
 
 void
 RestyleManager::RebuildAllStyleData(nsChangeHint aExtraHint)
 {
+  // Note that we can *almost* implement this by just posting a style
+  // change -- except we really need to restyle the root frame rather
+  // than the root element's primary frame.
+
   NS_ASSERTION(!(aExtraHint & nsChangeHint_ReconstructFrame),
                "Should not reconstruct the root of the frame tree.  "
                "Use ReconstructDocElementHierarchy instead.");
 
   mRebuildAllStyleData = false;
   NS_UpdateHint(aExtraHint, mRebuildAllExtraHint);
   mRebuildAllExtraHint = nsChangeHint(0);
 
@@ -1455,22 +1459,16 @@ RestyleManager::RebuildAllStyleData(nsCh
   // eRestyle_Subtree because they're changing things that affect data
   // computation rather than selector matching; we could have a restyle
   // hint passed in, and substantially improve the performance of things
   // like pref changes and the restyling that we do for downloadable
   // font loads.
   DoRebuildAllStyleData(mPendingRestyles, aExtraHint, eRestyle_Subtree);
 
   mPresContext->SetProcessingRestyles(false);
-
-  // Make sure that we process any pending animation restyles from the
-  // above style change.  Note that we can *almost* implement the above
-  // by just posting a style change -- except we really need to restyle
-  // the root frame rather than the root element's primary frame.
-  ProcessPendingRestyles();
 }
 
 void
 RestyleManager::DoRebuildAllStyleData(RestyleTracker& aRestyleTracker,
                                       nsChangeHint aExtraHint,
                                       nsRestyleHint aRestyleHint)
 {
   // Tell the style set to get the old rule tree out of the way
