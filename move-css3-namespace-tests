From: L. David Baron <dbaron@dbaron.org>

Move the imported css3-namespace test suite in with other test suites imported from the CSSWG repository, and make the importing script import it.

diff --git a/layout/reftests/css-namespace/LICENSE b/layout/reftests/css-namespace/LICENSE
deleted file mode 100644
--- a/layout/reftests/css-namespace/LICENSE
+++ /dev/null
@@ -1,9 +0,0 @@
-W3C 3-clause BSD License
-
-Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
-
-    * Redistributions of works must retain the original copyright notice, this list of conditions and the following disclaimer.
-    * Redistributions in binary form must reproduce the original copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
-    * Neither the name of the W3C nor the names of its contributors may be used to endorse or promote products derived from this work without specific prior written permission.
-
-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
diff --git a/layout/reftests/css-namespace/README b/layout/reftests/css-namespace/README
deleted file mode 100644
--- a/layout/reftests/css-namespace/README
+++ /dev/null
@@ -1,2 +0,0 @@
-This is the css3-namespace test suite.  See
-http://www.w3.org/Style/CSS/Test/CSS3/Namespace/ .
diff --git a/layout/reftests/css-namespace/reftest.list b/layout/reftests/css-namespace/reftest.list
deleted file mode 100644
--- a/layout/reftests/css-namespace/reftest.list
+++ /dev/null
@@ -1,23 +0,0 @@
-== syntax-001.xml ref-lime-1-block.xml
-== syntax-002.xml ref-lime-1-block.xml
-== syntax-003.xml ref-lime-5.xml
-== syntax-004.xml ref-lime-1.xml
-== syntax-005.xml ref-lime-5.xml
-== syntax-006.xml ref-lime-1.xml
-== syntax-007.xml ref-lime-1.xml
-== syntax-008.xml ref-lime-2.xml
-== syntax-009.xml ref-lime-1.xml
-== syntax-010.xml ref-lime-3.xml
-== syntax-011.xml ref-lime-6.xml
-== syntax-012.xml ref-lime-3.xml
-== syntax-013.xml ref-lime-5.xml
-== syntax-014.xml ref-lime-3.xml
-== syntax-015.xml ref-lime-1.xml
-== scope-001.xml ref-lime-1.xml
-== scope-002.xml ref-lime-1.xml
-== prefix-001.xml ref-lime-1.xml
-== prefix-002.xml ref-lime-1.xml
-== prefix-003.xml ref-lime-1-generic.xml
-== prefix-004.xml ref-lime-2-generic.xml
-== prefix-005.xml ref-lime-2-generic.xml
-== prefix-006.xml ref-lime-2.xml
diff --git a/layout/reftests/w3c-css/import-tests.py b/layout/reftests/w3c-css/import-tests.py
--- a/layout/reftests/w3c-css/import-tests.py
+++ b/layout/reftests/w3c-css/import-tests.py
@@ -1,18 +1,16 @@
 #!/usr/bin/python
 # This Source Code Form is subject to the terms of the Mozilla Public
 # License, v. 2.0. If a copy of the MPL was not distributed with this
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 # FIXME:
 #   * Import more tests rather than just the very limited set currently
 #     chosen.
-#     - Maybe start by moving layout/reftests/css-namespace/ into this
-#       directory structure, since it was manually imported.
 #   * Read in a (checked-in) input file with a list of test assertions
 #     expected to fail.
 #   * Read in a (checked-in) input file with a list of reference choices
 #     for tests with multiple rel="match" references.  (But still go
 #     though all those references in case they, in turn, have references.)
 
 import os
 from optparse import OptionParser
@@ -46,51 +44,89 @@ def log_output_of(subprocess):
 log.write("Importing revision: ")
 log_output_of(Popen(["hg", "parent", "--template={node}"],
                     stdout=PIPE, cwd=srcpath))
 log.write("\nfrom repository: ")
 log_output_of(Popen(["hg", "paths", "default"],
                     stdout=PIPE, cwd=srcpath))
 log.write("\n")
 
+# Remove existing directories that we're going to regenerate.  This
+# is necessary so that we can give errors in cases where our import
+# might copy two files to the same location, which we do by giving
+# errors if a copy would overwrite a file.
+for dirname in os.listdir(destpath):
+    fulldir = os.path.join(destpath, dirname)
+    if not os.path.isdir(fulldir):
+        continue
+    shutil.rmtree(fulldir)
+
 # Eventually we should import all the tests that have references.  (At
 # least for a subset of secs.  And we probably want to organize the
 # directory structure by spec to avoid constant file moves when files
 # move in the W3C repository.  And we probably also want to import each
 # test only once, even if it covers more than one spec.)
 
 # But for now, let's just import one set of tests.
 
-subtree = os.path.join(srcpath, "contributors", "opera", "submitted", "css3-conditional")
+subtrees = [
+    os.path.join(srcpath, "approved", "css3-namespace", "src"),
+    os.path.join(srcpath, "contributors", "opera", "submitted", "css3-conditional")
+]
 testfiles = []
-for dirpath, dirnames, filenames in os.walk(subtree, topdown=True):
-    if "support" in dirnames:
-       dirnames.remove("support")
-    for f in filenames:
-        if f.find("-ref.") != -1:
-            continue
-        testfiles.append(os.path.join(dirpath, f))
+for subtree in subtrees:
+    for dirpath, dirnames, filenames in os.walk(subtree, topdown=True):
+        if "support" in dirnames:
+           dirnames.remove("support")
+        if "reftest" in dirnames:
+           dirnames.remove("reftest")
+        for f in filenames:
+            if f == "README" or \
+               f.find("-ref.") != -1:
+                continue
+            testfiles.append(os.path.join(dirpath, f))
 
 testfiles.sort()
 
+def copy_file(srcfile, destname):
+    if not srcfile.startswith(srcpath):
+        raise StandardError("Filename " + srcfile + " does not start with " + srcpath)
+    logname = srcfile[len(srcpath):]
+    log.write("Importing " + logname + " to " + destname + "\n")
+    destfile = os.path.join(destpath, destname)
+    destdir = os.path.dirname(destfile)
+    if not os.path.exists(destdir):
+        os.makedirs(destdir)
+    if os.path.exists(destfile):
+        raise StandardError("file " + destfile + " already exists")
+    shutil.copyfile(srcfile, destfile)
+
+support_dirs_mapped = set()
+def copy_support_files(dirname, spec):
+    if dirname in support_dirs_mapped:
+        return
+    support_dirs_mapped.add(dirname)
+    support_dir = os.path.join(dirname, "support")
+    if not os.path.exists(support_dir):
+        return
+    for dirpath, dirnames, filenames in os.walk(support_dir):
+        for fn in filenames:
+            if fn == "LOCK":
+                continue
+            full_fn = os.path.join(dirpath, fn)
+            copy_file(full_fn, os.path.join(spec, "support", full_fn[len(support_dir)+1:]))
+
 filemap = {}
 def map_file(fn, spec):
     if fn in filemap:
         return filemap[fn]
-    if not fn.startswith(srcpath):
-        raise StandardError("Filename " + fn + " does not start with " + srcpath)
-    logname = fn[len(srcpath):]
     destname = os.path.join(spec, os.path.basename(fn))
     filemap[fn] = destname
-    log.write("Importing " + logname + " to " + destname + "\n")
-    destfile = os.path.join(destpath, destname)
-    destdir = os.path.dirname(destfile)
-    if not os.path.exists(destdir):
-        os.makedirs(destdir)
-    shutil.copyfile(fn, destfile)
+    copy_file(fn, destname)
+    copy_support_files(os.path.dirname(fn), spec)
     return destname
 
 tests = []
 def add_test_items(fn, spec):
     document = None # an xml.dom.minidom document
     if fn.endswith(".htm") or fn.endswith(".html"):
         # An HTML file
         f = open(fn, "r")
diff --git a/layout/reftests/css-namespace/prefix-001.xml b/layout/reftests/w3c-css/received/css3-namespace/prefix-001.xml
rename from layout/reftests/css-namespace/prefix-001.xml
rename to layout/reftests/w3c-css/received/css3-namespace/prefix-001.xml
--- a/layout/reftests/css-namespace/prefix-001.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/prefix-001.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#prefixes"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <title>CSS Namespaces Test Suite: prefix case-sensitivity</title>
   <style>
    @namespace Foo "y";
    @namespace foo "x";
    test { background:red }
    Foo|test { background:lime }
    foo|test { background:red }
    FOO|test { background:red }
diff --git a/layout/reftests/css-namespace/prefix-002.xml b/layout/reftests/w3c-css/received/css3-namespace/prefix-002.xml
rename from layout/reftests/css-namespace/prefix-002.xml
rename to layout/reftests/w3c-css/received/css3-namespace/prefix-002.xml
--- a/layout/reftests/css-namespace/prefix-002.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/prefix-002.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#prefixes"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <title>CSS Namespaces Test Suite: empty string prefix (Explicit element namespace)</title>
   <style>
    @namespace foo "";
    t { background:red }
    foo|t { background:lime }
   </style>
  </head>
  <body>
diff --git a/layout/reftests/css-namespace/prefix-003.xml b/layout/reftests/w3c-css/received/css3-namespace/prefix-003.xml
rename from layout/reftests/css-namespace/prefix-003.xml
rename to layout/reftests/w3c-css/received/css3-namespace/prefix-003.xml
--- a/layout/reftests/css-namespace/prefix-003.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/prefix-003.xml
@@ -1,13 +1,14 @@
 <root>
  <head xmlns="http://www.w3.org/1999/xhtml">
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#prefixes"/>
+  <link rel="match" href="reftest/ref-lime-1-generic.xml"/>
   <title>CSS Namespaces Test Suite: empty string prefix (Implied element namespace)</title>
   <style>
    @namespace foo "";
    t { background:red }
    foo|t { background:lime }
   </style>
  </head>
  <t>This sentence should have a green background.</t>
diff --git a/layout/reftests/css-namespace/prefix-004.xml b/layout/reftests/w3c-css/received/css3-namespace/prefix-004.xml
rename from layout/reftests/css-namespace/prefix-004.xml
rename to layout/reftests/w3c-css/received/css3-namespace/prefix-004.xml
--- a/layout/reftests/css-namespace/prefix-004.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/prefix-004.xml
@@ -1,13 +1,14 @@
 <root>
  <head xmlns="http://www.w3.org/1999/xhtml">
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#prefixes"/>
+  <link rel="match" href="reftest/ref-lime-2-generic.xml"/>
   <title>CSS Namespaces Test Suite: empty string default namespace</title>
   <style>
    @namespace "";
    @namespace x "test";
    *|t, *|root { display:block }
    *|t, t[x] { background:lime }
    t { background:red }
   </style>
diff --git a/layout/reftests/css-namespace/prefix-005.xml b/layout/reftests/w3c-css/received/css3-namespace/prefix-005.xml
rename from layout/reftests/css-namespace/prefix-005.xml
rename to layout/reftests/w3c-css/received/css3-namespace/prefix-005.xml
--- a/layout/reftests/css-namespace/prefix-005.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/prefix-005.xml
@@ -1,14 +1,15 @@
 <root>
  <head xmlns="http://www.w3.org/1999/xhtml">
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="author" title="Boris Zbarsky" href="https://bugzilla.mozilla.org/show_bug.cgi?id=458381#c4"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#prefixes"/>
+  <link rel="match" href="reftest/ref-lime-2-generic.xml"/>
   <title>CSS Namespaces Test Suite: no default namespace</title>
   <style>
    @namespace x "test";
    root *|* { background:red; display:block }
    head { display:none }
    t { background: lime }
   </style>
  </head>
diff --git a/layout/reftests/css-namespace/prefix-006.xml b/layout/reftests/w3c-css/received/css3-namespace/prefix-006.xml
rename from layout/reftests/css-namespace/prefix-006.xml
rename to layout/reftests/w3c-css/received/css3-namespace/prefix-006.xml
--- a/layout/reftests/css-namespace/prefix-006.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/prefix-006.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#prefixes"/>
+  <link rel="match" href="reftest/ref-lime-2.xml"/>
   <title>CSS Namespaces Test Suite: no prefix</title>
   <style>
    @namespace "test";
    |t { background:lime }
    t { background:red }
   </style>
   <style>
    @namespace "test";
diff --git a/layout/reftests/css-namespace/ref-lime-1-block.xml b/layout/reftests/w3c-css/received/css3-namespace/ref-lime-1-block.xml
rename from layout/reftests/css-namespace/ref-lime-1-block.xml
rename to layout/reftests/w3c-css/received/css3-namespace/ref-lime-1-block.xml
diff --git a/layout/reftests/css-namespace/ref-lime-1-generic.xml b/layout/reftests/w3c-css/received/css3-namespace/ref-lime-1-generic.xml
rename from layout/reftests/css-namespace/ref-lime-1-generic.xml
rename to layout/reftests/w3c-css/received/css3-namespace/ref-lime-1-generic.xml
diff --git a/layout/reftests/css-namespace/ref-lime-1.xml b/layout/reftests/w3c-css/received/css3-namespace/ref-lime-1.xml
rename from layout/reftests/css-namespace/ref-lime-1.xml
rename to layout/reftests/w3c-css/received/css3-namespace/ref-lime-1.xml
diff --git a/layout/reftests/css-namespace/ref-lime-2-generic.xml b/layout/reftests/w3c-css/received/css3-namespace/ref-lime-2-generic.xml
rename from layout/reftests/css-namespace/ref-lime-2-generic.xml
rename to layout/reftests/w3c-css/received/css3-namespace/ref-lime-2-generic.xml
diff --git a/layout/reftests/css-namespace/ref-lime-2.xml b/layout/reftests/w3c-css/received/css3-namespace/ref-lime-2.xml
rename from layout/reftests/css-namespace/ref-lime-2.xml
rename to layout/reftests/w3c-css/received/css3-namespace/ref-lime-2.xml
diff --git a/layout/reftests/css-namespace/ref-lime-3.xml b/layout/reftests/w3c-css/received/css3-namespace/ref-lime-3.xml
rename from layout/reftests/css-namespace/ref-lime-3.xml
rename to layout/reftests/w3c-css/received/css3-namespace/ref-lime-3.xml
diff --git a/layout/reftests/css-namespace/ref-lime-5.xml b/layout/reftests/w3c-css/received/css3-namespace/ref-lime-5.xml
rename from layout/reftests/css-namespace/ref-lime-5.xml
rename to layout/reftests/w3c-css/received/css3-namespace/ref-lime-5.xml
diff --git a/layout/reftests/css-namespace/ref-lime-6.xml b/layout/reftests/w3c-css/received/css3-namespace/ref-lime-6.xml
rename from layout/reftests/css-namespace/ref-lime-6.xml
rename to layout/reftests/w3c-css/received/css3-namespace/ref-lime-6.xml
diff --git a/layout/reftests/css-namespace/scope-001.xml b/layout/reftests/w3c-css/received/css3-namespace/scope-001.xml
rename from layout/reftests/css-namespace/scope-001.xml
rename to layout/reftests/w3c-css/received/css3-namespace/scope-001.xml
--- a/layout/reftests/css-namespace/scope-001.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/scope-001.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#scope"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <meta name="flags" content="invalid"/>
   <title>CSS Namespaces Test Suite: scope &lt;style></title>
   <style>
    @namespace x url("test");
    test { background:lime }
   </style>
   <style>
    x|test { background:red }
diff --git a/layout/reftests/css-namespace/scope-002.xml b/layout/reftests/w3c-css/received/css3-namespace/scope-002.xml
rename from layout/reftests/css-namespace/scope-002.xml
rename to layout/reftests/w3c-css/received/css3-namespace/scope-002.xml
--- a/layout/reftests/css-namespace/scope-002.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/scope-002.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#scope"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <title>CSS Namespaces Test Suite: scope @import</title>
   <style>
    test { background:lime }
   </style>
   <style>
    @import url("support/scope-002a.css");
    @import url("support/scope-002b.css");
    @namespace w "test";
diff --git a/layout/reftests/css-namespace/support/fail.css b/layout/reftests/w3c-css/received/css3-namespace/support/fail.css
rename from layout/reftests/css-namespace/support/fail.css
rename to layout/reftests/w3c-css/received/css3-namespace/support/fail.css
diff --git a/layout/reftests/css-namespace/support/scope-002a.css b/layout/reftests/w3c-css/received/css3-namespace/support/scope-002a.css
rename from layout/reftests/css-namespace/support/scope-002a.css
rename to layout/reftests/w3c-css/received/css3-namespace/support/scope-002a.css
diff --git a/layout/reftests/css-namespace/support/scope-002b.css b/layout/reftests/w3c-css/received/css3-namespace/support/scope-002b.css
rename from layout/reftests/css-namespace/support/scope-002b.css
rename to layout/reftests/w3c-css/received/css3-namespace/support/scope-002b.css
diff --git a/layout/reftests/css-namespace/support/syntax-007.css b/layout/reftests/w3c-css/received/css3-namespace/support/syntax-007.css
rename from layout/reftests/css-namespace/support/syntax-007.css
rename to layout/reftests/w3c-css/received/css3-namespace/support/syntax-007.css
diff --git a/layout/reftests/css-namespace/syntax-001.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-001.xml
rename from layout/reftests/css-namespace/syntax-001.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-001.xml
--- a/layout/reftests/css-namespace/syntax-001.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-001.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-1-block.xml"/>
   <title>CSS Namespaces Test Suite: @namespace case-insensitivity</title>
   <style>
    @NAmespace x "http://www.w3.org/1999/xhtml";
    x|p { background: lime }
   </style>
  </head>
  <body>
   <p>This sentence should have a green background.</p>
diff --git a/layout/reftests/css-namespace/syntax-002.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-002.xml
rename from layout/reftests/css-namespace/syntax-002.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-002.xml
--- a/layout/reftests/css-namespace/syntax-002.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-002.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-1-block.xml"/>
   <title>CSS Namespaces Test Suite: @namespace syntax with escapes</title>
   <style>
    @\N\000041 mes\pac\65  x "http://www.w3.org/1999/xhtml";
    x|p { background: lime }
   </style>
  </head>
  <body>
   <p>This sentence should have a green background.</p>
diff --git a/layout/reftests/css-namespace/syntax-003.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-003.xml
rename from layout/reftests/css-namespace/syntax-003.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-003.xml
--- a/layout/reftests/css-namespace/syntax-003.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-003.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-5.xml"/>
   <title>CSS Namespaces Test Suite: @namespace default namespace syntax</title>
   <style>
    *|test { background:red }
   </style>
   <style>
    @namespace url(test-a);
    test { background:lime }
   </style>
diff --git a/layout/reftests/css-namespace/syntax-004.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-004.xml
rename from layout/reftests/css-namespace/syntax-004.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-004.xml
--- a/layout/reftests/css-namespace/syntax-004.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-004.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <title>CSS Namespaces Test Suite: @namespace url() with escape</title>
   <style>
    @namespace u\00072l("test");
    *|test { background:red }
    test { background: lime }
   </style>
  </head>
  <body>
diff --git a/layout/reftests/css-namespace/syntax-005.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-005.xml
rename from layout/reftests/css-namespace/syntax-005.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-005.xml
--- a/layout/reftests/css-namespace/syntax-005.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-005.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-5.xml"/>
   <title>CSS Namespaces Test Suite: @namespace string and url() syntax</title>
   <style>
    test { background:red }
   </style>
   <style>
    @namespace a url(test-a);
    @namespace b url('test-b');
    @namespace c url("test-c");
diff --git a/layout/reftests/css-namespace/syntax-006.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-006.xml
rename from layout/reftests/css-namespace/syntax-006.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-006.xml
--- a/layout/reftests/css-namespace/syntax-006.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-006.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <meta name="flags" content="invalid"/>
   <title>CSS Namespaces Test Suite: invalid ordering of @namespace and @import</title>
   <style>
    @namespace x u\00072l("test");
    @import url("support/fail.css");
    @namespace url("test2");
    x|test { background:lime }
    test { background:red }
diff --git a/layout/reftests/css-namespace/syntax-007.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-007.xml
rename from layout/reftests/css-namespace/syntax-007.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-007.xml
--- a/layout/reftests/css-namespace/syntax-007.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-007.xml
@@ -1,12 +1,13 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <title>CSS Namespaces Test Suite: @namespace and @charset</title>
   <link rel="stylesheet" href="support/syntax-007.css"/>
  </head>
  <body>
   <p><test xmlns="test">This sentence should have a green background.</test></p>
  </body>
 </html>
diff --git a/layout/reftests/css-namespace/syntax-008.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-008.xml
rename from layout/reftests/css-namespace/syntax-008.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-008.xml
--- a/layout/reftests/css-namespace/syntax-008.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-008.xml
@@ -1,21 +1,22 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-2.xml"/>
   <title>CSS Namespaces Test Suite: escapes in prefix</title>
   <style>
    @namespace \72x url("test");
    t { background:red }
    r\78|t { background:lime }
   </style>
   <style>
-   @namespace \032  url("test"); // two spaces, see CSS 2.1, 4.1.3
+   @namespace \032  url("test"); /* two spaces, see CSS 2.1, 4.1.3 */
    t2 { background:red }
    \32|t2 { background:lime }
   </style>
  </head>
  <body>
   <p><t xmlns="test">This sentence should have a green background.</t></p>
   <p><t2 xmlns="test">This sentence should have a green background.</t2></p>
  </body>
diff --git a/layout/reftests/css-namespace/syntax-009.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-009.xml
rename from layout/reftests/css-namespace/syntax-009.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-009.xml
--- a/layout/reftests/css-namespace/syntax-009.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-009.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <title>CSS Namespaces Test Suite: escaped vertical bar in qualified name</title>
   <style>
    @namespace x "test";
    test { background:red }
    x|test { background:lime }
    x\00007Ctest { background:red }
   </style>
  </head>
diff --git a/layout/reftests/css-namespace/syntax-010.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-010.xml
rename from layout/reftests/css-namespace/syntax-010.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-010.xml
--- a/layout/reftests/css-namespace/syntax-010.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-010.xml
@@ -1,13 +1,15 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-3.xml"/>
+  <meta name="flags" content="invalid"/>
   <title>CSS Namespaces Test Suite: duplicate @namespace declarations</title>
   <style>
    @namespace "1";
    @namespace dummy "yummy";
    @namespace "2";
    *|t { background:lime }
    t { background:red }
   </style>
diff --git a/layout/reftests/css-namespace/syntax-011.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-011.xml
rename from layout/reftests/css-namespace/syntax-011.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-011.xml
--- a/layout/reftests/css-namespace/syntax-011.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-011.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-6.xml"/>
   <title>CSS Namespaces Test Suite: string comparison (no URI resolving)</title>
   <style>
    @namespace url("http://example.com/");
    *|t { background:lime }
    t { background:red }
   </style>
   <style>
    @namespace url("http://example.com/");
diff --git a/layout/reftests/css-namespace/syntax-012.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-012.xml
rename from layout/reftests/css-namespace/syntax-012.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-012.xml
--- a/layout/reftests/css-namespace/syntax-012.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-012.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-3.xml"/>
   <title>CSS Namespaces Test Suite: whitespace and comment handling</title>
   <style>
    test { background:red }
   </style>
   <style>
    @namespace/* test */
    a
    url(
diff --git a/layout/reftests/css-namespace/syntax-013.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-013.xml
rename from layout/reftests/css-namespace/syntax-013.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-013.xml
--- a/layout/reftests/css-namespace/syntax-013.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-013.xml
@@ -1,14 +1,15 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="author" title="Elika J. Etemad" href="http://fantasai.inkedblade.net/contact"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-5.xml"/>
   <meta name="flags" content="invalid"/>
   <title>CSS Namespaces Test Suite: @namespace error handling</title>
   <style>
    t, t2, t3, t4, t5 { background:red }
   </style>
   <style>
    @namespace "test" {}
    t { background:lime }
diff --git a/layout/reftests/css-namespace/syntax-014.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-014.xml
rename from layout/reftests/css-namespace/syntax-014.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-014.xml
--- a/layout/reftests/css-namespace/syntax-014.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-014.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-3.xml"/>
   <meta name="flags" content="invalid"/>
   <title>CSS Namespaces Test Suite: @namespace and invalid at-rules</title>
   <style>
    t, t2, t3 { background:red }
   </style>
   <style>
    @import x {}
    @namespace x "test";
diff --git a/layout/reftests/css-namespace/syntax-015.xml b/layout/reftests/w3c-css/received/css3-namespace/syntax-015.xml
rename from layout/reftests/css-namespace/syntax-015.xml
rename to layout/reftests/w3c-css/received/css3-namespace/syntax-015.xml
--- a/layout/reftests/css-namespace/syntax-015.xml
+++ b/layout/reftests/w3c-css/received/css3-namespace/syntax-015.xml
@@ -1,13 +1,14 @@
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
   <link rel="author" title="Anne van Kesteren" href="http://annevankesteren.nl/"/>
   <link rel="author" title="Opera Software ASA" href="http://opera.com/"/>
   <link rel="help" href="http://www.w3.org/TR/css3-namespace/#syntax"/>
+  <link rel="match" href="reftest/ref-lime-1.xml"/>
   <title>CSS Namespaces Test Suite: invalid URI</title>
   <style>
    @namespace x url("test");
    @namespace x url("}x&lt; >x{");
    t { background:lime }
    x|t { background:red }
   </style>
  </head>
diff --git a/layout/reftests/w3c-css/received/import.log b/layout/reftests/w3c-css/received/import.log
--- a/layout/reftests/w3c-css/received/import.log
+++ b/layout/reftests/w3c-css/received/import.log
@@ -1,10 +1,45 @@
-Importing revision: aa7ad3ba9510c83ad82c7b81121dfe689c1541dc
+Importing revision: b02c8a260a95cfe4b925c3a82920b2b8b57ce7c6
 from repository: https://hg.csswg.org/test
+Importing approved/css3-namespace/src/prefix-001.xml to css3-namespace/prefix-001.xml
+Importing approved/css3-namespace/src/support/fail.css to css3-namespace/support/fail.css
+Importing approved/css3-namespace/src/support/syntax-007.css to css3-namespace/support/syntax-007.css
+Importing approved/css3-namespace/src/support/scope-002a.css to css3-namespace/support/scope-002a.css
+Importing approved/css3-namespace/src/support/scope-002b.css to css3-namespace/support/scope-002b.css
+Importing approved/css3-namespace/src/reftest/ref-lime-1.xml to css3-namespace/ref-lime-1.xml
+Importing approved/css3-namespace/src/prefix-002.xml to css3-namespace/prefix-002.xml
+Importing approved/css3-namespace/src/prefix-003.xml to css3-namespace/prefix-003.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-1-generic.xml to css3-namespace/ref-lime-1-generic.xml
+Importing approved/css3-namespace/src/prefix-004.xml to css3-namespace/prefix-004.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-2-generic.xml to css3-namespace/ref-lime-2-generic.xml
+Importing approved/css3-namespace/src/prefix-005.xml to css3-namespace/prefix-005.xml
+Importing approved/css3-namespace/src/prefix-006.xml to css3-namespace/prefix-006.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-2.xml to css3-namespace/ref-lime-2.xml
+Importing approved/css3-namespace/src/scope-001.xml to css3-namespace/scope-001.xml
+Importing approved/css3-namespace/src/scope-002.xml to css3-namespace/scope-002.xml
+Importing approved/css3-namespace/src/syntax-001.xml to css3-namespace/syntax-001.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-1-block.xml to css3-namespace/ref-lime-1-block.xml
+Importing approved/css3-namespace/src/syntax-002.xml to css3-namespace/syntax-002.xml
+Importing approved/css3-namespace/src/syntax-003.xml to css3-namespace/syntax-003.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-5.xml to css3-namespace/ref-lime-5.xml
+Importing approved/css3-namespace/src/syntax-004.xml to css3-namespace/syntax-004.xml
+Importing approved/css3-namespace/src/syntax-005.xml to css3-namespace/syntax-005.xml
+Importing approved/css3-namespace/src/syntax-006.xml to css3-namespace/syntax-006.xml
+Importing approved/css3-namespace/src/syntax-007.xml to css3-namespace/syntax-007.xml
+Importing approved/css3-namespace/src/syntax-008.xml to css3-namespace/syntax-008.xml
+Importing approved/css3-namespace/src/syntax-009.xml to css3-namespace/syntax-009.xml
+Importing approved/css3-namespace/src/syntax-010.xml to css3-namespace/syntax-010.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-3.xml to css3-namespace/ref-lime-3.xml
+Importing approved/css3-namespace/src/syntax-011.xml to css3-namespace/syntax-011.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-6.xml to css3-namespace/ref-lime-6.xml
+Importing approved/css3-namespace/src/syntax-012.xml to css3-namespace/syntax-012.xml
+Importing approved/css3-namespace/src/syntax-013.xml to css3-namespace/syntax-013.xml
+Importing approved/css3-namespace/src/syntax-014.xml to css3-namespace/syntax-014.xml
+Importing approved/css3-namespace/src/syntax-015.xml to css3-namespace/syntax-015.xml
 Importing contributors/opera/submitted/css3-conditional/at-supports-001.html to css3-conditional/at-supports-001.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-001-ref.html to css3-conditional/at-supports-001-ref.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-002.html to css3-conditional/at-supports-002.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-003.html to css3-conditional/at-supports-003.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-004.html to css3-conditional/at-supports-004.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-005.html to css3-conditional/at-supports-005.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-006.html to css3-conditional/at-supports-006.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-007.html to css3-conditional/at-supports-007.html
diff --git a/layout/reftests/w3c-css/received/reftest.list b/layout/reftests/w3c-css/received/reftest.list
--- a/layout/reftests/w3c-css/received/reftest.list
+++ b/layout/reftests/w3c-css/received/reftest.list
@@ -1,8 +1,31 @@
+== css3-namespace/prefix-001.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/prefix-002.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/prefix-003.xml css3-namespace/ref-lime-1-generic.xml
+== css3-namespace/prefix-004.xml css3-namespace/ref-lime-2-generic.xml
+== css3-namespace/prefix-005.xml css3-namespace/ref-lime-2-generic.xml
+== css3-namespace/prefix-006.xml css3-namespace/ref-lime-2.xml
+== css3-namespace/scope-001.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/scope-002.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-001.xml css3-namespace/ref-lime-1-block.xml
+== css3-namespace/syntax-002.xml css3-namespace/ref-lime-1-block.xml
+== css3-namespace/syntax-003.xml css3-namespace/ref-lime-5.xml
+== css3-namespace/syntax-004.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-005.xml css3-namespace/ref-lime-5.xml
+== css3-namespace/syntax-006.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-007.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-008.xml css3-namespace/ref-lime-2.xml
+== css3-namespace/syntax-009.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-010.xml css3-namespace/ref-lime-3.xml
+== css3-namespace/syntax-011.xml css3-namespace/ref-lime-6.xml
+== css3-namespace/syntax-012.xml css3-namespace/ref-lime-3.xml
+== css3-namespace/syntax-013.xml css3-namespace/ref-lime-5.xml
+== css3-namespace/syntax-014.xml css3-namespace/ref-lime-3.xml
+== css3-namespace/syntax-015.xml css3-namespace/ref-lime-1.xml
 == css3-conditional/at-supports-001.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-002.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-003.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-004.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-005.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-006.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-007.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-008.html css3-conditional/at-supports-001-ref.html
