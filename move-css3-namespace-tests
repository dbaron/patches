From: L. David Baron <dbaron@dbaron.org>

Move the imported css3-namespace test suite in with other test suites imported from the CSSWG repository, and make the importing script import it.

diff --git a/layout/reftests/css-namespace/LICENSE b/layout/reftests/css-namespace/LICENSE
deleted file mode 100644
--- a/layout/reftests/css-namespace/LICENSE
+++ /dev/null
@@ -1,9 +0,0 @@
-W3C 3-clause BSD License
-
-Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
-
-    * Redistributions of works must retain the original copyright notice, this list of conditions and the following disclaimer.
-    * Redistributions in binary form must reproduce the original copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
-    * Neither the name of the W3C nor the names of its contributors may be used to endorse or promote products derived from this work without specific prior written permission.
-
-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
diff --git a/layout/reftests/css-namespace/README b/layout/reftests/css-namespace/README
deleted file mode 100644
--- a/layout/reftests/css-namespace/README
+++ /dev/null
@@ -1,2 +0,0 @@
-This is the css3-namespace test suite.  See
-http://www.w3.org/Style/CSS/Test/CSS3/Namespace/ .
diff --git a/layout/reftests/w3c-css/import-tests.py b/layout/reftests/w3c-css/import-tests.py
--- a/layout/reftests/w3c-css/import-tests.py
+++ b/layout/reftests/w3c-css/import-tests.py
@@ -1,18 +1,16 @@
 #!/usr/bin/python
 # This Source Code Form is subject to the terms of the Mozilla Public
 # License, v. 2.0. If a copy of the MPL was not distributed with this
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 # FIXME:
 #   * Import more tests rather than just the very limited set currently
 #     chosen.
-#     - Maybe start by moving layout/reftests/css-namespace/ into this
-#       directory structure, since it was manually imported.
 #   * Read in a (checked-in) input file with a list of test assertions
 #     expected to fail.
 #   * Read in a (checked-in) input file with a list of reference choices
 #     for tests with multiple rel="match" references.  (But still go
 #     though all those references in case they, in turn, have references.)
 
 import os
 from optparse import OptionParser
@@ -54,43 +52,71 @@ log.write("\n")
 # Eventually we should import all the tests that have references.  (At
 # least for a subset of secs.  And we probably want to organize the
 # directory structure by spec to avoid constant file moves when files
 # move in the W3C repository.  And we probably also want to import each
 # test only once, even if it covers more than one spec.)
 
 # But for now, let's just import one set of tests.
 
-subtree = os.path.join(srcpath, "contributors", "opera", "submitted", "css3-conditional")
+subtrees = [
+    os.path.join(srcpath, "approved", "css3-namespace", "src"),
+    os.path.join(srcpath, "contributors", "opera", "submitted", "css3-conditional")
+]
 testfiles = []
-for dirpath, dirnames, filenames in os.walk(subtree, topdown=True):
-    if "support" in dirnames:
-       dirnames.remove("support")
-    for f in filenames:
-        if f.find("-ref.") != -1:
-            continue
-        testfiles.append(os.path.join(dirpath, f))
+for subtree in subtrees:
+    for dirpath, dirnames, filenames in os.walk(subtree, topdown=True):
+        if "support" in dirnames:
+           dirnames.remove("support")
+        if "reftest" in dirnames:
+           dirnames.remove("reftest")
+        for f in filenames:
+            if f == "README" or \
+               f.find("-ref.") != -1:
+                continue
+            testfiles.append(os.path.join(dirpath, f))
 
 testfiles.sort()
 
+def copy_file(srcfile, destname):
+    if not srcfile.startswith(srcpath):
+        raise StandardError("Filename " + srcfile + " does not start with " + srcpath)
+    logname = srcfile[len(srcpath):]
+    log.write("Importing " + logname + " to " + destname + "\n")
+    destfile = os.path.join(destpath, destname)
+    destdir = os.path.dirname(destfile)
+    if not os.path.exists(destdir):
+        os.makedirs(destdir)
+    if os.path.exists(destfile):
+        raise StandardError("file " + destfile + " already exists")
+    shutil.copyfile(srcfile, destfile)
+
+support_dirs_mapped = set()
+def copy_support_files(dirname, spec):
+    if dirname in support_dirs_mapped:
+        return
+    support_dirs_mapped.add(dirname)
+    support_dir = os.path.join(dirname, "support")
+    if not os.path.exists(support_dir):
+        return
+    for dirpath, dirnames, filenames in os.walk(support_dir):
+        for fn in filenames:
+            if fn == "LOCK":
+                continue
+            full_fn = os.path.join(dirpath, fn)
+            copy_file(full_fn, os.path.join(spec, "support", full_fn[len(support_dir)+1:]))
+
 filemap = {}
 def map_file(fn, spec):
     if fn in filemap:
         return filemap[fn]
-    if not fn.startswith(srcpath):
-        raise StandardError("Filename " + fn + " does not start with " + srcpath)
-    logname = fn[len(srcpath):]
     destname = os.path.join(spec, os.path.basename(fn))
     filemap[fn] = destname
-    log.write("Importing " + logname + " to " + destname + "\n")
-    destfile = os.path.join(destpath, destname)
-    destdir = os.path.dirname(destfile)
-    if not os.path.exists(destdir):
-        os.makedirs(destdir)
-    shutil.copyfile(fn, destfile)
+    copy_file(fn, destname)
+    copy_support_files(os.path.dirname(fn), spec)
     return destname
 
 tests = []
 def add_test_items(fn, spec):
     document = None # an xml.dom.minidom document
     if fn.endswith(".htm") or fn.endswith(".html"):
         # An HTML file
         f = open(fn, "r")
diff --git a/layout/reftests/w3c-css/received/import.log b/layout/reftests/w3c-css/received/import.log
--- a/layout/reftests/w3c-css/received/import.log
+++ b/layout/reftests/w3c-css/received/import.log
@@ -1,10 +1,45 @@
-Importing revision: aa7ad3ba9510c83ad82c7b81121dfe689c1541dc
+Importing revision: b02c8a260a95cfe4b925c3a82920b2b8b57ce7c6
 from repository: https://hg.csswg.org/test
+Importing approved/css3-namespace/src/prefix-001.xml to css3-namespace/prefix-001.xml
+Importing approved/css3-namespace/src/support/fail.css to css3-namespace/support/fail.css
+Importing approved/css3-namespace/src/support/syntax-007.css to css3-namespace/support/syntax-007.css
+Importing approved/css3-namespace/src/support/scope-002a.css to css3-namespace/support/scope-002a.css
+Importing approved/css3-namespace/src/support/scope-002b.css to css3-namespace/support/scope-002b.css
+Importing approved/css3-namespace/src/reftest/ref-lime-1.xml to css3-namespace/ref-lime-1.xml
+Importing approved/css3-namespace/src/prefix-002.xml to css3-namespace/prefix-002.xml
+Importing approved/css3-namespace/src/prefix-003.xml to css3-namespace/prefix-003.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-1-generic.xml to css3-namespace/ref-lime-1-generic.xml
+Importing approved/css3-namespace/src/prefix-004.xml to css3-namespace/prefix-004.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-2-generic.xml to css3-namespace/ref-lime-2-generic.xml
+Importing approved/css3-namespace/src/prefix-005.xml to css3-namespace/prefix-005.xml
+Importing approved/css3-namespace/src/prefix-006.xml to css3-namespace/prefix-006.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-2.xml to css3-namespace/ref-lime-2.xml
+Importing approved/css3-namespace/src/scope-001.xml to css3-namespace/scope-001.xml
+Importing approved/css3-namespace/src/scope-002.xml to css3-namespace/scope-002.xml
+Importing approved/css3-namespace/src/syntax-001.xml to css3-namespace/syntax-001.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-1-block.xml to css3-namespace/ref-lime-1-block.xml
+Importing approved/css3-namespace/src/syntax-002.xml to css3-namespace/syntax-002.xml
+Importing approved/css3-namespace/src/syntax-003.xml to css3-namespace/syntax-003.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-5.xml to css3-namespace/ref-lime-5.xml
+Importing approved/css3-namespace/src/syntax-004.xml to css3-namespace/syntax-004.xml
+Importing approved/css3-namespace/src/syntax-005.xml to css3-namespace/syntax-005.xml
+Importing approved/css3-namespace/src/syntax-006.xml to css3-namespace/syntax-006.xml
+Importing approved/css3-namespace/src/syntax-007.xml to css3-namespace/syntax-007.xml
+Importing approved/css3-namespace/src/syntax-008.xml to css3-namespace/syntax-008.xml
+Importing approved/css3-namespace/src/syntax-009.xml to css3-namespace/syntax-009.xml
+Importing approved/css3-namespace/src/syntax-010.xml to css3-namespace/syntax-010.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-3.xml to css3-namespace/ref-lime-3.xml
+Importing approved/css3-namespace/src/syntax-011.xml to css3-namespace/syntax-011.xml
+Importing approved/css3-namespace/src/reftest/ref-lime-6.xml to css3-namespace/ref-lime-6.xml
+Importing approved/css3-namespace/src/syntax-012.xml to css3-namespace/syntax-012.xml
+Importing approved/css3-namespace/src/syntax-013.xml to css3-namespace/syntax-013.xml
+Importing approved/css3-namespace/src/syntax-014.xml to css3-namespace/syntax-014.xml
+Importing approved/css3-namespace/src/syntax-015.xml to css3-namespace/syntax-015.xml
 Importing contributors/opera/submitted/css3-conditional/at-supports-001.html to css3-conditional/at-supports-001.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-001-ref.html to css3-conditional/at-supports-001-ref.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-002.html to css3-conditional/at-supports-002.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-003.html to css3-conditional/at-supports-003.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-004.html to css3-conditional/at-supports-004.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-005.html to css3-conditional/at-supports-005.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-006.html to css3-conditional/at-supports-006.html
 Importing contributors/opera/submitted/css3-conditional/at-supports-007.html to css3-conditional/at-supports-007.html
diff --git a/layout/reftests/w3c-css/received/reftest.list b/layout/reftests/w3c-css/received/reftest.list
--- a/layout/reftests/w3c-css/received/reftest.list
+++ b/layout/reftests/w3c-css/received/reftest.list
@@ -1,8 +1,31 @@
+== css3-namespace/prefix-001.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/prefix-002.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/prefix-003.xml css3-namespace/ref-lime-1-generic.xml
+== css3-namespace/prefix-004.xml css3-namespace/ref-lime-2-generic.xml
+== css3-namespace/prefix-005.xml css3-namespace/ref-lime-2-generic.xml
+== css3-namespace/prefix-006.xml css3-namespace/ref-lime-2.xml
+== css3-namespace/scope-001.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/scope-002.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-001.xml css3-namespace/ref-lime-1-block.xml
+== css3-namespace/syntax-002.xml css3-namespace/ref-lime-1-block.xml
+== css3-namespace/syntax-003.xml css3-namespace/ref-lime-5.xml
+== css3-namespace/syntax-004.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-005.xml css3-namespace/ref-lime-5.xml
+== css3-namespace/syntax-006.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-007.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-008.xml css3-namespace/ref-lime-2.xml
+== css3-namespace/syntax-009.xml css3-namespace/ref-lime-1.xml
+== css3-namespace/syntax-010.xml css3-namespace/ref-lime-3.xml
+== css3-namespace/syntax-011.xml css3-namespace/ref-lime-6.xml
+== css3-namespace/syntax-012.xml css3-namespace/ref-lime-3.xml
+== css3-namespace/syntax-013.xml css3-namespace/ref-lime-5.xml
+== css3-namespace/syntax-014.xml css3-namespace/ref-lime-3.xml
+== css3-namespace/syntax-015.xml css3-namespace/ref-lime-1.xml
 == css3-conditional/at-supports-001.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-002.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-003.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-004.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-005.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-006.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-007.html css3-conditional/at-supports-001-ref.html
 == css3-conditional/at-supports-008.html css3-conditional/at-supports-001-ref.html
