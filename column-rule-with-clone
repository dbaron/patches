From: L. David Baron <dbaron@dbaron.org>

Bug 1432341 - Draw column-rules with border-code in box-decoration-break: clone mode, rather than slice.

This fixes the bug.

MozReview-Commit-ID: 7YYzyxYjhsV

diff --git a/layout/generic/nsColumnSetFrame.cpp b/layout/generic/nsColumnSetFrame.cpp
--- a/layout/generic/nsColumnSetFrame.cpp
+++ b/layout/generic/nsColumnSetFrame.cpp
@@ -269,16 +269,23 @@ nsColumnSetFrame::CreateBorderRenderers(
     skipSides |= mozilla::eSideBitsBottom;
   } else {
     border.SetBorderWidth(eSideLeft, ruleWidth);
     border.SetBorderStyle(eSideLeft, ruleStyle);
     border.mBorderLeftColor = StyleComplexColor::FromColor(ruleColor);
     skipSides |= mozilla::eSideBitsTopBottom;
     skipSides |= mozilla::eSideBitsRight;
   }
+  // If we use box-decoration-break: slice (the default), the border
+  // renderers will require clipping if we have continuations (see the
+  // aNeedsClip parameter to ConstructBorderRenderer in nsCSSRendering).
+  //
+  // Since it doesn't matter which box-decoration-break we use since
+  // we're only drawing borders (and not border-images), use 'clone'.
+  border.mBoxDecorationBreak = StyleBoxDecorationBreak::Clone;
 
   ForEachColumnRule([&]
                     (const nsRect& aLineRect)
                     {
                       // Assert that we're not drawing a border-image here; if we were, we
                       // couldn't ignore the ImgDrawResult that PaintBorderWithStyleBorder returns.
                       MOZ_ASSERT(border.mBorderImageSource.GetType() == eStyleImageType_Null);
 
