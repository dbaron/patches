From: L. David Baron <dbaron@dbaron.org>

Don't construct an nsFrameList whose first child has a previous sibling.  (Bug 586806)

diff --git a/layout/generic/nsBlockFrame.cpp b/layout/generic/nsBlockFrame.cpp
--- a/layout/generic/nsBlockFrame.cpp
+++ b/layout/generic/nsBlockFrame.cpp
@@ -4070,19 +4070,27 @@ nsBlockFrame::SplitLine(nsBlockReflowSta
       aLine->List(stdout, gNoiseIndent+1);
     }
   }
 #endif
 
   if (0 != pushCount) {
     NS_ABORT_IF_FALSE(aLine->GetChildCount() > pushCount, "bad push");
     NS_ABORT_IF_FALSE(nsnull != aFrame, "whoops");
-    NS_ASSERTION(nsFrameList(aFrame, nsLayoutUtils::GetLastSibling(aFrame))
-                   .GetLength() >= pushCount,
-                 "Not enough frames to push");
+#ifdef DEBUG
+    {
+      nsIFrame *f = aFrame;
+      PRInt32 count = pushCount;
+      while (f && count > 0) {
+        f = f->GetNextSibling();
+        --count;
+      }
+      NS_ASSERTION(count == 0, "Not enough frames to push");
+    }
+#endif
 
     // Put frames being split out into their own line
     nsLineBox* newLine = aState.NewLineBox(aFrame, pushCount, PR_FALSE);
     if (!newLine) {
       return NS_ERROR_OUT_OF_MEMORY;
     }
     mLines.after_insert(aLine, newLine);
     aLine->SetChildCount(aLine->GetChildCount() - pushCount);
