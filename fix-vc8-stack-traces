Fix Windows stack traces to work on VC8-compiled builds in addition to VC7.1-compiled builds.

diff --git a/xpcom/base/nsStackFrameWin.cpp b/xpcom/base/nsStackFrameWin.cpp
--- a/xpcom/base/nsStackFrameWin.cpp
+++ b/xpcom/base/nsStackFrameWin.cpp
@@ -140,7 +140,7 @@ void PrintError(char *prefix)
       0,
       NULL
     );
-    fprintf(stderr, "### ERROR: %s: %s", prefix, lpMsgBuf);
+    fprintf(stderr, "### ERROR: %s: %s\n", prefix, lpMsgBuf);
     fflush(stderr);
     LocalFree( lpMsgBuf );
 }
@@ -270,6 +270,8 @@ static BOOL CALLBACK callbackEspecial(
        : (addr <= aModuleBase && addr >= (aModuleBase - aModuleSize))
         ) {
         retval = _SymLoadModule(GetCurrentProcess(), NULL, aModuleName, NULL, aModuleBase, aModuleSize);
+        if (!retval)
+            PrintError("SymLoadModule");
     }
 
     return retval;
@@ -300,6 +302,8 @@ static BOOL CALLBACK callbackEspecial64(
        : (addr <= aModuleBase && addr >= (aModuleBase - aModuleSize))
         ) {
         retval = _SymLoadModule64(GetCurrentProcess(), NULL, aModuleName, NULL, aModuleBase, aModuleSize);
+        if (!retval)
+            PrintError("SymLoadModule64");
     }
 
     return retval;
@@ -350,6 +354,8 @@ BOOL SymGetModuleInfoEspecial(HANDLE aPr
              * If it fails, then well, we have other problems.
              */
             retval = _SymGetModuleInfo(aProcess, aAddr, aModuleInfo);
+            if (!retval)
+                PrintError("SymGetModuleInfo");
         }
     }
 
@@ -400,6 +406,8 @@ BOOL SymGetModuleInfoEspecial64(HANDLE a
              * If it fails, then well, we have other problems.
              */
             retval = _SymGetModuleInfo64(aProcess, aAddr, aModuleInfo);
+            if (!retval)
+                PrintError("SymGetModuleInfo64");
         }
     }
 
@@ -474,7 +482,7 @@ NS_StackWalk(NS_WalkStackCallback aCallb
                            ::GetCurrentProcess(),
                            ::GetCurrentProcess(),
                            &myProcess,
-                           THREAD_ALL_ACCESS, FALSE, 0)) {
+                           PROCESS_ALL_ACCESS, FALSE, 0)) {
         PrintError("DuplicateHandle (process)");
         return NS_ERROR_FAILURE;
     }
