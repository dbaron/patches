Fix occasional leak of either array or hashtable entrystore allocated in js_AddLocal by accounting for fun->u.i.upvars in DestroyLocalNames.  (Bug 487967)

diff --git a/js/src/jsfun.cpp b/js/src/jsfun.cpp
--- a/js/src/jsfun.cpp
+++ b/js/src/jsfun.cpp
@@ -2762,17 +2762,17 @@ TraceLocalNames(JSTracer *trc, JSFunctio
     }
 }
 
 void
 DestroyLocalNames(JSContext *cx, JSFunction *fun)
 {
     uintN n;
 
-    n = fun->nargs + fun->u.i.nvars;
+    n = JS_GET_LOCAL_NAME_COUNT(fun);
     if (n <= 1)
         return;
     if (n <= MAX_ARRAY_LOCALS)
         JS_free(cx, fun->u.i.names.array);
     else
         FreeLocalNameHash(cx, fun->u.i.names.map);
 }
 
