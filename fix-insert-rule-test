Split insert-rule-1 into two tests, each of which inserts only one rule, so that we can remove reftest-wait at the right time and make the test reliable.  (Bug 472267)

diff --git a/layout/reftests/font-face/insert-rule-1.html b/layout/reftests/font-face/insert-rule-1a.html
rename from layout/reftests/font-face/insert-rule-1.html
rename to layout/reftests/font-face/insert-rule-1a.html
--- a/layout/reftests/font-face/insert-rule-1.html
+++ b/layout/reftests/font-face/insert-rule-1a.html
@@ -1,28 +1,28 @@
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
 	"http://www.w3.org/TR/html4/strict.dtd">
 <html lang="en-US" class="reftest-wait">
 <head>
 	<title></title>
 	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 	<style type="text/css">
 
+	@font-face { font-family: 'MarkB'; src: url(../fonts/markB.ttf); }
 	body { font-family: "MarkA", "MarkB"; }
 
 	</style>
 	<script type="application/ecmascript">
 
 	function run() {
 		// The resize-detector iframe will remove the class attribute.
 		document.getElementsByTagName("iframe")[0].contentWindow.arm();
 
 		var sheet = document.getElementsByTagName("style")[0].sheet;
 		sheet.insertRule("@font-face { font-family: 'MarkA'; src: url(../fonts/markA.ttf); }", sheet.cssRules.length);
-		sheet.insertRule("@font-face { font-family: 'MarkB'; src: url(../fonts/markB.ttf); }", 0);
 	}
 
 	</script>
 </head>
 <body onload="setTimeout(run, 20)">
 
 <p style="position:relative; width: -moz-max-content">ABC<iframe style="visibility:hidden;position:absolute;height:100%;width:100%" src="resize-detector-iframe.html"></iframe></p>
 
diff --git a/layout/reftests/font-face/insert-rule-1.html b/layout/reftests/font-face/insert-rule-1b.html
copy from layout/reftests/font-face/insert-rule-1.html
copy to layout/reftests/font-face/insert-rule-1b.html
--- a/layout/reftests/font-face/insert-rule-1.html
+++ b/layout/reftests/font-face/insert-rule-1b.html
@@ -2,26 +2,26 @@
 	"http://www.w3.org/TR/html4/strict.dtd">
 <html lang="en-US" class="reftest-wait">
 <head>
 	<title></title>
 	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 	<style type="text/css">
 
 	body { font-family: "MarkA", "MarkB"; }
+	@font-face { font-family: 'MarkA'; src: url(../fonts/markA.ttf); }
 
 	</style>
 	<script type="application/ecmascript">
 
 	function run() {
 		// The resize-detector iframe will remove the class attribute.
 		document.getElementsByTagName("iframe")[0].contentWindow.arm();
 
 		var sheet = document.getElementsByTagName("style")[0].sheet;
-		sheet.insertRule("@font-face { font-family: 'MarkA'; src: url(../fonts/markA.ttf); }", sheet.cssRules.length);
 		sheet.insertRule("@font-face { font-family: 'MarkB'; src: url(../fonts/markB.ttf); }", 0);
 	}
 
 	</script>
 </head>
 <body onload="setTimeout(run, 20)">
 
 <p style="position:relative; width: -moz-max-content">ABC<iframe style="visibility:hidden;position:absolute;height:100%;width:100%" src="resize-detector-iframe.html"></iframe></p>
diff --git a/layout/reftests/font-face/reftest.list b/layout/reftests/font-face/reftest.list
--- a/layout/reftests/font-face/reftest.list
+++ b/layout/reftests/font-face/reftest.list
@@ -47,17 +47,18 @@ skip HTTP(..) == enable-sheet-7.html mul
 HTTP(..) == disable-sheet-1.html disable-sheet-1-ref.html
 # We're missing disable-sheet-{2,3,6,7} (analogs to
 # enable-sheet{2,3,6,7}) because I don't know how to detect test
 # completion for those cases.
 HTTP(..) == disable-sheet-4.html disable-sheet-4-ref.html
 HTTP(..) == disable-sheet-5.html disable-sheet-4-ref.html
 HTTP(..) == sheet-set-base-1.html sheet-set-base-1-ref.html
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") HTTP(..) == sheet-set-switch-1.html sheet-set-switch-1-ref.html # gtk2 failure is bug 468217
-random HTTP(..) == insert-rule-1.html insert-rule-1-ref.html # bug 472267
+HTTP(..) == insert-rule-1a.html insert-rule-1-ref.html
+HTTP(..) == insert-rule-1b.html insert-rule-1-ref.html
 HTTP(..) == delete-rule-1.html delete-rule-1-ref.html
 HTTP(..) == media-query-add-1.html media-query-add-1-ref.html
 HTTP(..) == media-query-remove-1.html media-query-remove-1-ref.html
 HTTP(..) != media-query-add-1-ref.html media-query-remove-1-ref.html
 
 HTTP(..) == ahem-metrics-1.html ahem-metrics-1-ref.html
 HTTP(..) == ex-unit-1.html ex-unit-1-ref.html
 HTTP(..) == ex-unit-1-dynamic.html ex-unit-1-ref.html
