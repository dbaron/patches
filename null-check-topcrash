From: L. David Baron <dbaron@dbaron.org>

Try to fix topcrash bug 752428 by null-checking the result of nsIPresShell::FrameManager(), which isn't supposed to need it.  r=roc  ALREADY LANDED

diff --git a/dom/base/nsDOMWindowUtils.cpp b/dom/base/nsDOMWindowUtils.cpp
--- a/dom/base/nsDOMWindowUtils.cpp
+++ b/dom/base/nsDOMWindowUtils.cpp
@@ -303,20 +303,23 @@ MaybeReflowForInflationScreenWidthChange
         nsCOMPtr<nsIMarkupDocumentViewer> mudv = do_QueryInterface(cv);
         if (mudv) {
           nsTArray<nsCOMPtr<nsIMarkupDocumentViewer> > array;
           mudv->AppendSubtree(array);
           for (PRUint32 i = 0, iEnd = array.Length(); i < iEnd; ++i) {
             nsCOMPtr<nsIPresShell> shell;
             nsCOMPtr<nsIContentViewer> cv = do_QueryInterface(array[i]);
             cv->GetPresShell(getter_AddRefs(shell));
-            nsIFrame *rootFrame = shell->GetRootFrame();
-            if (rootFrame) {
-              shell->FrameNeedsReflow(rootFrame, nsIPresShell::eResize,
-                                      NS_FRAME_IS_DIRTY);
+            nsFrameManager *fm = shell->FrameManager();
+            if (fm) {
+              nsIFrame *rootFrame = fm->GetRootFrame();
+              if (rootFrame) {
+                shell->FrameNeedsReflow(rootFrame, nsIPresShell::eResize,
+                                        NS_FRAME_IS_DIRTY);
+              }
             }
           }
         }
       }
     }
   }
 }
 
