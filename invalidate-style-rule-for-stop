From: L. David Baron <dbaron@dbaron.org>

Bug 960465 patch N - Invalidate the collection's style rule when we stop some but not all transitions.

diff --git a/layout/style/nsTransitionManager.cpp b/layout/style/nsTransitionManager.cpp
--- a/layout/style/nsTransitionManager.cpp
+++ b/layout/style/nsTransitionManager.cpp
@@ -338,30 +338,31 @@ nsTransitionManager::StyleContextChanged
     } while (i != 0);
 
     if (players.IsEmpty()) {
       collection->Destroy();
       collection = nullptr;
     }
   }
 
-  if (!startedAny) {
-    return;
+  NS_ABORT_IF_FALSE(!startedAny || collection,
+                    "must have element transitions if we started "
+                    "any transitions");
+
+  if (collection) {
+    // Set the style rule refresh time to null so that EnsureStyleRuleFor
+    // creates a new style rule if we started *or* stopped transitions.
+    collection->mStyleRuleRefreshTime = TimeStamp();
   }
 
-  NS_ABORT_IF_FALSE(collection, "must have element transitions if we started "
-                                "any transitions");
-
-  // Set the style rule refresh time to null so that EnsureStyleRuleFor
-  // creates a new style rule.
-  collection->mStyleRuleRefreshTime = TimeStamp();
-
   // Replace the new style context by appending the cover rule.
   nsCOMArray<nsIStyleRule> rules;
-  rules.AppendObject(coverRule);
+  if (startedAny) {
+    rules.AppendObject(coverRule);
+  }
   *aNewStyleContext = mPresContext->StyleSet()->
                         ResolveStyleByAddingRules(*aNewStyleContext, rules);
 }
 
 void
 nsTransitionManager::ConsiderStartingTransition(
   nsCSSProperty aProperty,
   const StyleTransition& aTransition,
