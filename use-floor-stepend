From: L. David Baron <dbaron@dbaron.org>

Make the StepEnd function use floor.

I think this may have been for
https://bugzilla.mozilla.org/show_bug.cgi?id=829168#c2
though
https://bugzilla.mozilla.org/show_bug.cgi?id=859018
suggests otherwise.

diff --git a/layout/style/AnimationCommon.cpp b/layout/style/AnimationCommon.cpp
--- a/layout/style/AnimationCommon.cpp
+++ b/layout/style/AnimationCommon.cpp
@@ -357,18 +357,18 @@ ComputedTimingFunction::Init(const nsTim
     mSteps = aFunction.mSteps;
   }
 }
 
 static inline double
 StepEnd(uint32_t aSteps, double aPortion)
 {
   NS_ABORT_IF_FALSE(0.0 <= aPortion && aPortion <= 1.0, "out of range");
-  uint32_t step = uint32_t(aPortion * aSteps); // floor
-  return double(step) / double(aSteps);
+  double step = floor(aPortion * aSteps);
+  return step / double(aSteps);
 }
 
 double
 ComputedTimingFunction::GetValue(double aPortion) const
 {
   switch (mType) {
     case nsTimingFunction::Function:
       return mTimingFunction.GetSplineValue(aPortion);
