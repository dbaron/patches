From: L. David Baron <dbaron@dbaron.org>

Disable trace-malloc stack walking for tests that use automation.py.  (Bug 549561)

diff --git a/build/automation.py.in b/build/automation.py.in
--- a/build/automation.py.in
+++ b/build/automation.py.in
@@ -836,16 +836,17 @@ user_pref("camino.use_system_proxy_setti
       timeout = self.DEFAULT_TIMEOUT
 
     # copy env so we don't munge the caller's environment
     env = dict(env);
     env["NO_EM_RESTART"] = "1"
     tmpfd, processLog = tempfile.mkstemp(suffix='pidlog')
     os.close(tmpfd)
     env["MOZ_PROCESS_LOG"] = processLog
+    env["NS_TRACE_MALLOC_DISABLE_STACKS"] = "1"
 
     if self.IS_TEST_BUILD and runSSLTunnel:
       # create certificate database for the profile
       certificateStatus = self.fillCertificateDB(profileDir, certPath, utilityPath, xrePath)
       if certificateStatus != 0:
         self.log.info("TEST-UNEXPECTED FAIL | automation.py | Certificate integration failed")
         return certificateStatus
 
