From: L. David Baron <dbaron@dbaron.org>

Bug 850559:  Fix tests that call advanceTimeAndRefresh without calling restoreNormalRefresh.  r=vlad

diff --git a/content/events/test/test_bug574663.html b/content/events/test/test_bug574663.html
--- a/content/events/test/test_bug574663.html
+++ b/content/events/test/test_bug574663.html
@@ -54,16 +54,17 @@ function runTest() {
 
     // grab the refresh driver, since we want to make sure
     // async scrolls happen in deterministic time
     winUtils.advanceTimeAndRefresh(1000);
 
     function nextTest() {
       netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
       if (!outstandingTests.length) {
+        winUtils.restoreNormalRefresh();
         win.close();
         clearPrefs();
         SimpleTest.finish();
         return;
       }
 
       let [ctrlKey, isMomentum] = outstandingTests.shift();
       let scrollTopBefore = scrollbox.scrollTop;
diff --git a/content/events/test/window_wheel_default_action.html b/content/events/test/window_wheel_default_action.html
--- a/content/events/test/window_wheel_default_action.html
+++ b/content/events/test/window_wheel_default_action.html
@@ -1774,15 +1774,17 @@ function finishTests()
   SpecialPowers.clearUserPref("mousewheel.with_meta.delta_multiplier_z");
   SpecialPowers.clearUserPref("mousewheel.with_shift.delta_multiplier_x");
   SpecialPowers.clearUserPref("mousewheel.with_shift.delta_multiplier_y");
   SpecialPowers.clearUserPref("mousewheel.with_shift.delta_multiplier_z");
   SpecialPowers.clearUserPref("mousewheel.with_win.delta_multiplier_x");
   SpecialPowers.clearUserPref("mousewheel.with_win.delta_multiplier_y");
   SpecialPowers.clearUserPref("mousewheel.with_win.delta_multiplier_z");
 
+  winUtils.restoreNormalRefresh();
+
   window.opener.finish();
 }
 
 </script>
 </pre>
 </body>
 </html>
