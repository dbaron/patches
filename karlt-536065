From: Karl Tomlinson <karlt@mozbugz.karlt.net>

Don't init pixman regions with empty boxes.  (Bug 536065)

diff --git a/widget/src/gtk2/nsWindow.cpp b/widget/src/gtk2/nsWindow.cpp
--- a/widget/src/gtk2/nsWindow.cpp
+++ b/widget/src/gtk2/nsWindow.cpp
@@ -1737,17 +1737,19 @@ ToIntRect(const pixman_box32& aBox)
 
 static void
 InitRegion(pixman_region32* aRegion,
            const nsTArray<nsIntRect>& aRects)
 {
     nsAutoTArray<pixman_box32,10> rects;
     rects.SetCapacity(aRects.Length());
     for (PRUint32 i = 0; i < aRects.Length (); ++i) {
-        rects.AppendElement(ToPixmanBox(aRects[i]));
+        if (!aRects[i].IsEmpty()) {
+            rects.AppendElement(ToPixmanBox(aRects[i]));
+        }
     }
 
     pixman_region32_init_rects(aRegion,
                                rects.Elements(), rects.Length());
 }
 
 static void
 GetIntRects(pixman_region32& aRegion, nsTArray<nsIntRect>* aRects)
