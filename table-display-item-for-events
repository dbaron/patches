From: L. David Baron <dbaron@dbaron.org>

Always create nsDisplayTableBorderBackground when we're doing event delivery.  (Bug 541668)

diff --git a/layout/tables/nsTableFrame.cpp b/layout/tables/nsTableFrame.cpp
--- a/layout/tables/nsTableFrame.cpp
+++ b/layout/tables/nsTableFrame.cpp
@@ -1322,20 +1322,23 @@ nsTableFrame::BuildDisplayList(nsDisplay
     // opacity and visibility optimizations
     if (deflate.IsZero()) {
       nsresult rv = DisplayBackgroundUnconditional(aBuilder, aLists, PR_FALSE);
       NS_ENSURE_SUCCESS(rv, rv);
     }
   }
 
   nsDisplayTableItem* item = nsnull;
-  // This background is created if any of the table parts are visible.
+  // This background is created if any of the table parts are visible,
+  // or if we're doing event handling (since DisplayGenericTablePart
+  // needs the item for the |sortEventBackgrounds|-dependent code).
   // Specific visibility decisions are delegated to the table background
   // painter, which handles borders and backgrounds for the table.
-  if (AnyTablePartHasBorderOrBackground(this)) {
+  if (aBuilder->IsForEventDelivery() ||
+      AnyTablePartHasBorderOrBackground(this)) {
     item = new (aBuilder) nsDisplayTableBorderBackground(this);
     nsresult rv = aLists.BorderBackground()->AppendNewToTop(item);
     NS_ENSURE_SUCCESS(rv, rv);
   }
 
   return DisplayGenericTablePart(aBuilder, this, aDirtyRect, aLists, item);
 }
 
