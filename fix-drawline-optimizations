From: L. David Baron <dbaron@dbaron.org>

Fix both the test for whether to use the DrawLine optimization for table border drawing and the optimization itself.  (NEED TO ADD TESTS OTHER THAN layout/reftests/bugs/356774-1.html WHICH FAILS ON MAC THAT WOULD FAIL WITH THE BROKEN CODE; WE CURRENTLY HAVE NONE)  (BREAKS THINGS WITH ZOOM SINCE NUMBER IS TWIPS PER CSS PIXEL)

diff --git a/layout/base/nsCSSRendering.cpp b/layout/base/nsCSSRendering.cpp
--- a/layout/base/nsCSSRendering.cpp
+++ b/layout/base/nsCSSRendering.cpp
@@ -3501,25 +3501,25 @@ DrawSolidBorderSegment(nsRenderingContex
 
   ColorPattern color(ToDeviceColor(aColor));
   DrawOptions drawOptions(1.f, CompositionOp::OP_OVER, AntialiasMode::NONE);
 
   if ((aRect.width == aTwipsPerPixel) || (aRect.height == aTwipsPerPixel) ||
       ((0 == aStartBevelOffset) && (0 == aEndBevelOffset))) {
     // simple line or rectangle
     if ((NS_SIDE_TOP == aStartBevelSide) || (NS_SIDE_BOTTOM == aStartBevelSide)) {
-      if (1 == aRect.height)
-        aContext.DrawLine(aRect.TopLeft(), aRect.BottomLeft());
+      if (aTwipsPerPixel == aRect.height)
+        aContext.DrawLine(aRect.TopLeft(), aRect.TopRight());
       else
         drawTarget->FillRect(NSRectToRect(aRect, appUnitsPerDevPixel, *drawTarget),
                              color, drawOptions);
     }
     else {
-      if (1 == aRect.width)
-        aContext.DrawLine(aRect.TopLeft(), aRect.TopRight());
+      if (aTwipsPerPixel == aRect.width)
+        aContext.DrawLine(aRect.TopLeft(), aRect.BottomLeft());
       else
         drawTarget->FillRect(NSRectToRect(aRect, appUnitsPerDevPixel, *drawTarget),
                              color, drawOptions);
     }
   }
   else {
     // polygon with beveling
     Point poly[4];
