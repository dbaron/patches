Stop shipping scripts to the head if the body hasn't been explicitly opened yet.  (Bug 178258)

diff --git a/parser/htmlparser/src/CNavDTD.cpp b/parser/htmlparser/src/CNavDTD.cpp
--- a/parser/htmlparser/src/CNavDTD.cpp
+++ b/parser/htmlparser/src/CNavDTD.cpp
@@ -1398,24 +1398,16 @@ CNavDTD::HandleStartToken(CToken* aToken
           aToken->SetTypeID(theChildTag = eHTMLTag_img);
           break;
 
         case eHTMLTag_keygen:
           result = HandleKeyGen(theNode);
           isTokenHandled = PR_TRUE;
           break;
 
-        case eHTMLTag_script:
-          // Script isn't really exclusively in the head. However, we treat it
-          // as such to make sure that we don't pull scripts outside the head
-          // into the body.
-          // XXX Where does the script go in a frameset document?
-          isExclusive = !(mFlags & NS_DTD_FLAG_HAD_BODY);
-          break;
-
         default:;
       }
 
       if (!isTokenHandled) {
         PRBool prefersBody =
           gHTMLElements[theChildTag].HasSpecialProperty(kPreferBody);
 
         // If this tag prefers to be in the head (when neither the head nor the
diff --git a/parser/htmlparser/src/nsElementTable.cpp b/parser/htmlparser/src/nsElementTable.cpp
--- a/parser/htmlparser/src/nsElementTable.cpp
+++ b/parser/htmlparser/src/nsElementTable.cpp
@@ -1022,17 +1022,17 @@ const nsHTMLElement gHTMLElements[] = {
     /*special parents,kids,skip*/       0,0,eHTMLTag_unknown,
     /*contain-func*/                    0
   },
   {
     /*tag*/                             eHTMLTag_script,
     /*req-parent excl-parent*/          eHTMLTag_unknown,eHTMLTag_unknown,
     /*rootnodes,endrootnodes*/          &gRootTags,&gRootTags,
     /*autoclose starttags and endtags*/ 0,0,0,0,
-    /*parent,incl,exclgroups*/          (kSpecial|kHeadContent), kCDATA, kNone,   // note: this is kHeadContent since shipping this breaks things.
+    /*parent,incl,exclgroups*/          (kSpecial|kHeadMisc), kCDATA, kNone,
     /*special props, prop-range*/       kNoStyleLeaksIn|kLegalOpen, kNoPropRange,
     /*special parents,kids,skip*/       0,&gContainsText,eHTMLTag_unknown,
     /*contain-func*/                    0
   },
   {
     /*tag*/                             eHTMLTag_select,
     /*requiredAncestor*/                eHTMLTag_unknown, eHTMLTag_unknown,
     /*rootnodes,endrootnodes*/          &gInForm,&gInForm,
