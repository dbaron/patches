From: L. David Baron <dbaron@dbaron.org>

Make nsFrameList::RemoveFramesAfter(nsnull) remove the whole list.  (Bug 563584)  r=roc

diff --git a/layout/generic/nsFrameList.cpp b/layout/generic/nsFrameList.cpp
--- a/layout/generic/nsFrameList.cpp
+++ b/layout/generic/nsFrameList.cpp
@@ -150,16 +150,22 @@ nsFrameList::RemoveFrameIfPresent(nsIFra
     }
   }
   return PR_FALSE;
 }
 
 nsFrameList
 nsFrameList::RemoveFramesAfter(nsIFrame* aAfterFrame)
 {
+  if (!aAfterFrame) {
+    nsFrameList result;
+    result.InsertFrames(nsnull, nsnull, *this);
+    return result;
+  }
+
   NS_PRECONDITION(NotEmpty(), "illegal operation on empty list");
 #ifdef DEBUG_FRAME_LIST
   NS_PRECONDITION(ContainsFrame(aAfterFrame), "wrong list");
 #endif
 
   nsIFrame* tail = aAfterFrame->GetNextSibling();
   // if (!tail) return EmptyList();  -- worth optimizing this case?
   nsIFrame* oldLastChild = mLastChild;
diff --git a/layout/generic/nsFrameList.h b/layout/generic/nsFrameList.h
--- a/layout/generic/nsFrameList.h
+++ b/layout/generic/nsFrameList.h
@@ -147,18 +147,19 @@ public:
    * Take aFrame out of the frame list, if present. This also disconnects
    * aFrame from the sibling list. aFrame must be non-null but is not
    * required to be on the list.
    * @return PR_TRUE if aFrame was removed
    */
   PRBool RemoveFrameIfPresent(nsIFrame* aFrame);
 
   /**
-   * Take the frames after aAfterFrame out of the frame list.
-   * @param aAfterFrame a frame in this list
+   * Take the frames after aAfterFrame out of the frame list.  If
+   * aAfterFrame is null, removes the entire list.
+   * @param aAfterFrame a frame in this list, or null
    * @return the removed frames, if any
    */
   nsFrameList RemoveFramesAfter(nsIFrame* aAfterFrame);
 
   /**
    * Take the first frame (if any) out of the frame list.
    * @return the first child, or nsnull if the list is empty
    */
