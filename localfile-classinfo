Implement classinfo for local files.

diff --git a/xpcom/build/nsXPComInit.cpp b/xpcom/build/nsXPComInit.cpp
--- a/xpcom/build/nsXPComInit.cpp
+++ b/xpcom/build/nsXPComInit.cpp
@@ -232,6 +232,8 @@ NS_GENERIC_FACTORY_CONSTRUCTOR_INIT(nsSy
 
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsMemoryReporterManager)
 
+NS_DECL_CLASSINFO(nsLocalFile)
+
 static NS_METHOD
 nsThreadManagerGetSingleton(nsISupports* outer,
                             const nsIID& aIID,
@@ -408,7 +410,8 @@ static const nsModuleComponentInfo compo
 
 #undef COMPONENT_SUPPORTS
 #define NS_LOCAL_FILE_CLASSNAME "Local File Specification"
-    COMPONENT(LOCAL_FILE, nsLocalFile::nsLocalFileConstructor),
+    COMPONENT_CI_FLAGS(LOCAL_FILE, nsLocalFile::nsLocalFileConstructor,
+                       nsLocalFile, nsIClassInfo::THREADSAFE),
 #define NS_DIRECTORY_SERVICE_CLASSNAME  "nsIFile Directory Service"
     COMPONENT(DIRECTORY_SERVICE, nsDirectoryService::Create),
     COMPONENT(PROCESS, nsProcessConstructor),
diff --git a/xpcom/io/nsLocalFileUnix.cpp b/xpcom/io/nsLocalFileUnix.cpp
--- a/xpcom/io/nsLocalFileUnix.cpp
+++ b/xpcom/io/nsLocalFileUnix.cpp
@@ -88,6 +88,7 @@
 
 #include "nsNativeCharsetUtils.h"
 #include "nsTraceRefcntImpl.h"
+#include "nsIClassInfoImpl.h"
 
 // On some platforms file/directory name comparisons need to
 // be case-blind.
@@ -257,10 +258,17 @@ nsLocalFile::nsLocalFile(const nsLocalFi
 {
 }
 
-NS_IMPL_THREADSAFE_ISUPPORTS3(nsLocalFile,
-                              nsIFile,
-                              nsILocalFile,
-                              nsIHashable)
+NS_IMPL_THREADSAFE_ADDREF(nsLocalFile)
+NS_IMPL_THREADSAFE_RELEASE(nsLocalFile)
+NS_IMPL_QUERY_INTERFACE3_CI(nsLocalFile,
+                            nsIFile,
+                            nsILocalFile,
+                            nsIHashable)
+// XXX Should we include all these interfaces?
+NS_IMPL_CI_INTERFACE_GETTER3(nsLocalFile,
+                             nsIFile,
+                             nsILocalFile,
+                             nsIHashable)
 
 nsresult
 nsLocalFile::nsLocalFileConstructor(nsISupports *outer, 
