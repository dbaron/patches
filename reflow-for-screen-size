From: L. David Baron <dbaron@dbaron.org>

Reflow for screen size change when font.size.inflation.minTwips is set.  (Bug 747231, patch 2)

diff --git a/dom/base/nsDOMWindowUtils.cpp b/dom/base/nsDOMWindowUtils.cpp
--- a/dom/base/nsDOMWindowUtils.cpp
+++ b/dom/base/nsDOMWindowUtils.cpp
@@ -327,16 +327,27 @@ nsDOMWindowUtils::SetDisplayPortForEleme
 
   nsIFrame* rootScrollFrame = presShell->GetRootScrollFrame();
   if (rootScrollFrame) {
     if (content == rootScrollFrame->GetContent()) {
       // We are setting a root displayport for a document.
       // The pres shell needs a special flag set.
       presShell->SetIgnoreViewportScrolling(true);
 
+      // When the "font.size.inflation.minTwips" preference is set, the
+      // layout depends on the size of the screen.  Since when the size
+      // of the screen changes, the root displayport also changes, we
+      // hook in the needed updates here rather than adding a
+      // separate notification just for this change.
+      // FIXME:
+      // 1. Check relevant inflation pref (minTwips)
+      // 2. Check against old screen width
+      // 3. If changed, do synchronous (?) reflow in this pres shell (and
+      //    all descendants?)
+
       // The root document currently has a widget, but we might end up
       // painting content inside the displayport but outside the widget
       // bounds. This ensures the document's view honors invalidations
       // within the displayport.
       nsPresContext* presContext = GetPresContext();
       if (presContext && presContext->IsRoot()) {
         nsIFrame* rootFrame = presShell->GetRootFrame();
         nsIView* view = rootFrame->GetView();
