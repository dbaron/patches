From: L. David Baron <dbaron@dbaron.org>

diff --git a/xpcom/string/public/nsCharTraits.h b/xpcom/string/public/nsCharTraits.h
--- a/xpcom/string/public/nsCharTraits.h
+++ b/xpcom/string/public/nsCharTraits.h
@@ -92,17 +92,17 @@
 #define ENSURE_VALID_CHAR(c) (IS_VALID_CHAR(c) ? (c) : UCS2_REPLACEMENT_CHAR)
 
 template <class CharT> struct nsCharTraits {};
 
 template <>
 struct nsCharTraits<PRUnichar>
   {
     typedef PRUnichar char_type;
-    typedef uint16_t  unsigned_char_type;
+    typedef uint16_t  unsigned_char_type; /* PRUnichar is always unsigned, though */
     typedef char      incompatible_char_type;
 
     static char_type *sEmptyBuffer;
 
     static
     void
     assign( char_type& lhs, char_type rhs )
       {
@@ -385,17 +385,18 @@ struct nsCharTraits<char>
       {
         return lhs == rhs;
       }
 
     static
     bool
     lt( char_type lhs, char_type rhs )
       {
-        return lhs < rhs;
+        return static_cast<unsigned_char_type>(lhs) <
+               static_cast<unsigned_char_type>(rhs);
       }
 
 
       // operations on s[n] arrays:
 
     static
     char_type*
     move( char_type* s1, const char_type* s2, size_t n )
