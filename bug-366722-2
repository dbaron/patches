Make non-box frames pay better attention to nsITheme::GetWidgetBorder.  b=366722

diff -r 61869b317cb4 layout/generic/nsFrame.cpp
--- a/layout/generic/nsFrame.cpp	Thu Jan 18 11:02:41 2007 -0800
+++ b/layout/generic/nsFrame.cpp	Thu Jan 18 12:13:59 2007 -0800
@@ -712,6 +712,24 @@ nsIFrame::GetUsedBorder() const
                  (NS_FRAME_IS_DIRTY | NS_FRAME_HAS_DIRTY_CHILDREN)) ||
                (GetStateBits() & NS_FRAME_IN_REFLOW),
                "cannot call on a dirty frame not currently being reflowed");
+
+  // Theme methods don't use const-ness.
+  nsIFrame *mutable_this = NS_CONST_CAST(nsIFrame*, this);
+
+  const nsStyleDisplay *disp = GetStyleDisplay();
+  if (mutable_this->IsThemed(disp)) {
+    nsMargin result;
+    nsPresContext *presContext = GetPresContext();
+    presContext->GetTheme()->GetWidgetBorder(presContext->DeviceContext(),
+                                             mutable_this, disp->mAppearance,
+                                             &result);
+    float p2t = presContext->ScaledPixelsToTwips();
+    result.top = NSIntPixelsToTwips(result.top, p2t);
+    result.right = NSIntPixelsToTwips(result.right, p2t);
+    result.bottom = NSIntPixelsToTwips(result.bottom, p2t);
+    result.left = NSIntPixelsToTwips(result.left, p2t);
+    return result;
+  }
 
   return GetStyleBorder()->GetBorder();
 }
