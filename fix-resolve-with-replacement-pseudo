From: L. David Baron <dbaron@dbaron.org>

Bug 960465 patch N - Fix the pseudo element information created by ResolveStyleWithReplacement.

diff --git a/layout/style/nsStyleSet.cpp b/layout/style/nsStyleSet.cpp
--- a/layout/style/nsStyleSet.cpp
+++ b/layout/style/nsStyleSet.cpp
@@ -1414,17 +1414,18 @@ nsStyleSet::ResolveStyleWithReplacement(
   if (aOldStyleContext->IsLinkContext()) {
     flags |= eIsLink;
   }
   if (aOldStyleContext->RelevantLinkVisited()) {
     flags |= eIsVisitedLink;
   }
 
   return GetContext(aParentStyleContext, ruleNode, visitedRuleNode,
-                    nullptr, nsCSSPseudoElements::ePseudo_NotPseudoElement,
+                    aOldStyleContext->GetPseudo(),
+                    aOldStyleContext->GetPseudoType(),
                     nullptr, flags);
 }
 
 
 already_AddRefed<nsStyleContext>
 nsStyleSet::ResolveStyleForNonElement(nsStyleContext* aParentContext)
 {
   return GetContext(aParentContext, mRuleTree, nullptr,
