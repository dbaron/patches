From: L. David Baron <dbaron@dbaron.org>

Remove InspectorCSSUtils, part 4: Remove nsIInspectorCSSUtils and nsInspectorCSSUtils.  (Bug 371655)  r=bzbarsky

diff --git a/layout/build/nsLayoutModule.cpp b/layout/build/nsLayoutModule.cpp
--- a/layout/build/nsLayoutModule.cpp
+++ b/layout/build/nsLayoutModule.cpp
@@ -38,17 +38,16 @@
 
 #include "nsLayoutStatics.h"
 #include "nsContentCID.h"
 #include "nsContentDLF.h"
 #include "nsContentPolicyUtils.h"
 #include "nsDataDocumentContentPolicy.h"
 #include "nsNoDataProtocolContentPolicy.h"
 #include "nsDOMCID.h"
-#include "nsInspectorCSSUtils.h"
 #include "nsHTMLContentSerializer.h"
 #include "nsHTMLParts.h"
 #include "nsGenericHTMLElement.h"
 #include "nsICSSLoader.h"
 #include "nsICSSParser.h"
 #include "nsICSSStyleSheet.h"
 #include "nsICategoryManager.h"
 #include "nsIComponentManager.h"
@@ -525,17 +524,16 @@ MAKE_CTOR(CreateXULDocument,            
 // NS_NewXULPrototypeCache
 MAKE_CTOR(CreateXULPopupManager,      nsISupports,      NS_NewXULPopupManager)
 #endif
 #ifdef MOZ_XTF
 MAKE_CTOR(CreateXTFService,               nsIXTFService,               NS_NewXTFService)
 MAKE_CTOR(CreateXMLContentBuilder,        nsIXMLContentBuilder,        NS_NewXMLContentBuilder)
 #endif
 MAKE_CTOR(CreateContentDLF,               nsIDocumentLoaderFactory,    NS_NewContentDocumentLoaderFactory)
-NS_GENERIC_FACTORY_CONSTRUCTOR(nsInspectorCSSUtils)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsWyciwygProtocolHandler)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsContentAreaDragDrop)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsDataDocumentContentPolicy)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsNoDataProtocolContentPolicy)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsSyncLoadService)
 MAKE_CTOR(CreatePluginDocument,           nsIDocument,                 NS_NewPluginDocument)
 #ifdef MOZ_MEDIA
 MAKE_CTOR(CreateVideoDocument,            nsIDocument,                 NS_NewVideoDocument)
@@ -1048,21 +1046,16 @@ static const nsModuleComponentInfo gComp
     "@mozilla.org/content/pre-content-iterator;1",
     CreatePreContentIterator },
 
   { "Subtree iterator",
     NS_SUBTREEITERATOR_CID,
     "@mozilla.org/content/subtree-content-iterator;1",
     CreateSubtreeIterator },
 
-  { "Inspector CSS Utils",
-    NS_INSPECTORCSSUTILS_CID,
-    nsnull,
-    nsInspectorCSSUtilsConstructor },
-
   // Needed to support "new Option;", "new Image;" and "new Audio;" in JavaScript
   { "HTML img element",
     NS_HTMLIMAGEELEMENT_CID,
     NS_HTMLIMGELEMENT_CONTRACTID,
     CreateHTMLImgElement,
     RegisterHTMLImgElement, 
     UnregisterHTMLImgElement },
 
diff --git a/layout/inspector/src/inCSSValueSearch.cpp b/layout/inspector/src/inCSSValueSearch.cpp
--- a/layout/inspector/src/inCSSValueSearch.cpp
+++ b/layout/inspector/src/inCSSValueSearch.cpp
@@ -48,32 +48,29 @@
 #include "nsIDOMCSSRuleList.h"
 #include "nsIDOMCSSStyleRule.h"
 #include "nsIDOMCSSStyleDeclaration.h"
 #include "nsIDOMCSSImportRule.h"
 #include "nsIDOMCSSMediaRule.h"
 #include "nsIURI.h"
 #include "nsNetUtil.h"
 
-static NS_DEFINE_CID(kInspectorCSSUtilsCID, NS_INSPECTORCSSUTILS_CID);
-
 ///////////////////////////////////////////////////////////////////////////////
 inCSSValueSearch::inCSSValueSearch()
   : mResults(nsnull),
     mProperties(nsnull),
     mResultCount(0),
     mPropertyCount(0),
     mIsActive(PR_FALSE),
     mHoldResults(PR_TRUE),
     mReturnRelativeURLs(PR_TRUE),
     mNormalizeChromeURLs(PR_FALSE)
 {
   nsCSSProps::AddRefTable();
   mProperties = new nsCSSProperty[100];
-  mCSSUtils = do_GetService(kInspectorCSSUtilsCID);
 }
 
 inCSSValueSearch::~inCSSValueSearch()
 {
   delete[] mProperties;
   delete mResults;
   nsCSSProps::ReleaseTable();
 }
diff --git a/layout/inspector/src/inCSSValueSearch.h b/layout/inspector/src/inCSSValueSearch.h
--- a/layout/inspector/src/inCSSValueSearch.h
+++ b/layout/inspector/src/inCSSValueSearch.h
@@ -41,17 +41,16 @@
 #include "inICSSValueSearch.h"
 
 #include "nsCOMPtr.h"
 #include "nsString.h"
 #include "nsIDOMDocument.h"
 #include "inISearchObserver.h"
 #include "nsTArray.h"
 #include "nsCSSProps.h"
-#include "nsIInspectorCSSUtils.h"
 
 class nsIDOMCSSStyleSheet;
 class nsIDOMCSSRuleList;
 class nsIDOMCSSStyleRule;
 class nsIURI;
 
 class inCSSValueSearch : public inICSSValueSearch
 {
@@ -60,17 +59,16 @@ public:
   NS_DECL_INISEARCHPROCESS
   NS_DECL_INICSSVALUESEARCH
 
   inCSSValueSearch();
   virtual ~inCSSValueSearch();
 
 protected:
   nsCOMPtr<inISearchObserver> mObserver;
-  nsCOMPtr<nsIInspectorCSSUtils> mCSSUtils;
   nsCOMPtr<nsIDOMDocument> mDocument;
   nsTArray<nsAutoString *>* mResults;
   nsCSSProperty* mProperties;
   nsString mLastResult;
   nsString mBaseURL;
   nsString mTextCriteria;
   PRInt32 mResultCount;
   PRUint32 mPropertyCount;
diff --git a/layout/inspector/src/inDOMUtils.cpp b/layout/inspector/src/inDOMUtils.cpp
--- a/layout/inspector/src/inDOMUtils.cpp
+++ b/layout/inspector/src/inDOMUtils.cpp
@@ -53,23 +53,20 @@
 #include "nsIDOMWindowInternal.h"
 #include "nsXBLBinding.h"
 #include "nsXBLPrototypeBinding.h"
 #include "nsIDOMElement.h"
 #include "nsIMutableArray.h"
 #include "nsBindingManager.h"
 #include "nsComputedDOMStyle.h"
 
-static NS_DEFINE_CID(kInspectorCSSUtilsCID, NS_INSPECTORCSSUTILS_CID);
-
 ///////////////////////////////////////////////////////////////////////////////
 
 inDOMUtils::inDOMUtils()
 {
-  mCSSUtils = do_GetService(kInspectorCSSUtilsCID);
 }
 
 inDOMUtils::~inDOMUtils()
 {
 }
 
 NS_IMPL_ISUPPORTS1(inDOMUtils, inIDOMUtils)
 
diff --git a/layout/inspector/src/inDOMUtils.h b/layout/inspector/src/inDOMUtils.h
--- a/layout/inspector/src/inDOMUtils.h
+++ b/layout/inspector/src/inDOMUtils.h
@@ -37,32 +37,29 @@
 
 #ifndef __inDOMUtils_h__
 #define __inDOMUtils_h__
 
 #include "inIDOMUtils.h"
 
 #include "nsIEventStateManager.h"
 #include "nsISupportsArray.h"
-#include "nsIInspectorCSSUtils.h"
 
 class nsRuleNode;
 
 class inDOMUtils : public inIDOMUtils
 {
 public:
   NS_DECL_ISUPPORTS
   NS_DECL_INIDOMUTILS
 
   inDOMUtils();
   virtual ~inDOMUtils();
 
 private:
-  nsCOMPtr<nsIInspectorCSSUtils> mCSSUtils;
-
   static nsresult GetRuleNodeForContent(nsIContent* aContent,
                                         nsRuleNode** aRuleNode);
 };
 
 // {40B22006-5DD5-42f2-BFE7-7DBF0757AB8B}
 #define IN_DOMUTILS_CID \
 { 0x40b22006, 0x5dd5, 0x42f2, { 0xbf, 0xe7, 0x7d, 0xbf, 0x7, 0x57, 0xab, 0x8b } }
 
diff --git a/layout/inspector/src/inFlasher.cpp b/layout/inspector/src/inFlasher.cpp
--- a/layout/inspector/src/inFlasher.cpp
+++ b/layout/inspector/src/inFlasher.cpp
@@ -41,18 +41,16 @@
 
 #include "nsIServiceManager.h"
 #include "nsIPresShell.h"
 #include "nsIFrame.h"
 #include "nsReadableUtils.h"
 
 #include "prprf.h"
 
-static NS_DEFINE_CID(kInspectorCSSUtilsCID, NS_INSPECTORCSSUTILS_CID);
-
 ///////////////////////////////////////////////////////////////////////////////
 
 inFlasher::inFlasher() :
   mColor(NS_RGB(0,0,0)),
   mThickness(0),
   mInvert(PR_FALSE)
 {
 }
diff --git a/layout/inspector/src/inFlasher.h b/layout/inspector/src/inFlasher.h
--- a/layout/inspector/src/inFlasher.h
+++ b/layout/inspector/src/inFlasher.h
@@ -35,17 +35,16 @@
  *
  * ***** END LICENSE BLOCK ***** */
 
 #ifndef __inFlasher_h__
 #define __inFlasher_h__
 
 #include "inIFlasher.h"
 
-#include "nsIInspectorCSSUtils.h"
 #include "nsIDOMElement.h"
 #include "nsIRenderingContext.h"
 
 #include "nsCOMPtr.h"
 
 #define BOUND_INNER 0
 #define BOUND_OUTER 1
 
diff --git a/layout/style/Makefile.in b/layout/style/Makefile.in
--- a/layout/style/Makefile.in
+++ b/layout/style/Makefile.in
@@ -102,17 +102,16 @@ EXPORTS		= \
 		nsICSSParser.h \
 		nsICSSPseudoComparator.h \
 		nsICSSRule.h \
 		nsICSSRuleList.h \
 		nsICSSStyleRule.h \
 		nsICSSStyleRuleDOMWrapper.h \
 		nsICSSStyleSheet.h \
 		nsIHTMLCSSStyleSheet.h \
-		nsIInspectorCSSUtils.h \
 		nsIStyleRule.h \
 		nsIStyleRuleProcessor.h \
 		nsIStyleSheet.h \
 		nsLayoutStylesheetCache.h \
 		nsRuleData.h \
 		nsRuleNode.h \
 		nsRuleProcessorData.h \
 		nsRuleWalker.h \
@@ -149,17 +148,16 @@ CPPSRCS		= \
 		nsDOMCSSAttrDeclaration.cpp \
 		nsDOMCSSDeclaration.cpp \
 		nsDOMCSSRGBColor.cpp \
 		nsDOMCSSRect.cpp \
 		nsDOMCSSValueList.cpp \
 		nsFontFaceLoader.cpp \
 		nsHTMLCSSStyleSheet.cpp \
 		nsHTMLStyleSheet.cpp \
-		nsInspectorCSSUtils.cpp \
 		nsLayoutStylesheetCache.cpp \
 		nsMediaFeatures.cpp \
 		nsROCSSPrimitiveValue.cpp \
 		nsRuleNode.cpp \
 		nsStyleContext.cpp \
 		nsStyleCoord.cpp \
 		nsStyleSet.cpp \
 		nsStyleStruct.cpp \
diff --git a/layout/style/nsIInspectorCSSUtils.h b/layout/style/nsIInspectorCSSUtils.h
deleted file mode 100644
--- a/layout/style/nsIInspectorCSSUtils.h
+++ /dev/null
@@ -1,72 +0,0 @@
-/* -*- Mode: C++; tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
-// vim:cindent:ts=8:et:sw=4:
-/* ***** BEGIN LICENSE BLOCK *****
- * Version: MPL 1.1/GPL 2.0/LGPL 2.1
- *
- * The contents of this file are subject to the Mozilla Public License Version
- * 1.1 (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- * http://www.mozilla.org/MPL/
- *
- * Software distributed under the License is distributed on an "AS IS" basis,
- * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
- * for the specific language governing rights and limitations under the
- * License.
- *
- * The Original Code is mozilla.org code.
- *
- * The Initial Developer of the Original Code is
- * Netscape Communications Corporation.
- * Portions created by the Initial Developer are Copyright (C) 2002
- * the Initial Developer. All Rights Reserved.
- *
- * Contributor(s):
- *   L. David Baron <dbaron@dbaron.org> (original author)
- *
- * Alternatively, the contents of this file may be used under the terms of
- * either the GNU General Public License Version 2 or later (the "GPL"), or
- * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
- * in which case the provisions of the GPL or the LGPL are applicable instead
- * of those above. If you wish to allow use of your version of this file only
- * under the terms of either the GPL or the LGPL, and not to allow others to
- * use your version of this file under the terms of the MPL, indicate your
- * decision by deleting the provisions above and replace them with the notice
- * and other provisions required by the GPL or the LGPL. If you do not delete
- * the provisions above, a recipient may use your version of this file under
- * the terms of any one of the MPL, the GPL or the LGPL.
- *
- * ***** END LICENSE BLOCK ***** */
-
-/* XPCOM interface to provide some internal information to DOM inspector */
-
-#ifndef nsIInspectorCSSUtils_h___
-#define nsIInspectorCSSUtils_h___
-
-#include "nsISupports.h"
-#include "nsCSSProps.h"
-class nsRuleNode;
-class nsIStyleRule;
-class nsIFrame;
-struct nsRect;
-class nsIContent;
-class nsIDOMElement;
-class nsIArray;
-
-// afb608b5-96ac-440e-a203-52cac9f188e1
-#define NS_IINSPECTORCSSUTILS_IID \
-  { 0xafb608b5, 0x96ac, 0x440e, \
-    { 0xa2, 0x03, 0x52, 0xca, 0xc9, 0xf1, 0x88, 0xe1 } }
-
-// 7ef2f07f-6e34-410b-8336-88acd1cd16b7
-#define NS_INSPECTORCSSUTILS_CID \
-  { 0x7ef2f07f, 0x6e34, 0x410b, \
-    {0x83, 0x36, 0x88, 0xac, 0xd1, 0xcd, 0x16, 0xb7 } }
-
-class nsIInspectorCSSUtils : public nsISupports {
-public:
-    NS_DECLARE_STATIC_IID_ACCESSOR(NS_IINSPECTORCSSUTILS_IID)
-};
-
-NS_DEFINE_STATIC_IID_ACCESSOR(nsIInspectorCSSUtils, NS_IINSPECTORCSSUTILS_IID)
-
-#endif /* nsIInspectorCSSUtils_h___ */
diff --git a/layout/style/nsInspectorCSSUtils.cpp b/layout/style/nsInspectorCSSUtils.cpp
deleted file mode 100644
--- a/layout/style/nsInspectorCSSUtils.cpp
+++ /dev/null
@@ -1,52 +0,0 @@
-/* -*- Mode: C++; tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
-// vim:cindent:ts=8:et:sw=4:
-/* ***** BEGIN LICENSE BLOCK *****
- * Version: MPL 1.1/GPL 2.0/LGPL 2.1
- *
- * The contents of this file are subject to the Mozilla Public License Version
- * 1.1 (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- * http://www.mozilla.org/MPL/
- *
- * Software distributed under the License is distributed on an "AS IS" basis,
- * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
- * for the specific language governing rights and limitations under the
- * License.
- *
- * The Original Code is mozilla.org code.
- *
- * The Initial Developer of the Original Code is
- * Netscape Communications Corporation.
- * Portions created by the Initial Developer are Copyright (C) 2002
- * the Initial Developer. All Rights Reserved.
- *
- * Contributor(s):
- *   L. David Baron <dbaron@dbaron.org> (original author)
- *
- * Alternatively, the contents of this file may be used under the terms of
- * either the GNU General Public License Version 2 or later (the "GPL"), or
- * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
- * in which case the provisions of the GPL or the LGPL are applicable instead
- * of those above. If you wish to allow use of your version of this file only
- * under the terms of either the GPL or the LGPL, and not to allow others to
- * use your version of this file under the terms of the MPL, indicate your
- * decision by deleting the provisions above and replace them with the notice
- * and other provisions required by the GPL or the LGPL. If you do not delete
- * the provisions above, a recipient may use your version of this file under
- * the terms of any one of the MPL, the GPL or the LGPL.
- *
- * ***** END LICENSE BLOCK ***** */
-
-/* XPCOM interface to provide some internal information to DOM inspector */
-
-#include "nsInspectorCSSUtils.h"
-
-nsInspectorCSSUtils::nsInspectorCSSUtils()
-{
-}
-
-nsInspectorCSSUtils::~nsInspectorCSSUtils()
-{
-}
-
-NS_IMPL_ISUPPORTS1(nsInspectorCSSUtils, nsIInspectorCSSUtils)
diff --git a/layout/style/nsInspectorCSSUtils.h b/layout/style/nsInspectorCSSUtils.h
deleted file mode 100644
--- a/layout/style/nsInspectorCSSUtils.h
+++ /dev/null
@@ -1,58 +0,0 @@
-/* -*- Mode: C++; tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
-// vim:cindent:ts=8:et:sw=4:
-/* ***** BEGIN LICENSE BLOCK *****
- * Version: MPL 1.1/GPL 2.0/LGPL 2.1
- *
- * The contents of this file are subject to the Mozilla Public License Version
- * 1.1 (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- * http://www.mozilla.org/MPL/
- *
- * Software distributed under the License is distributed on an "AS IS" basis,
- * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
- * for the specific language governing rights and limitations under the
- * License.
- *
- * The Original Code is mozilla.org code.
- *
- * The Initial Developer of the Original Code is
- * Netscape Communications Corporation.
- * Portions created by the Initial Developer are Copyright (C) 2002
- * the Initial Developer. All Rights Reserved.
- *
- * Contributor(s):
- *   L. David Baron <dbaron@dbaron.org> (original author)
- *
- * Alternatively, the contents of this file may be used under the terms of
- * either the GNU General Public License Version 2 or later (the "GPL"), or
- * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
- * in which case the provisions of the GPL or the LGPL are applicable instead
- * of those above. If you wish to allow use of your version of this file only
- * under the terms of either the GPL or the LGPL, and not to allow others to
- * use your version of this file under the terms of the MPL, indicate your
- * decision by deleting the provisions above and replace them with the notice
- * and other provisions required by the GPL or the LGPL. If you do not delete
- * the provisions above, a recipient may use your version of this file under
- * the terms of any one of the MPL, the GPL or the LGPL.
- *
- * ***** END LICENSE BLOCK ***** */
-
-/* XPCOM interface to provide some internal information to DOM inspector */
-
-#ifndef nsInspectorCSSUtils_h___
-#define nsInspectorCSSUtils_h___
-
-#include "nsIInspectorCSSUtils.h"
-
-class nsInspectorCSSUtils : public nsIInspectorCSSUtils {
-
-public:
-
-    nsInspectorCSSUtils();
-    virtual ~nsInspectorCSSUtils();
-
-    NS_DECL_ISUPPORTS
-
-};
-
-#endif /* nsInspectorCSSUtils_h___ */
