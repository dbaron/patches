From: L. David Baron <dbaron@dbaron.org>

Bug 996796 patch 15 - Add comment about how ResolveStyleWithReplacement interacts with nsTransitionManager and nsAnimationManager.

diff --git a/layout/style/nsStyleSet.cpp b/layout/style/nsStyleSet.cpp
--- a/layout/style/nsStyleSet.cpp
+++ b/layout/style/nsStyleSet.cpp
@@ -1353,29 +1353,33 @@ nsStyleSet::RuleNodeWithReplacement(Elem
        level != levelEnd; ++level) {
     ruleWalker.SetLevel(level->mLevel, level->mIsImportant, false);
 
     bool doReplace = level->mLevelReplacementHint & aReplacements;
     if (doReplace) {
       switch (level->mLevelReplacementHint) {
       case eRestyle_CSSAnimations:
         {
+          // FIXME: This should probably be more similar to what
+          // FileRules does.
           nsAnimationManager* animationManager =
             PresContext()->AnimationManager();
           ElementAnimations* ea = animationManager->GetElementAnimations(
             aElement, aPseudoType, false);
           NS_ASSERTION(ea,
             "Rule has level eAnimationSheet without animation on manager");
 
           animationManager->EnsureStyleRuleFor(ea);
           ruleWalker.ForwardOnPossiblyCSSRule(ea->mStyleRule);
         }
         break;
       case eRestyle_CSSTransitions:
         {
+          // FIXME: This should probably be more similar to what
+          // FileRules does.
           nsPresContext* presContext = PresContext();
           ElementTransitions *et =
             presContext->TransitionManager()->GetElementTransitions(
               aElement, aPseudoType, false);
           NS_ASSERTION(et,
             "Rule has level eTransitionSheet without transition on manager");
 
           et->EnsureStyleRuleFor(presContext->RefreshDriver()->MostRecentRefresh());
