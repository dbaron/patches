Try to assert when Unlink doesn't do what it should (needs better warning text).

diff --git a/xpcom/base/nsCycleCollector.cpp b/xpcom/base/nsCycleCollector.cpp
--- a/xpcom/base/nsCycleCollector.cpp
+++ b/xpcom/base/nsCycleCollector.cpp
@@ -1596,6 +1596,18 @@ nsCycleCollector::UnrootWhite()
         if (NS_FAILED(rv))
             Fault("Failed unroot call while unlinking", pinfo);
     }
+
+#ifdef DEBUG_CC
+    for (i = 0; i < count; ++i) {
+        PtrInfo *pinfo = static_cast<PtrInfo*>(mBuf.ObjectAt(i));
+        if (pinfo->mLangID == nsIProgrammingLanguage::CPLUSPLUS) {
+            NS_ASSERTION(!mPurpleBuf.Exists(pinfo->mPointer),
+                         nsPrintfCString(256,
+                             "Unlink failed to destroy %s object @%p",
+                             pinfo->mName, pinfo->mPointer).get());
+        }
+    }
+#endif
 
     mBuf.Empty();
 
@@ -2652,7 +2664,8 @@ nsCycleCollector::CreateReversedEdges()
             ++current;
         }
     }
-    NS_ASSERTION(current - mGraph.mReversedEdges == edgeCount, "misallocation");
+    NS_ASSERTION(current - mGraph.mReversedEdges == ptrdiff_t(edgeCount),
+                 "misallocation");
     return PR_TRUE;
 }
 
