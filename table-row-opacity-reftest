From: L. David Baron <dbaron@dbaron.org>

Bug 1224251 patch 1 - Add reftest.

diff --git a/layout/reftests/table-background/reftest.list b/layout/reftests/table-background/reftest.list
--- a/layout/reftests/table-background/reftest.list
+++ b/layout/reftests/table-background/reftest.list
@@ -53,8 +53,9 @@ fails == border-separate-opacity-table-c
 skip-if(B2G||Mulet) == border-separate-opacity-table-row.html border-separate-opacity-table-row-ref.html # bug 773482 # Initial mulet triage: parity with B2G/B2G Desktop
 skip-if(B2G||Mulet) == border-separate-opacity-table.html border-separate-opacity-table-ref.html # bug 773482 # Initial mulet triage: parity with B2G/B2G Desktop
 != scrollable-rowgroup-collapse-background.html scrollable-rowgroup-collapse-notref.html 
 != scrollable-rowgroup-collapse-border.html scrollable-rowgroup-collapse-notref.html     
 != scrollable-rowgroup-separate-background.html scrollable-rowgroup-separate-notref.html
 == scrollable-rowgroup-separate-border.html scrollable-rowgroup-separate-notref.html # scrolling rowgroups were removed in bug 28800
 == empty-cells-default-1.html empty-cells-default-1-ref.html
 == empty-cells-default-2.html empty-cells-default-2-ref.html
+== table-row-opacity-dynamic-1.html table-row-opacity-dynamic-1-ref.html
diff --git a/layout/reftests/table-background/table-row-opacity-dynamic-1-ref.html b/layout/reftests/table-background/table-row-opacity-dynamic-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/table-background/table-row-opacity-dynamic-1-ref.html
@@ -0,0 +1,29 @@
+<!DOCTYPE HTML>
+<html>
+<title>Test for bug 1224251</title>
+<style>
+
+body { background: white; color: black }
+
+table {
+  padding: 0;
+  border-spacing: 0;
+  border: none;
+  width: 15em;
+}
+
+tr {
+  background: blue;
+}
+
+td {
+  border: none;
+}
+
+</style>
+
+
+<table>
+  <tr style="opacity: 1.0"><td>row 1</td></tr>
+  <tr style="opacity: 0.8"><td>row 2</td></tr>
+</table>
diff --git a/layout/reftests/table-background/table-row-opacity-dynamic-1.html b/layout/reftests/table-background/table-row-opacity-dynamic-1.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/table-background/table-row-opacity-dynamic-1.html
@@ -0,0 +1,43 @@
+<!DOCTYPE HTML>
+<html class="reftest-wait">
+<title>Test for bug 1224251</title>
+<style>
+
+body { background: white; color: black }
+
+table {
+  padding: 0;
+  border-spacing: 0;
+  border: none;
+  width: 15em;
+}
+
+tr {
+  background: blue;
+}
+
+td {
+  border: none;
+}
+
+</style>
+
+
+<table>
+  <tr style="opacity: 0.8"><td>row 1</td></tr>
+  <tr style="opacity: 1.0"><td>row 2</td></tr>
+</table>
+
+<script>
+
+document.addEventListener("MozReftestInvalidate", swapOpacity, false);
+
+function swapOpacity(event) {
+  var trs = document.getElementsByTagName("tr");
+  trs[0].style.opacity = "1.0";
+  trs[1].style.opacity = "0.8";
+
+  document.documentElement.classList.remove("reftest-wait");
+}
+
+</script>
