From: L. David Baron <dbaron@dbaron.org>

Bug 1405875 - Remove unneeded QueryInterface to nsIContentViewerFile.

MozReview-Commit-ID: EgsgrXfTmx1

diff --git a/layout/printing/nsPrintEngine.cpp b/layout/printing/nsPrintEngine.cpp
--- a/layout/printing/nsPrintEngine.cpp
+++ b/layout/printing/nsPrintEngine.cpp
@@ -90,17 +90,16 @@ static const char kPrintingPromptService
 #include "nsIDeviceContextSpec.h"
 #include "nsDeviceContextSpecProxy.h"
 #include "nsViewManager.h"
 #include "nsView.h"
 
 #include "nsIPageSequenceFrame.h"
 #include "nsIURL.h"
 #include "nsIContentViewerEdit.h"
-#include "nsIContentViewerFile.h"
 #include "nsIInterfaceRequestor.h"
 #include "nsIInterfaceRequestorUtils.h"
 #include "nsIDocShellTreeOwner.h"
 #include "nsIWebBrowserChrome.h"
 #include "nsIBaseWindow.h"
 #include "nsILayoutHistoryState.h"
 #include "nsFrameManager.h"
 #include "mozilla/ReflowInput.h"
@@ -1196,28 +1195,25 @@ nsPrintEngine::BuildDocTree(nsIDocShell 
     for (int32_t i=0;i<childWebshellCount;i++) {
       nsCOMPtr<nsIDocShellTreeItem> child;
       aParentNode->GetChildAt(i, getter_AddRefs(child));
       nsCOMPtr<nsIDocShell> childAsShell(do_QueryInterface(child));
 
       nsCOMPtr<nsIContentViewer>  viewer;
       childAsShell->GetContentViewer(getter_AddRefs(viewer));
       if (viewer) {
-        nsCOMPtr<nsIContentViewerFile> viewerFile(do_QueryInterface(viewer));
-        if (viewerFile) {
-          nsCOMPtr<nsIDOMDocument> doc = do_GetInterface(childAsShell);
-          auto po = MakeUnique<nsPrintObject>();
-          po->mParent = aPO.get();
-          nsresult rv = po->Init(childAsShell, doc, aPO->mPrintPreview);
-          if (NS_FAILED(rv))
-            NS_NOTREACHED("Init failed?");
-          aPO->mKids.AppendElement(Move(po));
-          aDocList->AppendElement(aPO->mKids.LastElement().get());
-          BuildDocTree(childAsShell, aDocList, aPO->mKids.LastElement());
-        }
+        nsCOMPtr<nsIDOMDocument> doc = do_GetInterface(childAsShell);
+        auto po = MakeUnique<nsPrintObject>();
+        po->mParent = aPO.get();
+        nsresult rv = po->Init(childAsShell, doc, aPO->mPrintPreview);
+        if (NS_FAILED(rv))
+          NS_NOTREACHED("Init failed?");
+        aPO->mKids.AppendElement(Move(po));
+        aDocList->AppendElement(aPO->mKids.LastElement().get());
+        BuildDocTree(childAsShell, aDocList, aPO->mKids.LastElement());
       }
     }
   }
 }
 
 //---------------------------------------------------------------------
 void
 nsPrintEngine::GetDocumentTitleAndURL(nsIDocument* aDoc,
