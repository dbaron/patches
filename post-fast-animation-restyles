From: L. David Baron <dbaron@dbaron.org>

Bug 960465 patch N - Use new no-selector-matching hints for animation restyles.

diff --git a/layout/style/nsAnimationManager.h b/layout/style/nsAnimationManager.h
--- a/layout/style/nsAnimationManager.h
+++ b/layout/style/nsAnimationManager.h
@@ -78,17 +78,17 @@ struct ElementAnimations MOZ_FINAL
                NS_LITERAL_STRING("::before") :
                NS_LITERAL_STRING("::after");
   }
 
   mozilla::dom::Element* ElementToRestyle() const;
 
   void PostRestyleForAnimation(nsPresContext *aPresContext) {
     aPresContext->PresShell()->RestyleForAnimation(ElementToRestyle(),
-                                                   eRestyle_Self);
+                                                   eRestyle_CSSAnimations);
   }
 
   // If aFlags contains CanAnimate_AllowPartial, returns whether the
   // state of this element's animations at the current refresh driver
   // time contains animation data that can be done on the compositor
   // thread.  (This is useful for determining whether a layer should be
   // active, or whether to send data to the layer.)
   // If aFlags does not contain CanAnimate_AllowPartial, returns whether
diff --git a/layout/style/nsTransitionManager.h b/layout/style/nsTransitionManager.h
--- a/layout/style/nsTransitionManager.h
+++ b/layout/style/nsTransitionManager.h
@@ -78,17 +78,17 @@ struct ElementTransitions MOZ_FINAL
   void EnsureStyleRuleFor(mozilla::TimeStamp aRefreshTime);
 
   virtual bool HasAnimationOfProperty(nsCSSProperty aProperty) const MOZ_OVERRIDE;
 
   mozilla::dom::Element* ElementToRestyle() const;
 
   void PostRestyleForAnimation(nsPresContext *aPresContext) {
     aPresContext->PresShell()->RestyleForAnimation(ElementToRestyle(),
-                                                   eRestyle_Self);
+                                                   eRestyle_CSSTransitions);
   }
 
   // If aFlags contains CanAnimate_AllowPartial, returns whether the
   // state of this element's transitions at the current refresh driver
   // time contains transition data that can be done on the compositor
   // thread.  (This is useful for determining whether a layer should be
   // active, or whether to send data to the layer.)
   // If aFlags does not contain CanAnimate_AllowPartial, returns whether
