From: L. David Baron <dbaron@dbaron.org>

Give nsCSSStyleSheet an IID to support QueryInterface.

diff --git a/layout/style/nsCSSStyleSheet.h b/layout/style/nsCSSStyleSheet.h
--- a/layout/style/nsCSSStyleSheet.h
+++ b/layout/style/nsCSSStyleSheet.h
@@ -105,21 +105,30 @@ private:
 
 // -------------------------------
 // CSS Style Sheet
 //
 
 class CSSRuleListImpl;
 struct ChildSheetListBuilder;
 
+// For compatibility with nsICSSStyleSheet, make the nsCSSStyleSheet
+// concrete class support QueryInterface.
+// 85baabe5-2a0a-4321-8f88-72022c9cd582
+#define NS_CSS_STYLE_SHEET_IID \
+{ 0x85baabe5, 0x2a0a, 0x4321, \
+  { 0x8f, 0x88, 0x72, 0x02, 0x2c, 0x9c, 0xd5, 0x82 } }
+
 class nsCSSStyleSheet : public nsICSSStyleSheet, 
                         public nsIDOMCSSStyleSheet,
                         public nsICSSLoaderObserver
 {
 public:
+  NS_DECLARE_STATIC_IID_ACCESSOR(NS_CSS_STYLE_SHEET_IID)
+
   nsCSSStyleSheet();
 
   NS_DECL_ISUPPORTS
 
   // nsIStyleSheet interface
   NS_IMETHOD GetSheetURI(nsIURI** aSheetURI) const;
   NS_IMETHOD GetBaseURI(nsIURI** aBaseURI) const;
   NS_IMETHOD GetTitle(nsString& aTitle) const;
@@ -236,9 +245,11 @@ protected:
   nsAutoTArray<nsCSSRuleProcessor*, 8>* mRuleProcessors;
 
   friend class nsMediaList;
   friend class nsCSSRuleProcessor;
   friend nsresult NS_NewCSSStyleSheet(nsICSSStyleSheet** aInstancePtrResult);
   friend struct ChildSheetListBuilder;
 };
 
+NS_DEFINE_STATIC_IID_ACCESSOR(nsCSSStyleSheet, NS_CSS_STYLE_SHEET_IID)
+
 #endif /* !defined(nsCSSStyleSheet_h_) */
