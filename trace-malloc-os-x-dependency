Fix the way we build frameworks so it doesn't break dependencies of the form -ltracemalloc.  b=392118

diff --git a/config/rules.mk b/config/rules.mk
--- a/config/rules.mk
+++ b/config/rules.mk
@@ -149,7 +149,11 @@ MKSHLIB			= $(MKCSHLIB)
 MKSHLIB			= $(MKCSHLIB)
 endif
 
+ifdef MAKE_FRAMEWORK
+SHARED_LIBRARY		:= $(LIBRARY_NAME)
+else
 SHARED_LIBRARY		:= $(DLL_PREFIX)$(LIBRARY_NAME)$(DLL_SUFFIX)
+endif
 
 ifeq ($(OS_ARCH),OS2)
 DEF_FILE		:= $(SHARED_LIBRARY:.dll=.def)
diff --git a/toolkit/library/Makefile.in b/toolkit/library/Makefile.in
--- a/toolkit/library/Makefile.in
+++ b/toolkit/library/Makefile.in
@@ -57,8 +57,10 @@ ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_
 # This is going to be a framework named "XUL", not an ordinary library named
 # "libxul.dylib"
 LIBRARY_NAME=XUL
-DLL_PREFIX=
-DLL_SUFFIX=
+# Setting MAKE_FRAMEWORK makes DLL_PREFIX and DLL_SUFFIX be ignored when
+# setting SHARED_LIBRARY; we need to leave DLL_PREFIX and DLL_SUFFIX
+# as-is so that dependencies of the form -ltracemalloc still work.
+MAKE_FRAMEWORK=1
 endif
 
 REQUIRES = \
