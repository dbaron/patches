From: L. David Baron <dbaron@dbaron.org>

Don't call SetSheet with a null sheet.  (Bug 645951)

diff --git a/layout/style/nsCSSRules.cpp b/layout/style/nsCSSRules.cpp
--- a/layout/style/nsCSSRules.cpp
+++ b/layout/style/nsCSSRules.cpp
@@ -364,22 +364,23 @@ ImportRule::ImportRule(nsMediaList* aMed
   // with itself if we manage to load a sheet.  Which should really
   // never fail nowadays, in sane cases.
 }
 
 ImportRule::ImportRule(const ImportRule& aCopy)
   : nsCSSRule(aCopy),
     mURLSpec(aCopy.mURLSpec)
 {
-  nsRefPtr<nsCSSStyleSheet> sheet;
   if (aCopy.mChildSheet) {
+    nsRefPtr<nsCSSStyleSheet> sheet;
     sheet = aCopy.mChildSheet->Clone(nsnull, this, nsnull, nsnull);
+    SetSheet(sheet);
+    // SetSheet sets mMedia appropriately
   }
-  SetSheet(sheet);
-  // SetSheet sets mMedia appropriately
+  // XXXldb What if aCopy.mChildSheet hasn't loaded yet?
 }
 
 ImportRule::~ImportRule()
 {
   if (mChildSheet) {
     mChildSheet->SetOwnerRule(nsnull);
   }
 }
