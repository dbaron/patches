From: L. David Baron <dbaron@dbaron.org>

Add ElementRestyler class to begin refactoring ReResolveStyleContext.

diff --git a/layout/base/RestyleManager.h b/layout/base/RestyleManager.h
--- a/layout/base/RestyleManager.h
+++ b/layout/base/RestyleManager.h
@@ -21,17 +21,17 @@ class nsIFrame;
 struct TreeMatchContext;
 
 namespace mozilla {
 
 namespace dom {
   class Element;
 } // namespace dom
 
-class RestyleManager {
+class RestyleManager MOZ_FINAL {
 public:
   friend class ::nsRefreshDriver;
   friend class RestyleTracker;
 
   typedef mozilla::dom::Element Element;
 
   RestyleManager(nsPresContext* aPresContext);
 
@@ -292,11 +292,28 @@ private:
   // The total number of animation flushes by this frame constructor.
   // Used to keep the layer and animation manager in sync.
   uint64_t mAnimationGeneration;
 
   RestyleTracker mPendingRestyles;
   RestyleTracker mPendingAnimationRestyles;
 };
 
+/**
+ * An ElementRestyler is created for *each* element in a subtree that we
+ * recompute styles for.
+ */
+class ElementRestyler MOZ_FINAL {
+public:
+  // Construct for the root of the subtree that we're restyling.
+  ElementRestyler(nsIFrame* aFrame, dom::Element* aParentElement,
+                  TreeMatchContext& aTreeMatchContext,
+                  nsRestyleHint aRestyleHint, nsChangeHint aMinChange,
+                  RestyleTracker& aRestyleTracker,
+                  nsStyleChangeList* aChangeList);
+
+  // Construct for an element whose parent is being restyled.
+  ElementRestyler(const ElementRestyler& aParentRestyler, nsIFrame* aFrame);
+};
+
 } // namespace mozilla
 
 #endif /* mozilla_RestyleManager_h */
