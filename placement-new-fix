From: L. David Baron <dbaron@dbaron.org>

Fix Windows optimized bustage from bug 636039 patch 15:  use placement new in a loop instead of using placement new[].

diff --git a/layout/style/nsRuleNode.cpp b/layout/style/nsRuleNode.cpp
--- a/layout/style/nsRuleNode.cpp
+++ b/layout/style/nsRuleNode.cpp
@@ -1711,18 +1711,23 @@ UnsetPropertiesWithoutFlags(const nsStyl
  */
 struct AutoCSSValueArray {
   /**
    * aStorage must be the result of alloca(aCount * sizeof(nsCSSValue))
    */
   AutoCSSValueArray(void* aStorage, size_t aCount) {
     NS_ABORT_IF_FALSE(size_t(aStorage) % NS_ALIGNMENT_OF(nsCSSValue) == 0,
                       "bad alignment from alloca");
-    mArray = new (aStorage) nsCSSValue[aCount];
     mCount = aCount;
+    // Don't use placement new[], since it might store extra data
+    // for the count (on Windows!).
+    mArray = static_cast<nsCSSValue*>(aStorage);
+    for (size_t i = 0; i < mCount; ++i) {
+      new (mArray + i) nsCSSValue();
+    }
   }
 
   ~AutoCSSValueArray() {
     for (size_t i = 0; i < mCount; ++i) {
       mArray[i].~nsCSSValue();
     }
   }
 
