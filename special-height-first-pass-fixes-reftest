Reftest for bug 381507.  Patch by Daniel Holbert <dholbert@mozilla.com>.  r=dbaron

diff --git a/layout/reftests/bugs/381507-1-ref.html b/layout/reftests/bugs/381507-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/381507-1-ref.html
@@ -0,0 +1,8 @@
+<html>
+ <body>
+  <iframe id="myFrame" 
+          style="height: 200px"
+          src="381507-iframe.html"/>
+ </body>
+</html>
+
diff --git a/layout/reftests/bugs/381507-1.html b/layout/reftests/bugs/381507-1.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/381507-1.html
@@ -0,0 +1,18 @@
+<html class="reftest-wait">
+ <body onload="HandleLoad()">
+  <script>
+    function HandleLoad() {
+      setTimeout(function() {
+	var myFrame = document.getElementById("myFrame");
+	myFrame.style.height = "200px";
+        document.documentElement.className = "";
+      }, 0);
+    }
+  </script>
+
+  <iframe id="myFrame" 
+          style="height: 300px"
+          src="381507-iframe.html"/>
+ </body>
+</html>
+
diff --git a/layout/reftests/bugs/381507-iframe.html b/layout/reftests/bugs/381507-iframe.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/381507-iframe.html
@@ -0,0 +1,16 @@
+<html>
+<body>
+<table height="30%"    bgcolor="green"
+       cellspacing="0" cellpadding="0">
+ <tr><td>
+ +
+  <table height="100%"   bgcolor="orange"
+         cellspacing="0" cellpadding="0">
+   <tr><td>
+   +
+   </td></tr>
+  </table>
+ </td></tr>
+</table>
+</body>
+</html>
diff --git a/layout/reftests/bugs/reftest.list b/layout/reftests/bugs/reftest.list
--- a/layout/reftests/bugs/reftest.list
+++ b/layout/reftests/bugs/reftest.list
@@ -245,3 +245,4 @@ random-if(MOZ_WIDGET_TOOLKIT=="cocoa") =
 == 380227-1.html 380227-1-ref.html
 == 380842-1.html 380842-1-ref.html
 == 381130-1.html 381130-1-ref.html
+== 381507-1.html 381507-1-ref.html
