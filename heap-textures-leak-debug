From: L. David Baron <dbaron@dbaron.org>

Bug 945632:  Add debugging for gfx/heap-textures leak.

diff --git a/gfx/layers/ipc/ISurfaceAllocator.h b/gfx/layers/ipc/ISurfaceAllocator.h
--- a/gfx/layers/ipc/ISurfaceAllocator.h
+++ b/gfx/layers/ipc/ISurfaceAllocator.h
@@ -162,21 +162,23 @@ public:
   }
 
   MOZ_DEFINE_MALLOC_SIZE_OF_ON_ALLOC(MallocSizeOfOnAlloc)
   MOZ_DEFINE_MALLOC_SIZE_OF_ON_FREE(MallocSizeOfOnFree)
 
   static void DidAlloc(void* aPointer)
   {
     sAmount += MallocSizeOfOnAlloc(aPointer);
+    printf("DidAlloc: allocating %p, size now %lld\n", aPointer, ptrdiff_t(sAmount));
   }
 
   static void WillFree(void* aPointer)
   {
     sAmount -= MallocSizeOfOnFree(aPointer);
+    printf("WillFree: freeing %p, size now %lld\n", aPointer, ptrdiff_t(sAmount));
   }
 
   NS_IMETHOD CollectReports(nsIHandleReportCallback* aHandleReport,
                             nsISupports* aData)
   {
     return MOZ_COLLECT_REPORT(
       "explicit/gfx/heap-textures", KIND_HEAP, UNITS_BYTES, sAmount,
       "Heap memory shared between threads by texture clients and hosts.");
