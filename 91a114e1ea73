
# HG changeset patch
# User Kartikaya Gupta <kgupta@mozilla.com>
# Date 1433789207 14400
# Node ID 91a114e1ea73ac61b55f55320f73f8f5cda3fd21
# Parent  f39ed56f29a421fe1825f14bd89ac6781f02310d
Bug 1172224 - Ensure that docshells return an appropriate value for APZ-enabled even if they don't have a presShell. r=dvander

diff --git a/docshell/base/nsDocShell.cpp b/docshell/base/nsDocShell.cpp
--- a/docshell/base/nsDocShell.cpp
+++ b/docshell/base/nsDocShell.cpp
@@ -13870,17 +13870,19 @@ nsDocShell::GetAppManifestURL(nsAString&
 NS_IMETHODIMP
 nsDocShell::GetAsyncPanZoomEnabled(bool* aOut)
 {
   if (nsIPresShell* presShell = GetPresShell()) {
     *aOut = presShell->AsyncPanZoomEnabled();
     return NS_OK;
   }
 
-  *aOut = false;
+  // If we don't have a presShell, fall back to the default platform value of
+  // whether or not APZ is enabled.
+  *aOut = gfxPlatform::AsyncPanZoomEnabled();
   return NS_OK;
 }
 
 bool
 nsDocShell::HasUnloadedParent()
 {
   nsRefPtr<nsDocShell> parent = GetParentDocshell();
   while (parent) {
