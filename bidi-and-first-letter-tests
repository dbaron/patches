Tests for bidi and first letter.

diff --git a/layout/reftests/bidi/reftest.list b/layout/reftests/bidi/reftest.list
--- a/layout/reftests/bidi/reftest.list
+++ b/layout/reftests/bidi/reftest.list
@@ -12,16 +12,20 @@ fails-if(MOZ_WIDGET_TOOLKIT!="windows") 
 == mixedChartype-00.html mixedChartype-00-ref.html
 == mixedChartype-00-j.html mixedChartype-00-ref.html
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") == mixedChartype-01.html mixedChartype-01-ref.html
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") == mixedChartype-01-j.html mixedChartype-01-ref.html
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") == mixedChartype-02.html mixedChartype-02-ref.html
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") == mixedChartype-02-j.html mixedChartype-02-ref.html
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") == mixedChartype-03.html mixedChartype-03-ref.html
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") == mixedChartype-03-j.html mixedChartype-03-ref.html
+== with-first-letter-1a.html with-first-letter-1-ref.html
+== with-first-letter-1b.html with-first-letter-1-ref.html
+== with-first-letter-2a.html with-first-letter-2-ref.html
+== with-first-letter-2b.html with-first-letter-2-ref.html
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") == 386339.html 386339-ref.html
 == 409375.html 409375-ref.html
 == 413542-1.html 413542-1-ref.html
 == 413542-2.html 413542-2-ref.html
 == 413928-1.html 413928-1-ref.html
 == 413928-2.html 413928-2-ref.html
 == 425338-1a.html 425338-1-ref.html
 == 425338-1b.html 425338-1-ref.html
diff --git a/layout/reftests/bidi/with-first-letter-1-ref.html b/layout/reftests/bidi/with-first-letter-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bidi/with-first-letter-1-ref.html
@@ -0,0 +1,18 @@
+<!DOCTYPE HTML>
+<html>
+<head>
+<title>Test for bidi splitting and :first-letter</title>
+<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
+<meta http-equiv="Content-Style-Type" content="text/css">
+<style type="text/css">
+
+p { unicode-bidi: bidi-override; }
+
+</style>
+</head>
+<body>
+
+<p><span style="background: aqua">T</span>his has AB<span style="background:yellow">CD</span>דג<span style="background:yellow">בא</span></p>
+
+</body>
+</html>
diff --git a/layout/reftests/bidi/with-first-letter-1a.html b/layout/reftests/bidi/with-first-letter-1a.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bidi/with-first-letter-1a.html
@@ -0,0 +1,18 @@
+<!DOCTYPE HTML>
+<html>
+<head>
+<title>Test for bidi splitting and :first-letter</title>
+<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
+<meta http-equiv="Content-Style-Type" content="text/css">
+<style type="text/css">
+
+p:first-letter { background: aqua; }
+
+</style>
+</head>
+<body>
+
+<p>This has AB<span style="background:yellow">CDאב</span>גד</p>
+
+</body>
+</html>
diff --git a/layout/reftests/bidi/with-first-letter-1b.html b/layout/reftests/bidi/with-first-letter-1b.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bidi/with-first-letter-1b.html
@@ -0,0 +1,18 @@
+<!DOCTYPE HTML>
+<html>
+<head>
+<title>Test for bidi splitting and :first-letter</title>
+<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
+<meta http-equiv="Content-Style-Type" content="text/css">
+<style type="text/css">
+
+p:first-letter { background: aqua; }
+
+</style>
+</head>
+<body>
+
+<p><span><span>This has AB<span style="background:yellow">CDאב</span>גד</span></span></p>
+
+</body>
+</html>
diff --git a/layout/reftests/bidi/with-first-letter-2-ref.html b/layout/reftests/bidi/with-first-letter-2-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bidi/with-first-letter-2-ref.html
@@ -0,0 +1,19 @@
+<!DOCTYPE HTML>
+<html>
+<head>
+<title>Test for bidi splitting and :first-letter</title>
+<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
+<meta http-equiv="Content-Style-Type" content="text/css">
+<style type="text/css">
+
+p { unicode-bidi: bidi-override; }
+p:first-letter { float:left; font-size: 2em; }
+
+</style>
+</head>
+<body>
+
+<p>This has AB<span style="background:yellow">CD</span>דג<span style="background:yellow">בא</span></p>
+
+</body>
+</html>
diff --git a/layout/reftests/bidi/with-first-letter-2a.html b/layout/reftests/bidi/with-first-letter-2a.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bidi/with-first-letter-2a.html
@@ -0,0 +1,18 @@
+<!DOCTYPE HTML>
+<html>
+<head>
+<title>Test for bidi splitting and :first-letter</title>
+<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
+<meta http-equiv="Content-Style-Type" content="text/css">
+<style type="text/css">
+
+p:first-letter { float:left; font-size: 2em; }
+
+</style>
+</head>
+<body>
+
+<p>This has AB<span style="background:yellow">CDאב</span>גד</p>
+
+</body>
+</html>
diff --git a/layout/reftests/bidi/with-first-letter-2b.html b/layout/reftests/bidi/with-first-letter-2b.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bidi/with-first-letter-2b.html
@@ -0,0 +1,18 @@
+<!DOCTYPE HTML>
+<html>
+<head>
+<title>Test for bidi splitting and :first-letter</title>
+<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
+<meta http-equiv="Content-Style-Type" content="text/css">
+<style type="text/css">
+
+p:first-letter { float:left; font-size: 2em; }
+
+</style>
+</head>
+<body>
+
+<p><span><span>This has AB<span style="background:yellow">CDאב</span>גד</span></span></p>
+
+</body>
+</html>
