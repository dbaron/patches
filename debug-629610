From: L. David Baron <dbaron@dbaron.org>

Better debugging patch for bug 629610.

diff --git a/js/src/xpconnect/src/xpcwrappednative.cpp b/js/src/xpconnect/src/xpcwrappednative.cpp
--- a/js/src/xpconnect/src/xpcwrappednative.cpp
+++ b/js/src/xpconnect/src/xpcwrappednative.cpp
@@ -960,17 +960,20 @@ XPCWrappedNative::~XPCWrappedNative()
             {
                 NS_WARNING("Failed to append object for deferred release.");
                 // XXX do we really want to do this???
                 NS_RELEASE(mIdentity);
             }
         }
         else
         {
+            printf("Releasing identity directly: rt=%p scope=%p proto=%p.\n", 
+                   rt, GetScope(), GetProto());
             NS_RELEASE(mIdentity);
+            printf("Done releasing identity directly.\n");
         }
     }
 }
 
 // This is factored out so that it can be called publicly 
 // static
 void 
 XPCWrappedNative::GatherProtoScriptableCreateInfo(
