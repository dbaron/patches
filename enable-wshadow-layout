From: L. David Baron <dbaron@dbaron.org>

Bug 563195:  Turn on -Wshadow for the rest of layout/.

diff --git a/layout/base/Makefile.in b/layout/base/Makefile.in
--- a/layout/base/Makefile.in
+++ b/layout/base/Makefile.in
@@ -9,17 +9,20 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gkbase_s
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
-
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
 
 CPPSRCS		= \
 		DisplayItemClip.cpp \
 		DisplayListClipState.cpp \
 		FrameLayerBuilder.cpp \
 		FramePropertyTable.cpp \
 		MaskLayerImageCache.cpp \
 		nsCSSColorUtils.cpp \
diff --git a/layout/build/Makefile.in b/layout/build/Makefile.in
--- a/layout/build/Makefile.in
+++ b/layout/build/Makefile.in
@@ -17,16 +17,20 @@ endif
 
 LIBRARY_NAME	= gklayout
 EXPORT_LIBRARY = 1
 IS_COMPONENT	= 1
 MODULE_NAME	= nsLayoutModule
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
 
 CPPSRCS		= \
 		nsLayoutModule.cpp \
 		nsContentDLF.cpp \
 		nsLayoutStatics.cpp \
 		$(NULL)
 
 SHARED_LIBRARY_LIBS = \
diff --git a/layout/forms/Makefile.in b/layout/forms/Makefile.in
--- a/layout/forms/Makefile.in
+++ b/layout/forms/Makefile.in
@@ -9,16 +9,21 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gkforms_s
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
+
 CPPSRCS		= \
 		nsButtonFrameRenderer.cpp \
 		nsComboboxControlFrame.cpp \
 		nsFieldSetFrame.cpp \
 		nsFileControlFrame.cpp \
 		nsFormControlFrame.cpp \
 		nsGfxButtonControlFrame.cpp \
 		nsGfxCheckboxControlFrame.cpp \
diff --git a/layout/generic/Makefile.in b/layout/generic/Makefile.in
--- a/layout/generic/Makefile.in
+++ b/layout/generic/Makefile.in
@@ -10,16 +10,21 @@ VPATH		= @srcdir@
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gkgeneric_s
 LIBXUL_LIBRARY	= 1
 ifndef _MSC_VER
 FAIL_ON_WARNINGS = 1
 endif # !_MSC_VER
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
+
 CPPSRCS		= \
 		FrameChildList.cpp \
 		nsAbsoluteContainingBlock.cpp \
 		nsBRFrame.cpp \
 		nsBlockFrame.cpp \
 		nsBlockReflowContext.cpp \
 		nsBlockReflowState.cpp \
 		nsBulletFrame.cpp \
diff --git a/layout/inspector/src/Makefile.in b/layout/inspector/src/Makefile.in
--- a/layout/inspector/src/Makefile.in
+++ b/layout/inspector/src/Makefile.in
@@ -9,16 +9,21 @@ srcdir=@srcdir@
 VPATH=@srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME = inspector_s
 LIBXUL_LIBRARY = 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
+
 CPPSRCS= \
   inDeepTreeWalker.cpp \
   inFlasher.cpp \
   inSearchLoop.cpp \
   inCSSValueSearch.cpp \
   inDOMUtils.cpp \
   inLayoutUtils.cpp \
   nsFontFace.cpp \
diff --git a/layout/ipc/Makefile.in b/layout/ipc/Makefile.in
--- a/layout/ipc/Makefile.in
+++ b/layout/ipc/Makefile.in
@@ -10,16 +10,21 @@ VPATH = @srcdir@
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME = gkipc_s
 LIBXUL_LIBRARY = 1
 FORCE_STATIC_LIB = 1
 EXPORT_LIBRARY = 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
+
 CPPSRCS = \
   RenderFrameChild.cpp \
   RenderFrameParent.cpp \
   $(NULL)
 
 include $(topsrcdir)/config/config.mk
 include $(topsrcdir)/ipc/chromium/chromium-config.mk
 include $(topsrcdir)/config/rules.mk
diff --git a/layout/mathml/Makefile.in b/layout/mathml/Makefile.in
--- a/layout/mathml/Makefile.in
+++ b/layout/mathml/Makefile.in
@@ -10,16 +10,20 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME = gkmathml_s
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
 
 LOCAL_INCLUDES = \
 	-I$(srcdir)/../style \
 	-I$(srcdir)/../base \
 	-I$(srcdir)/../generic \
 	-I$(srcdir)/../tables \
 	-I$(topsrcdir)/content/base/src \
 	-I$(topsrcdir)/content/mathml/content/src \
diff --git a/layout/printing/Makefile.in b/layout/printing/Makefile.in
--- a/layout/printing/Makefile.in
+++ b/layout/printing/Makefile.in
@@ -8,16 +8,21 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gkprinting_s
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
+
 CPPSRCS		= \
 		nsPrintEngine.cpp \
 		nsPrintData.cpp \
 		nsPrintObject.cpp \
 		nsPagePrintTimer.cpp \
 		nsPrintPreviewListener.cpp \
 		$(NULL)
 
diff --git a/layout/svg/Makefile.in b/layout/svg/Makefile.in
--- a/layout/svg/Makefile.in
+++ b/layout/svg/Makefile.in
@@ -9,16 +9,20 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gksvgbase_s
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
 
 CPPSRCS		= \
 		nsSVGAFrame.cpp \
 		nsSVGClipPathFrame.cpp \
 		nsSVGContainerFrame.cpp \
 		nsSVGEffects.cpp \
 		SVGFEContainerFrame.cpp \
 		SVGFEImageFrame.cpp \
diff --git a/layout/tables/Makefile.in b/layout/tables/Makefile.in
--- a/layout/tables/Makefile.in
+++ b/layout/tables/Makefile.in
@@ -9,17 +9,20 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gktable_s
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
-
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
 
 CPPSRCS		= \
 		BasicTableLayoutStrategy.cpp \
 		FixedTableLayoutStrategy.cpp \
 		SpanningCellSorter.cpp \
 		nsCellMap.cpp \
 		nsTableCellFrame.cpp \
 		nsTableColFrame.cpp \
diff --git a/layout/tools/layout-debug/src/Makefile.in b/layout/tools/layout-debug/src/Makefile.in
--- a/layout/tools/layout-debug/src/Makefile.in
+++ b/layout/tools/layout-debug/src/Makefile.in
@@ -12,16 +12,20 @@ include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gkdebug
 EXPORT_LIBRARY	= 1
 IS_COMPONENT	= 1
 MODULE_NAME	= nsLayoutDebugModule
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
 
 CPPSRCS		= \
 		nsDebugFactory.cpp \
 		nsLayoutDebugCLH.cpp \
 		nsLayoutDebuggingTools.cpp \
 		nsRegressionTester.cpp \
 		$(NULL)
 
diff --git a/layout/xul/base/src/Makefile.in b/layout/xul/base/src/Makefile.in
--- a/layout/xul/base/src/Makefile.in
+++ b/layout/xul/base/src/Makefile.in
@@ -8,16 +8,21 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gkxulbase_s
 LIBXUL_LIBRARY	= 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
+
 CPPSRCS		= \
 		nsScrollBoxFrame.cpp \
 		nsRootBoxFrame.cpp \
 		nsBox.cpp \
 		nsBoxFrame.cpp \
 		nsBoxLayoutState.cpp \
 		nsSprocketLayout.cpp \
 		nsStackFrame.cpp \
diff --git a/layout/xul/grid/Makefile.in b/layout/xul/grid/Makefile.in
--- a/layout/xul/grid/Makefile.in
+++ b/layout/xul/grid/Makefile.in
@@ -9,16 +9,21 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gkxulgrid_s
 LIBXUL_LIBRARY  = 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
+
 CPPSRCS	= \
         nsGridLayout2.cpp \
         nsGridRowLayout.cpp \
         nsGridRowLeafLayout.cpp \
         nsGridRowLeafFrame.cpp \
         nsGridRowGroupLayout.cpp \
         nsGridRowGroupFrame.cpp \
         nsGrid.cpp \
diff --git a/layout/xul/tree/Makefile.in b/layout/xul/tree/Makefile.in
--- a/layout/xul/tree/Makefile.in
+++ b/layout/xul/tree/Makefile.in
@@ -9,16 +9,21 @@ srcdir		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 LIBRARY_NAME	= gkxultree_s
 LIBXUL_LIBRARY  = 1
 FAIL_ON_WARNINGS = 1
 
+ifdef GNU_CC
+OS_CFLAGS := $(OS_CFLAGS) -Wshadow
+OS_CXXFLAGS := $(OS_CXXFLAGS) -Wshadow
+endif
+
 CPPSRCS		= \
 		nsTreeBodyFrame.cpp \
 		nsTreeBoxObject.cpp \
 		nsTreeColFrame.cpp \
 		nsTreeColumns.cpp \
 		nsTreeContentView.cpp \
 		nsTreeImageListener.cpp \
 		nsTreeSelection.cpp \
