From: L. David Baron <dbaron@dbaron.org>

Set iterators to valid position after deleting overflow lines.  (Bug 534082)

diff --git a/layout/generic/nsBlockFrame.cpp b/layout/generic/nsBlockFrame.cpp
--- a/layout/generic/nsBlockFrame.cpp
+++ b/layout/generic/nsBlockFrame.cpp
@@ -5412,16 +5412,22 @@ nsBlockFrame::DoRemoveFrame(nsIFrame* aD
         Invalidate(lineCombinedArea);
       } else {
         nsLineList* lineList = RemoveOverflowLines();
         line = lineList->erase(line);
         if (!lineList->empty()) {
           SetOverflowLines(lineList);
         } else {
           delete lineList;
+          // We just invalidated our iterators.  Since we were in the
+          // overflow lines list, which is now empty, set them all to
+          // the end of the regular line list.
+          line_start = mLines.begin();
+          line_end = mLines.end();
+          line = line_end;
         }
       }
       cur->Destroy(presShell);
 
       // If we're removing a line, ReflowDirtyLines isn't going to
       // know that it needs to slide lines unless something is marked
       // dirty.  So mark the previous margin of the next line dirty if
       // there is one.
