From: L. David Baron <dbaron@dbaron.org>

Make lines and empty blocks with which a bullet from a parent line is aligned have their heights, baselines, and emptiness adjusted appropriately.  (Bug 179596)

diff --git a/layout/generic/nsBlockFrame.cpp b/layout/generic/nsBlockFrame.cpp
--- a/layout/generic/nsBlockFrame.cpp
+++ b/layout/generic/nsBlockFrame.cpp
@@ -1106,16 +1106,21 @@ nsBlockFrame::Reflow(nsPresContext*     
   if (HasOutsideBullet() && !mLines.empty() &&
       (mLines.front()->IsBlock() ||
        (0 == mLines.front()->mBounds.height &&
         mLines.front() != mLines.back() &&
         mLines.begin().next()->IsBlock()))) {
     // Reflow the bullet
     nsHTMLReflowMetrics metrics;
     // XXX Use the entire line when we fix bug 25888.
+    // FIXME: We really need to compute the size here *before* reflowing
+    // the block child, and then that block child needs to act as though
+    // this line was its bullet (in terms of the size **and emptiness**
+    // changes associated with all three ReflowBullet calls; see the
+    // other patches in bug 179596).
     nsLayoutUtils::LinePosition position;
     bool havePosition = nsLayoutUtils::GetFirstLinePosition(this, &position);
     nscoord lineTop = havePosition ? position.mTop
                                    : reflowState->mComputedBorderPadding.top;
     nsIFrame* bullet = GetOutsideBullet();
     ReflowBullet(bullet, state, metrics, lineTop);
     NS_ASSERTION(!BulletIsEmpty() || metrics.height == 0,
                  "empty bullet took up space");
