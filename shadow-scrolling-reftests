From: L. David Baron <dbaron@dbaron.org>

Add reftests for text-shadow and box-shadow not causing scrollable overflow.  (Bug 542595, patch 24) (for bug 446693)

diff --git a/layout/reftests/box-shadow/overflow-not-scrollable-1-ref.html b/layout/reftests/box-shadow/overflow-not-scrollable-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/box-shadow/overflow-not-scrollable-1-ref.html
@@ -0,0 +1,15 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px; overflow: hidden;
+  font-size: 50px;
+}
+span {
+  box-shadow: 210px 210px 2px gray;
+}
+
+</style>
+<div>
+<span>text</span>
+</div>
diff --git a/layout/reftests/box-shadow/overflow-not-scrollable-1-ref2.html b/layout/reftests/box-shadow/overflow-not-scrollable-1-ref2.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/box-shadow/overflow-not-scrollable-1-ref2.html
@@ -0,0 +1,12 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px;
+  font-size: 50px;
+}
+
+</style>
+<div>
+<span>text</span>
+</div>
diff --git a/layout/reftests/box-shadow/overflow-not-scrollable-1.html b/layout/reftests/box-shadow/overflow-not-scrollable-1.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/box-shadow/overflow-not-scrollable-1.html
@@ -0,0 +1,15 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px; overflow: auto;
+  font-size: 50px;
+}
+span {
+  box-shadow: 210px 210px 2px gray;
+}
+
+</style>
+<div>
+<span>text</span>
+</div>
diff --git a/layout/reftests/box-shadow/overflow-not-scrollable-2-ref.html b/layout/reftests/box-shadow/overflow-not-scrollable-2-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/box-shadow/overflow-not-scrollable-2-ref.html
@@ -0,0 +1,16 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px; overflow: hidden;
+  font-size: 50px;
+  font-weight: bold;
+}
+span {
+  box-shadow: 100px 100px 30px black;
+ }
+
+</style>
+<div>
+<span>text</span>
+</div>
diff --git a/layout/reftests/box-shadow/overflow-not-scrollable-2.html b/layout/reftests/box-shadow/overflow-not-scrollable-2.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/box-shadow/overflow-not-scrollable-2.html
@@ -0,0 +1,16 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px; overflow: auto;
+  font-size: 50px;
+  font-weight: bold;
+}
+span {
+  box-shadow: 100px 100px 30px black;
+}
+
+</style>
+<div>
+<span>text</span>
+</div>
diff --git a/layout/reftests/box-shadow/reftest.list b/layout/reftests/box-shadow/reftest.list
--- a/layout/reftests/box-shadow/reftest.list
+++ b/layout/reftests/box-shadow/reftest.list
@@ -12,8 +12,12 @@
 == boxshadow-button.html boxshadow-button-ref.html
 == boxshadow-fileupload.html boxshadow-fileupload-ref.html
 == boxshadow-inner-basic.html boxshadow-inner-basic-ref.svg
 random-if(layersGPUAccelerated) == boxshadow-mixed.html boxshadow-mixed-ref.html
 random-if(d2d) == boxshadow-rounded-spread.html boxshadow-rounded-spread-ref.html
 HTTP(..) == boxshadow-dynamic.xul boxshadow-dynamic-ref.xul
 random-if(d2d) == boxshadow-onecorner.html boxshadow-onecorner-ref.html
 == boxshadow-skiprect.html boxshadow-skiprect-ref.html
+
+== overflow-not-scrollable-1.html overflow-not-scrollable-1-ref.html
+== overflow-not-scrollable-1.html overflow-not-scrollable-1-ref2.html
+== overflow-not-scrollable-2.html overflow-not-scrollable-2-ref.html
diff --git a/layout/reftests/text-shadow/overflow-not-scrollable-1-ref.html b/layout/reftests/text-shadow/overflow-not-scrollable-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/text-shadow/overflow-not-scrollable-1-ref.html
@@ -0,0 +1,13 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px; overflow: hidden;
+  text-shadow: 210px 210px 2px gray;
+  font-size: 50px;
+}
+
+</style>
+<div>
+text
+</div>
diff --git a/layout/reftests/text-shadow/overflow-not-scrollable-1-ref2.html b/layout/reftests/text-shadow/overflow-not-scrollable-1-ref2.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/text-shadow/overflow-not-scrollable-1-ref2.html
@@ -0,0 +1,12 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px;
+  font-size: 50px;
+}
+
+</style>
+<div>
+text
+</div>
diff --git a/layout/reftests/text-shadow/overflow-not-scrollable-1.html b/layout/reftests/text-shadow/overflow-not-scrollable-1.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/text-shadow/overflow-not-scrollable-1.html
@@ -0,0 +1,13 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px; overflow: auto;
+  text-shadow: 210px 210px 2px gray;
+  font-size: 50px;
+}
+
+</style>
+<div>
+text
+</div>
diff --git a/layout/reftests/text-shadow/overflow-not-scrollable-2-ref.html b/layout/reftests/text-shadow/overflow-not-scrollable-2-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/text-shadow/overflow-not-scrollable-2-ref.html
@@ -0,0 +1,14 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px; overflow: hidden;
+  text-shadow: 100px 100px 30px black;
+  font-size: 50px;
+  font-weight: bold;
+}
+
+</style>
+<div>
+text
+</div>
diff --git a/layout/reftests/text-shadow/overflow-not-scrollable-2.html b/layout/reftests/text-shadow/overflow-not-scrollable-2.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/text-shadow/overflow-not-scrollable-2.html
@@ -0,0 +1,14 @@
+<!DOCTYPE HTML>
+<style type="text/css">
+
+div {
+  height: 200px; width: 200px; overflow: auto;
+  text-shadow: 100px 100px 30px black;
+  font-size: 50px;
+  font-weight: bold;
+}
+
+</style>
+<div>
+text
+</div>
diff --git a/layout/reftests/text-shadow/reftest.list b/layout/reftests/text-shadow/reftest.list
--- a/layout/reftests/text-shadow/reftest.list
+++ b/layout/reftests/text-shadow/reftest.list
@@ -12,8 +12,11 @@
 == decorations-multiple-zorder.html decorations-multiple-zorder-ref.html
 == multiple-noblur.html multiple-noblur-ref.html
 == quirks-decor-noblur.html quirks-decor-noblur-ref.html
 == standards-decor-noblur.html standards-decor-noblur-ref.html
 == padding-decoration.html padding-decoration-ref.html
 == textindent.html textindent-ref.html
 == lineoverflow.html lineoverflow-ref.html
 
+== overflow-not-scrollable-1.html overflow-not-scrollable-1-ref.html
+== overflow-not-scrollable-1.html overflow-not-scrollable-1-ref2.html
+== overflow-not-scrollable-2.html overflow-not-scrollable-2-ref.html
