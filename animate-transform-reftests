From: L. David Baron <dbaron@dbaron.org>

Bug 1156456 patch 1 - Reftests.

diff --git a/layout/reftests/transform-3d/animate-cube-ref.html b/layout/reftests/transform-3d/animate-cube-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/transform-3d/animate-cube-ref.html
@@ -0,0 +1,46 @@
+<!DOCTYPE HTML>
+<html>
+<title>Reftest, bug 1156456</title>
+<style>
+
+html, body {
+  height: 100%;
+}
+
+body {
+  background: white;
+  perspective: 1000px;
+}
+
+div, div::before, div::after {
+  width: 200px; height: 200px;
+}
+
+div {
+  position: absolute;
+  top: 0; right: 0; bottom: 0; left: 0;
+  margin: auto;
+  transform-origin: 50% 50% 100px;
+  background: #006;
+  transform: rotateY(-120deg) rotateX(60deg);
+  transform-style: preserve-3d;
+}
+
+div::before, div::after {
+  position: absolute;
+  top: 0; left: 0;
+  content: "";
+}
+
+div::before {
+  background: #00f;
+  transform: translate3D(100px, 0, 100px) rotateY(90deg);
+}
+
+div::after {
+  transform: translate3D(0, -100px, 100px) rotateX(90deg);
+  background: #00c;
+}
+
+</style>
+<div></div>
diff --git a/layout/reftests/transform-3d/animate-cube-zoom-ref.html b/layout/reftests/transform-3d/animate-cube-zoom-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/transform-3d/animate-cube-zoom-ref.html
@@ -0,0 +1,46 @@
+<!DOCTYPE HTML>
+<html reftest-zoom="1.5">
+<title>Reftest, bug 1156456</title>
+<style>
+
+html, body {
+  height: 100%;
+}
+
+body {
+  background: white;
+  perspective: 1000px;
+}
+
+div, div::before, div::after {
+  width: 200px; height: 200px;
+}
+
+div {
+  position: absolute;
+  top: 0; right: 0; bottom: 0; left: 0;
+  margin: auto;
+  transform-origin: 50% 50% 100px;
+  background: #006;
+  transform: rotateY(-120deg) rotateX(60deg);
+  transform-style: preserve-3d;
+}
+
+div::before, div::after {
+  position: absolute;
+  top: 0; left: 0;
+  content: "";
+}
+
+div::before {
+  background: #00f;
+  transform: translate3D(100px, 0, 100px) rotateY(90deg);
+}
+
+div::after {
+  transform: translate3D(0, -100px, 100px) rotateX(90deg);
+  background: #00c;
+}
+
+</style>
+<div></div>
diff --git a/layout/reftests/transform-3d/animate-cube-zoom.html b/layout/reftests/transform-3d/animate-cube-zoom.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/transform-3d/animate-cube-zoom.html
@@ -0,0 +1,52 @@
+<!DOCTYPE HTML>
+<html reftest-zoom="1.5">
+<title>Reftest, bug 1156456</title>
+<style>
+
+html, body {
+  height: 100%;
+}
+
+body {
+  background: white;
+  perspective: 1000px;
+}
+
+div, div::before, div::after {
+  width: 200px; height: 200px;
+}
+
+@keyframes HoldTransform {
+  from, to {
+    transform: rotateY(-120deg) rotateX(60deg);
+  }
+}
+
+div {
+  position: absolute;
+  top: 0; right: 0; bottom: 0; left: 0;
+  margin: auto;
+  transform-origin: 50% 50% 100px;
+  background: #006;
+  transform-style: preserve-3d;
+  animation: 10s HoldTransform infinite;
+}
+
+div::before, div::after {
+  position: absolute;
+  top: 0; left: 0;
+  content: "";
+}
+
+div::before {
+  background: #00f;
+  transform: translate3D(100px, 0, 100px) rotateY(90deg);
+}
+
+div::after {
+  transform: translate3D(0, -100px, 100px) rotateX(90deg);
+  background: #00c;
+}
+
+</style>
+<div></div>
diff --git a/layout/reftests/transform-3d/animate-cube.html b/layout/reftests/transform-3d/animate-cube.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/transform-3d/animate-cube.html
@@ -0,0 +1,52 @@
+<!DOCTYPE HTML>
+<html>
+<title>Reftest, bug 1156456</title>
+<style>
+
+html, body {
+  height: 100%;
+}
+
+body {
+  background: white;
+  perspective: 1000px;
+}
+
+div, div::before, div::after {
+  width: 200px; height: 200px;
+}
+
+@keyframes HoldTransform {
+  from, to {
+    transform: rotateY(-120deg) rotateX(60deg);
+  }
+}
+
+div {
+  position: absolute;
+  top: 0; right: 0; bottom: 0; left: 0;
+  margin: auto;
+  transform-origin: 50% 50% 100px;
+  background: #006;
+  transform-style: preserve-3d;
+  animation: 10s HoldTransform infinite;
+}
+
+div::before, div::after {
+  position: absolute;
+  top: 0; left: 0;
+  content: "";
+}
+
+div::before {
+  background: #00f;
+  transform: translate3D(100px, 0, 100px) rotateY(90deg);
+}
+
+div::after {
+  transform: translate3D(0, -100px, 100px) rotateX(90deg);
+  background: #00c;
+}
+
+</style>
+<div></div>
diff --git a/layout/reftests/transform-3d/reftest.list b/layout/reftests/transform-3d/reftest.list
--- a/layout/reftests/transform-3d/reftest.list
+++ b/layout/reftests/transform-3d/reftest.list
@@ -52,8 +52,11 @@ fuzzy-if(winWidget&&!layersGPUAccelerate
 == rotatex-transformorigin-1a.html rotatex-transformorigin-1-ref.html
 fuzzy-if((gtk2Widget&&layersOMTC)||(winWidget&&!layersGPUAccelerated),1,86) == overflow-hidden-1a.html overflow-hidden-1-ref.html
 == transform-style-flat-1a.html transform-style-flat-1-ref.html
 pref(layout.css.will-change.enabled,true) == willchange-containing-block.html?willchange willchange-containing-block.html?ref
 pref(layout.css.will-change.enabled,true) != willchange-containing-block.html?willchange willchange-containing-block.html?noblock
 fuzzy-if(winWidget&&!layersGPUAccelerated,1,606) == scroll-perspective-1.html scroll-perspective-1-ref.html
 # Bugs
 fails-if(!layersGPUAccelerated) == 1035611-1.html 1035611-1-ref.html # Bug 1072898 for !layersGPUAccelerated failures
+== animate-cube.html animate-cube-ref.html
+== animate-cube-zoom.html animate-cube-zoom-ref.html
+!= animate-cube-ref.html animate-cube-zoom-ref.html
