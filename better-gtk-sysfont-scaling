From: L. David Baron <dbaron@dbaron.org>

[mq]: better-gtk-sysfont-scaling

Test with things like:
  gsettings set org.gnome.desktop.interface scaling-factor 2
though that works with the current code.

MozReview-Commit-ID: 6om3Mi4r1uu

diff --git a/widget/gtk/nsLookAndFeel.cpp b/widget/gtk/nsLookAndFeel.cpp
--- a/widget/gtk/nsLookAndFeel.cpp
+++ b/widget/gtk/nsLookAndFeel.cpp
@@ -929,16 +929,21 @@ GetSystemFontInfo(GtkWidget *aWidget,
     if (!pango_font_description_get_size_is_absolute(desc)) {
         // |size| is in pango-points, so convert to pixels.
         size *= float(gfxPlatformGtk::GetFontScaleDPI()) / POINTS_PER_INCH_FLOAT;
     }
 
     // Scale fonts up on HiDPI displays.
     // This would be done automatically with cairo, but we manually manage
     // the display scale for platform consistency.
+    // FIXME: Should this be using gtk_widget_get_scale_factor or
+    // gdk_window_get_scale_factor instead of
+    // gdk_screen_get_monitor_scale_factor?
+    // FIXME: It makes more sense for this to be before the previous
+    // multiplication.
     size *= ScreenHelperGTK::GetGTKMonitorScaleFactor();
 
     // |size| is now pixels
 
     aFontStyle->size = size;
 
     pango_font_description_free(desc);
 }
