From: L. David Baron <dbaron@dbaron.org>

Bug 1388840 - Proposed scope changes for https://github.com/w3c/csswg-drafts/issues/765 .

MozReview-Commit-ID: 10oPZfNNWpX

diff --git a/layout/base/nsLayoutUtils.cpp b/layout/base/nsLayoutUtils.cpp
--- a/layout/base/nsLayoutUtils.cpp
+++ b/layout/base/nsLayoutUtils.cpp
@@ -4944,16 +4944,18 @@ static int32_t gNoiseIndent = 0;
 // Return true for form controls whose minimum intrinsic inline-size
 // shrinks to 0 when they have a percentage inline-size (but not
 // percentage max-inline-size).  (Proper replaced elements, whose
 // intrinsic minimium inline-size shrinks to 0 for both percentage
 // inline-size and percentage max-inline-size, are handled elsewhere.)
 inline static bool
 FormControlShrinksForPercentISize(nsIFrame* aFrame)
 {
+  // FIXME: change something here?
+
   if (!aFrame->IsFrameOfType(nsIFrame::eReplaced)) {
     // Quick test to reject most frames.
     return false;
   }
 
   LayoutFrameType fType = aFrame->Type();
   if (fType == LayoutFrameType::Meter || fType == LayoutFrameType::Progress) {
     // progress and meter do have this shrinking behavior
@@ -5043,20 +5045,19 @@ AddIntrinsicSizeOffset(gfxContext* aRend
   min += coordOutsideSize;
   result = NSCoordSaturatingAdd(result, coordOutsideSize);
   pctTotal += pctOutsideSize;
 
   const bool shouldAddPercent = aType == nsLayoutUtils::PREF_ISIZE ||
                                 (aFlags & nsLayoutUtils::ADD_PERCENTS);
   nscoord size;
   if (aType == nsLayoutUtils::MIN_ISIZE &&
-      (((aStyleSize.HasPercent() || aStyleMaxSize.HasPercent()) &&
-        aFrame->IsFrameOfType(nsIFrame::eReplacedSizing)) ||
-       (aStyleSize.HasPercent() &&
-        FormControlShrinksForPercentISize(aFrame)))) {
+      (aStyleSize.HasPercent() || aStyleMaxSize.HasPercent()) &&
+      (aFrame->IsFrameOfType(nsIFrame::eReplacedSizing) ||
+       FormControlShrinksForPercentISize(aFrame))) {
     // A percentage width or max-width on replaced elements means they
     // can shrink to 0.
     // This is also true for percentage widths (but not max-widths) on
     // text inputs.
     // Note that if this is max-width, this overrides the fixed-width
     // rule in the next condition.
 
     // If this is a calc() expression with a percent, we only want the
