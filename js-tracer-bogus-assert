From: L. David Baron <dbaron@dbaron.org>

Work around bogus JS_ASSERT.  (Bug 591418)

diff --git a/js/src/jstracer.cpp b/js/src/jstracer.cpp
--- a/js/src/jstracer.cpp
+++ b/js/src/jstracer.cpp
@@ -9884,17 +9884,18 @@ TraceRecorder::unbox_int_id(LIns *id_ins
 {
     return lir->ins2ImmI(LIR_rshi, p2i(id_ins), 1);
 }
 
 JS_REQUIRES_STACK RecordingStatus
 TraceRecorder::getThis(LIns*& this_ins)
 {
     JSStackFrame *fp = cx->fp();
-    JS_ASSERT_IF(fp->argv, fp->argv[-1] == fp->getThisValue());
+    JS_ASSERT_IF(fp->argv && !fp->getThisValue().isNull(),
+                 fp->argv[-1] == fp->getThisValue());
 
     if (!fp->hasFunction()) {
         // Top-level code. It is an invariant of the interpreter that fp->thisv
         // is non-null. Furthermore, we would not be recording if globalObj
         // were not at the end of the scope chain, so `this` can only be one
         // object, which we can burn into the trace.
 
         JS_ASSERT(!fp->argv);
