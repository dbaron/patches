From: L. David Baron <dbaron@dbaron.org>

Only call GetFromExtension if we have an extension.  (Bug 523672)

diff --git a/uriloader/exthandler/unix/nsMIMEInfoUnix.cpp b/uriloader/exthandler/unix/nsMIMEInfoUnix.cpp
--- a/uriloader/exthandler/unix/nsMIMEInfoUnix.cpp
+++ b/uriloader/exthandler/unix/nsMIMEInfoUnix.cpp
@@ -74,18 +74,20 @@ nsMIMEInfoUnix::LoadUriInternal(nsIURI *
 
 NS_IMETHODIMP
 nsMIMEInfoUnix::GetHasDefaultHandler(PRBool *_retval)
 {
   *_retval = PR_FALSE;
   nsRefPtr<nsMIMEInfoBase> mimeInfo = nsGNOMERegistry::GetFromType(mType);
   if (!mimeInfo) {
     nsCAutoString ext;
-    GetPrimaryExtension(ext);
-    mimeInfo = nsGNOMERegistry::GetFromExtension(ext);
+    nsresult rv = GetPrimaryExtension(ext);
+    if (NS_SUCCEEDED(rv)) {
+      mimeInfo = nsGNOMERegistry::GetFromExtension(ext);
+    }
   }
   if (mimeInfo)
     *_retval = PR_TRUE;
 
   if (*_retval)
     return NS_OK;
 
 #ifdef MOZ_PLATFORM_HILDON
