From: L. David Baron <dbaron@dbaron.org>

Bug 1106324 - Call removeLock in case where the call was missing.

While I was debugging bug 1105511, khuey noticed that one case was
missing a removeLock call.  We should add it; it seems like if we ever
hit this error case, the settings lock queue would get stuck.  It's not
clear whether this is actually the cause of bug 1105511, so I'm putting
it in a separate bug.

diff --git a/dom/settings/SettingsRequestManager.jsm b/dom/settings/SettingsRequestManager.jsm
--- a/dom/settings/SettingsRequestManager.jsm
+++ b/dom/settings/SettingsRequestManager.jsm
@@ -451,16 +451,17 @@ let SettingsRequestManager = {
       if (DEBUG) debug("Nothing to finalize. Exiting.");
       this.removeLock(data.lockID);
       return Promise.resolve({task: aTask});
     }
 
     let store = lock.getObjectStore(aTask.principal);
     if (!store) {
       if (DEBUG) debug("Rejecting Set task on lock " + aTask.data.lockID);
+      this.removeLock(data.lockID);
       return Promise.reject({task: aTask, error: "Cannot get object store"});
     }
 
     // Due to the fact there may have multiple set operations to clear, and
     // they're all async, callbacks are gathered into promises, and the promises
     // are processed with Promises.all().
     let checkPromises = [];
     let finalValues = {};
