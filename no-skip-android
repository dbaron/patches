From: L. David Baron <dbaron@dbaron.org>

Bug 986406 - Don't skip entire reftest directories on Android.  r=roc

diff --git a/layout/reftests/border-image/reftest.list b/layout/reftests/border-image/reftest.list
--- a/layout/reftests/border-image/reftest.list
+++ b/layout/reftests/border-image/reftest.list
@@ -10,18 +10,18 @@
 == transparent-image-1.html transparent-image-1-ref.html
 != repeat-image-1.html repeat-image-1-ref.html
 == 470250-1.html 470250-1-ref.html
 == 470250-2.html 470250-2-ref.html
 != different-h-v-1.html different-h-v-ref.html
 != different-h-v-2.html different-h-v-ref.html
 != different-h-v-1.html different-h-v-2.html
 == center-scaling-1.html center-scaling-1-ref.html
-== center-scaling-2.html center-scaling-2-ref.html
-== center-scaling-3.html center-scaling-3-ref.html
+fails-if(Android) == center-scaling-2.html center-scaling-2-ref.html # very different scaling (blurriness) on some sides
+fails-if(Android) == center-scaling-3.html center-scaling-3-ref.html # very different scaling (blurriness) on some sides
 == center-scaling-4t.html center-scaling-4t-ref.html
 == center-scaling-4r.html center-scaling-4r-ref.html
 == center-scaling-4b.html center-scaling-4b-ref.html
 == center-scaling-4l.html center-scaling-4l-ref.html
 == center-scaling-4tb.html center-scaling-4tb-ref.html
 == center-scaling-4lr.html center-scaling-4lr-ref.html
 == side-scaling-1h.html side-scaling-1h-ref.html
 == side-scaling-1v.html side-scaling-1v-ref.html
diff --git a/layout/reftests/box-shadow/reftest.list b/layout/reftests/box-shadow/reftest.list
--- a/layout/reftests/box-shadow/reftest.list
+++ b/layout/reftests/box-shadow/reftest.list
@@ -1,13 +1,13 @@
 == boxshadow-basic.html boxshadow-basic-ref.html
 != boxshadow-blur.html boxshadow-blur-notref.html
 != boxshadow-blur.html boxshadow-blur-notref2.html
 random == boxshadow-blur-2.html boxshadow-blur-2-ref.html # fixedpoint division in blur code makes this fail
-random fails-if(Android) != boxshadow-blur-2.html boxshadow-blur-2-notref.html # fixedpoint division in blur code makes this fail
+random != boxshadow-blur-2.html boxshadow-blur-2-notref.html # fixedpoint division in blur code makes this fail
 == boxshadow-multiple.html boxshadow-multiple-ref.html
 == boxshadow-spread.html boxshadow-spread-ref.html
 == tableboxshadow-basic.html tableboxshadow-basic-ref.html
 == tableboxshadow-trshadow.html tableboxshadow-trshadow-ref.html
 == tableboxshadow-tdshadow.html tableboxshadow-tdshadow-ref.html
 == boxshadow-rounding.html boxshadow-rounding-ref.html
 fails-if(Android) == boxshadow-button.html boxshadow-button-ref.html
 fails-if(Android) == boxshadow-fileupload.html boxshadow-fileupload-ref.html
diff --git a/layout/reftests/css-disabled/select/reftest.list b/layout/reftests/css-disabled/select/reftest.list
--- a/layout/reftests/css-disabled/select/reftest.list
+++ b/layout/reftests/css-disabled/select/reftest.list
@@ -1,9 +1,9 @@
 == select-fieldset-1.html select-fieldset-ref.html
 fails-if(Android) == select-fieldset-2.html select-fieldset-ref-disabled.html
 fails-if(Android) == select-fieldset-3.html select-fieldset-ref-disabled.html
-fails-if(Android) == select-fieldset-4.html select-fieldset-ref.html
+== select-fieldset-4.html select-fieldset-ref.html
 == select-fieldset-legend-1.html select-fieldset-legend-ref-1.html
 fails-if(Android) == select-fieldset-legend-2.html select-fieldset-legend-ref-2.html
 fails-if(Android) == select-fieldset-legend-3.html select-fieldset-legend-ref-3.html
 == select-fieldset-legend-4.html select-fieldset-legend-ref-4.html
 == select-fieldset-legend-5.html select-fieldset-legend-ref-5.html
diff --git a/layout/reftests/first-letter/reftest.list b/layout/reftests/first-letter/reftest.list
--- a/layout/reftests/first-letter/reftest.list
+++ b/layout/reftests/first-letter/reftest.list
@@ -18,17 +18,17 @@ fails == quote-1b.html quote-1-ref.html 
 fails == quote-1c.html quote-1-ref.html # bug 509685
 == quote-1c.html quote-1b.html
 fails == quote-1d.html quote-1-ref.html
 == quote-1d.html quote-1b.html
 fails == quote-1e.html quote-1-ref.html # bug 509685
 == quote-1e.html quote-1b.html
 == quote-1f.html quote-1-ref.html
 fails == dynamic-1.html dynamic-1-ref.html # bug 8253
-fails-if(Android) random-if(d2d) == dynamic-2.html dynamic-2-ref.html
+random-if(d2d) == dynamic-2.html dynamic-2-ref.html
 == dynamic-3a.html dynamic-3-ref.html
 == dynamic-3b.html dynamic-3-ref.html
 == 23605-1.html 23605-1-ref.html
 == 23605-2.html 23605-2-ref.html
 == 23605-3.html 23605-3-ref.html
 == 23605-4.html 23605-4-ref.html
 == 23605-5.html 23605-5-ref.html
 == 23605-6.html 23605-6-ref.html
diff --git a/layout/reftests/forms/button/reftest.list b/layout/reftests/forms/button/reftest.list
--- a/layout/reftests/forms/button/reftest.list
+++ b/layout/reftests/forms/button/reftest.list
@@ -1,19 +1,19 @@
 asserts(2) == first-letter-1.html first-letter-1-ref.html
 asserts(1) != first-letter-1.html first-letter-1-noref.html
 == max-height.html max-height-ref.html
 == min-height.html min-height-ref.html
 
 # The buttons in these tests have some fancy shading applied to their corners
 # on B2G, despite their "-moz-appearance: none; background: gray", so they
 # don't quite match the reference case's normal <div>. That's why they're fuzzy.
-fuzzy-if(B2G,125,20) == percent-height-child-1.html percent-height-child-1-ref.html
-fuzzy-if(B2G,125,80) == percent-height-child-2.html percent-height-child-2-ref.html
-fuzzy-if(B2G,125,20) == percent-width-child-1.html  percent-width-child-1-ref.html
-fuzzy-if(B2G,125,80) == percent-width-child-2.html  percent-width-child-2-ref.html
+fuzzy-if(B2G||Android,125,20) == percent-height-child-1.html percent-height-child-1-ref.html
+fuzzy-if(B2G||Android,125,80) == percent-height-child-2.html percent-height-child-2-ref.html
+fuzzy-if(B2G||Android,125,20) == percent-width-child-1.html  percent-width-child-1-ref.html
+fuzzy-if(B2G||Android,125,80) == percent-width-child-2.html  percent-width-child-2-ref.html
 
 == vertical-centering.html vertical-centering-ref.html
 
 != line-height-button-0.5.html line-height-button-1.0.html
 != line-height-button-1.5.html line-height-button-1.0.html
 != line-height-input-0.5.html line-height-input-1.0.html
 != line-height-input-1.5.html line-height-input-1.0.html
diff --git a/layout/reftests/forms/input/file/reftest.list b/layout/reftests/forms/input/file/reftest.list
--- a/layout/reftests/forms/input/file/reftest.list
+++ b/layout/reftests/forms/input/file/reftest.list
@@ -1,8 +1,8 @@
 # B2G failures: bug 855352.
-fails-if(B2G) fuzzy-if(OSX==10.6,8,128) skip-if(B2G&&browserIsRemote) == simple.html simple-ref.xul # bug 974780
-fails-if(B2G) fuzzy-if(OSX==10.6,8,64) skip-if(B2G&&browserIsRemote) == rtl.html rtl-ref.xul # bug 974780
-fails-if(B2G) fuzzy-if(OSX==10.6,8,128) skip-if(B2G&&browserIsRemote) == size.html simple-ref.xul # bug 974780
-fails-if(B2G) fuzzy-if(OSX==10.6,8,64) skip-if(B2G&&browserIsRemote) == background.html background-ref.xul # bug 974780
-fails-if(B2G)  skip-if(B2G&&browserIsRemote) == style.html style-ref.xul # bug 974780
+fails-if(B2G||Android) fuzzy-if(OSX==10.6,8,128) skip-if(B2G&&browserIsRemote) == simple.html simple-ref.xul # bug 974780
+fails-if(B2G||Android) fuzzy-if(OSX==10.6,8,64) skip-if(B2G&&browserIsRemote) == rtl.html rtl-ref.xul # bug 974780
+fails-if(B2G||Android) fuzzy-if(OSX==10.6,8,128) skip-if(B2G&&browserIsRemote) == size.html simple-ref.xul # bug 974780
+fails-if(B2G||Android) fuzzy-if(OSX==10.6,8,64) skip-if(B2G&&browserIsRemote) == background.html background-ref.xul # bug 974780
+fails-if(B2G||Android)  skip-if(B2G&&browserIsRemote) == style.html style-ref.xul # bug 974780
 != width-clip.html width-clip-ref.html
-fails-if(B2G) == color-inherit.html color-inherit-ref.html
+fails-if(B2G||Android) == color-inherit.html color-inherit-ref.html
diff --git a/layout/reftests/forms/input/number/reftest.list b/layout/reftests/forms/input/number/reftest.list
--- a/layout/reftests/forms/input/number/reftest.list
+++ b/layout/reftests/forms/input/number/reftest.list
@@ -19,20 +19,20 @@ fuzzy-if(/^Windows\x20NT\x205\.1/.test(h
 
 # disabled
 == number-disabled.html number-disabled-ref.html
 
 # auto width:
 == number-auto-width-1.html number-auto-width-1-ref.html
 
 # min-height/max-height tests:
-skip-if(B2G) == number-min-height-1.html number-min-height-1-ref.html
-skip-if(B2G) == number-min-height-2.html number-min-height-2-ref.html
-skip-if(B2G) == number-max-height-1.html number-max-height-1-ref.html
-skip-if(B2G) == number-max-height-2.html number-max-height-2-ref.html
+skip-if(B2G||Android) == number-min-height-1.html number-min-height-1-ref.html
+skip-if(B2G||Android) == number-min-height-2.html number-min-height-2-ref.html
+skip-if(B2G||Android) == number-max-height-1.html number-max-height-1-ref.html
+skip-if(B2G||Android) == number-max-height-2.html number-max-height-2-ref.html
 
 # focus
 # autofocus is disabled on B2G
 # https://bugzilla.mozilla.org/show_bug.cgi?id=965763
 skip-if(B2G) needs-focus == focus-handling.html focus-handling-ref.html
 
 # select
 == number-selected.html number-selected-ref.html
diff --git a/layout/reftests/forms/input/range/reftest.list b/layout/reftests/forms/input/range/reftest.list
--- a/layout/reftests/forms/input/range/reftest.list
+++ b/layout/reftests/forms/input/range/reftest.list
@@ -22,12 +22,12 @@
 == stepUp-unthemed.html 75pct-unthemed-common-ref.html
 == stepUp.html 75pct-common-ref.html
 fuzzy-if(B2G,1,1) == max-prop.html 100pct-common-ref.html
 
 # 'direction' property:
 == direction-unthemed-1.html direction-unthemed-1-ref.html
 
 # ::-moz-range-progress pseudo-element:
-fails-if(B2G) == moz-range-progress-1.html moz-range-progress-1-ref.html
+fails-if(B2G||Android) == moz-range-progress-1.html moz-range-progress-1-ref.html
 == moz-range-progress-2.html moz-range-progress-2-ref.html
 == moz-range-progress-3.html moz-range-progress-3-ref.html
 
diff --git a/layout/reftests/forms/meter/reftest.list b/layout/reftests/forms/meter/reftest.list
--- a/layout/reftests/forms/meter/reftest.list
+++ b/layout/reftests/forms/meter/reftest.list
@@ -1,9 +1,9 @@
-== values.html values-ref.html
+fuzzy-if(Android,128,16) == values.html values-ref.html
 == values-rtl.html values-rtl-ref.html
 == margin-padding.html margin-padding-ref.html
 == margin-padding-rtl.html margin-padding-rtl-ref.html
 skip-if(B2G) == bar-pseudo-element.html bar-pseudo-element-ref.html
 == bar-pseudo-element-rtl.html bar-pseudo-element-rtl-ref.html
 
 # vertical tests
 == values-vertical.html values-vertical-ref.html
diff --git a/layout/reftests/native-theme/reftest.list b/layout/reftests/native-theme/reftest.list
--- a/layout/reftests/native-theme/reftest.list
+++ b/layout/reftests/native-theme/reftest.list
@@ -71,12 +71,14 @@ skip-if(!winWidget) == scroll-thumb-mini
 
 == border-radius.html border-radius-ref.html
 
 == checkbox-dynamic-1.html checkbox-dynamic-1-ref.html
 
 # These tests have been written to test the overflow of the window widget
 # (bug 568825) but we can't test it on Windows and Cocoa because they have
 # animated progress bars.
+# Nothing shows up on Android, presumably because that appearance type is
+# not implemented.
 skip-if(cocoaWidget) skip-if(winWidget) == progress-overflow.html progress-overflow-ref.html
-skip-if(cocoaWidget) skip-if(winWidget) != progress-overflow-small.html progress-nobar.html
+fails-if(Android) skip-if(cocoaWidget) skip-if(winWidget) != progress-overflow-small.html progress-nobar.html
 
 == 676387-1.xul 676387-1-ref.xul
diff --git a/layout/reftests/reftest.list b/layout/reftests/reftest.list
--- a/layout/reftests/reftest.list
+++ b/layout/reftests/reftest.list
@@ -20,59 +20,59 @@ skip-if(B2G) include abs-pos/reftest.lis
 
 # backgrounds/
 skip-if(B2G) include backgrounds/reftest.list
 
 # bidi/
 skip-if(B2G) include bidi/reftest.list
 
 # border-image
-skip-if(Android||B2G) include border-image/reftest.list
+skip-if(B2G) include border-image/reftest.list
 
 # border-radius/
 skip-if(B2G) include border-radius/reftest.list
 
 # -moz-box tests
 skip-if(B2G) include box/reftest.list
 
 # box-ordinal/
 skip-if(B2G) include box-ordinal/reftest.list
 
 # box-properties/
 skip-if(B2G) include box-properties/reftest.list
 
 # box-shadow/
-skip-if(Android||B2G) include box-shadow/reftest.list
+skip-if(B2G) include box-shadow/reftest.list
 
 # bugs/
 include bugs/reftest.list
 
 # canvas 2D
 include canvas/reftest.list
 
 # css animations
 include css-animations/reftest.list
 
 # blending/
-skip-if(B2G||Android) include css-blending/reftest.list
+skip-if(B2G) include css-blending/reftest.list
 
 # css calc() tests
 include css-calc/reftest.list
 
 # css character encoding tests
 skip-if(B2G) include css-charset/reftest.list
 
 # css default pseudo class tests
 skip-if(B2G) include css-default/reftest.list
 
 # css :disable tests
-skip-if(Android||B2G) include css-disabled/reftest.list
+skip-if(B2G) include css-disabled/reftest.list
 
 # css :enable tests
-skip-if(Android||B2G) include css-enabled/reftest.list
+skip-if(B2G) include css-enabled/reftest.list
 
 # css @import tests
 skip-if(B2G) include css-import/reftest.list
 
 # css gradients
 include css-gradients/reftest.list
 
 # css media queries (tests for print mode)
@@ -86,38 +86,38 @@ skip-if(B2G) include css-placeholder/ref
 
 # css required
 skip-if(B2G) include css-required/reftest.list
 
 # css optional
 skip-if(B2G) include css-optional/reftest.list
 
 # css valid
-skip-if(Android||B2G) include css-valid/reftest.list
+skip-if(B2G) include css-valid/reftest.list
 
 # css invalid
-skip-if(Android||B2G) include css-invalid/reftest.list
+skip-if(B2G) include css-invalid/reftest.list
 
 # css-submit-invalid
 skip-if(B2G) include css-submit-invalid/reftest.list
 
 # css text-overflow
 skip-if(B2G) include text-overflow/reftest.list
 
 # css selectors
 include css-selectors/reftest.list
 
 # css transitions
 skip-if(B2G) include css-transitions/reftest.list
 
 # css :-moz-ui-invalid
-skip-if(Android||B2G) include css-ui-invalid/reftest.list
+skip-if(B2G) include css-ui-invalid/reftest.list
 
 # css :-moz-ui-valid
-skip-if(Android||B2G) include css-ui-valid/reftest.list
+skip-if(B2G) include css-ui-valid/reftest.list
 
 # css values and units
 skip-if(B2G) include css-valuesandunits/reftest.list
 
 # css variables
 include css-variables/reftest.list
 
 # Reftests in css-visited are run using
@@ -140,17 +140,17 @@ skip-if(B2G) include datalist/reftest.li
 
 # dom/
 skip-if(B2G) include dom/reftest.list
 
 # generated-content/
 skip-if(B2G) include generated-content/reftest.list
 
 # first-letter/
-skip-if(Android||B2G) include first-letter/reftest.list
+skip-if(B2G) include first-letter/reftest.list
 
 # first-line/
 skip-if(B2G) include first-line/reftest.list
 
 # flexbox (display: flex, display: inline-flex)
 include flexbox/reftest.list
 
 # floats/
@@ -164,17 +164,17 @@ skip-if(B2G) include font-features/refte
 
 # mobile font size inflation
 skip-if(B2G&&browserIsRemote) include font-inflation/reftest.list
 
 # font matching
 skip-if(B2G) include font-matching/reftest.list
 
 # forms
-skip-if(Android) include forms/reftest.list
+include forms/reftest.list
 
 # gfx
 include ../../gfx/tests/reftest/reftest.list
 
 # block-inside-inline splits
 skip-if(B2G) include ib-split/reftest.list
 
 # image/
@@ -212,17 +212,17 @@ skip-if(B2G) include mathml/reftest.list
 
 # margin-collapsing
 skip-if(B2G) include margin-collapsing/reftest.list
 
 # marquee/
 skip-if(B2G) include marquee/reftest.list
 
 # native-theme/
-skip-if(Android||B2G) include native-theme/reftest.list
+skip-if(B2G) include native-theme/reftest.list
 
 # netwerk/
 skip-if(B2G) include ../../netwerk/test/reftest/reftest.list
 
 include outline/reftest.list
 
 # object/
 skip-if(B2G) include object/reftest.list
@@ -251,17 +251,17 @@ include position-dynamic-changes/reftest
 # printing
 skip-if(B2G) include printing/reftest.list
 skip-if(B2G) include pagination/reftest.list
 
 # <style scoped>
 skip-if(B2G) include scoped-style/reftest.list
 
 # scrolling 
-skip-if(Android&&AndroidVersion>=15) include scrolling/reftest.list
+include scrolling/reftest.list
 
 # selection
 include selection/reftest.list
 
 # sticky positioning
 include position-sticky/reftest.list
 
 # svg/
@@ -292,17 +292,17 @@ include text/reftest.list
 
 # text-decoration/
 skip-if(B2G) include text-decoration/reftest.list
 
 # text-indent/
 skip-if(B2G) include text-indent/reftest.list
 
 # text-shadow/
-skip-if(Android||B2G) include text-shadow/reftest.list
+skip-if(B2G) include text-shadow/reftest.list
 
 # text-svgglyphs/
 include text-svgglyphs/reftest.list
 
 # text-transform/
 skip-if(B2G) include text-transform/reftest.list
 
 # theme (osx)
diff --git a/layout/reftests/scrolling/reftest.list b/layout/reftests/scrolling/reftest.list
--- a/layout/reftests/scrolling/reftest.list
+++ b/layout/reftests/scrolling/reftest.list
@@ -7,17 +7,17 @@ HTTP == fixed-text-2.html fixed-text-2.h
 random-if(Android&&!browserIsRemote) skip-if(B2G&&browserIsRemote) == iframe-border-radius.html iframe-border-radius-ref.html # bug 760269
 random-if(Android) HTTP == image-1.html image-1.html?ref
 random-if(Android&&!browserIsRemote) HTTP == opacity-mixed-scrolling-1.html opacity-mixed-scrolling-1.html?ref # bug 760269
 skip-if(B2G) random-if(cocoaWidget) HTTP == opacity-mixed-scrolling-2.html opacity-mixed-scrolling-2.html?ref # see bug 625357
 skip-if(B2G&&browserIsRemote) HTTP == simple-1.html simple-1.html?ref
 skip-if(B2G) HTTP == subpixel-1.html#d subpixel-1-ref.html#d
 fuzzy-if(Android,4,120) HTTP == text-1.html text-1.html?ref
 fuzzy-if(Android,4,120) HTTP == text-2.html?up text-2.html?ref
-skip-if(B2G) fuzzy-if(Android&&AndroidVersion<15,251,722) fails-if(Android&&AndroidVersion>=15) HTTP == transformed-1.html transformed-1.html?ref #Bug 900607
+skip-if(B2G) fuzzy-if(Android&&AndroidVersion<15,251,722) HTTP == transformed-1.html transformed-1.html?ref
 HTTP == transformed-1.html?up transformed-1.html?ref
 fuzzy-if(Android,5,20000) == uncovering-1.html uncovering-1-ref.html
 fuzzy-if(Android,5,20000) == uncovering-2.html uncovering-2-ref.html
 skip-if(B2G) == less-than-scrollbar-height.html less-than-scrollbar-height-ref.html
 skip-if(B2G) == huge-horizontal-overflow.html huge-horizontal-overflow-ref.html
 skip-if(B2G) == huge-vertical-overflow.html huge-vertical-overflow-ref.html
 == iframe-scrolling-attr-1.html iframe-scrolling-attr-ref.html
 skip-if(B2G&&browserIsRemote) == iframe-scrolling-attr-2.html iframe-scrolling-attr-ref.html
diff --git a/layout/reftests/text-shadow/reftest.list b/layout/reftests/text-shadow/reftest.list
--- a/layout/reftests/text-shadow/reftest.list
+++ b/layout/reftests/text-shadow/reftest.list
@@ -19,18 +19,18 @@ HTTP(..) == blur-opacity.html blur-opaci
 == textindent.html textindent-ref.html
 == lineoverflow.html lineoverflow-ref.html
 
 == overflow-not-scrollable-1.html overflow-not-scrollable-1-ref.html
 == overflow-not-scrollable-1.html overflow-not-scrollable-1-ref2.html
 == overflow-not-scrollable-2.html overflow-not-scrollable-2-ref.html
 
 needs-focus != text-shadow-selected-1.html text-shadow-selected-1-notref.html
-needs-focus == text-shadow-selected-1.html text-shadow-selected-1-ref.html
+fails-if(Android) needs-focus == text-shadow-selected-1.html text-shadow-selected-1-ref.html # different foreground color on Android
 needs-focus != text-shadow-selected-2.html text-shadow-selected-2-notref.html
-needs-focus == text-shadow-selected-2.html text-shadow-selected-2-ref.html
+fails-if(Android) needs-focus == text-shadow-selected-2.html text-shadow-selected-2-ref.html # different foreground color on Android
 
 # bug 692744
 == text-shadow-on-space-1.html text-shadow-on-space-1-ref.html
 
 # bug 721750
 needs-focus == text-shadow-on-selection-1.html text-shadow-on-selection-1-ref.html
 needs-focus == text-shadow-on-selection-2.html text-shadow-on-selection-2-ref.html
