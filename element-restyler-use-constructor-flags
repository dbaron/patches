From: L. David Baron <dbaron@dbaron.org>

Bug 898209 patch 15:  Use constructor flags on ElementRestyler's regular constructor to avoid manipulating mMinChange from the outside.  r=heycam

This is the second of two patches added on top to address review
comments on patch 2.

diff --git a/layout/base/RestyleManager.cpp b/layout/base/RestyleManager.cpp
--- a/layout/base/RestyleManager.cpp
+++ b/layout/base/RestyleManager.cpp
@@ -1954,16 +1954,19 @@ ElementRestyler::ElementRestyler(const E
   , mHintsNotHandledForDescendants(nsChangeHint(0))
   , mRestyleTracker(aParentRestyler.mRestyleTracker)
   , mTreeMatchContext(aParentRestyler.mTreeMatchContext)
   , mDesiredA11yNotifications(aParentRestyler.mKidsDesiredA11yNotifications)
   , mKidsDesiredA11yNotifications(mDesiredA11yNotifications)
   , mOurA11yNotification(eDontNotify)
   , mVisibleKidsOfHiddenElement(aParentRestyler.mVisibleKidsOfHiddenElement)
 {
+  if (aConstructorFlags & FOR_OUT_OF_FLOW_CHILD) {
+    mMinChange = NS_SubtractHint(mMinChange, nsChangeHint_AllReflowHints);
+  }
 }
 
 ElementRestyler::ElementRestyler(ParentContextFromChildFrame,
                                  const ElementRestyler& aParentRestyler,
                                  nsIFrame* aFrame)
   : mPresContext(aParentRestyler.mPresContext)
   , mFrame(aFrame)
   , mParentContent(aParentRestyler.mParentContent)
@@ -2560,19 +2563,16 @@ ElementRestyler::Restyle(nsRestyleHint a
               // descendant of a frame we already have a reflow hint for,
               // reflow coalescing should keep us from doing the work twice.
 
               // |nsFrame::GetParentStyleContextFrame| checks being out
               // of flow so that this works correctly.
               do {
                 ElementRestyler oofRestyler(*this, outOfFlowFrame,
                                             FOR_OUT_OF_FLOW_CHILD);
-                oofRestyler.mMinChange =
-                  NS_SubtractHint(oofRestyler.mMinChange,
-                                  nsChangeHint_AllReflowHints);
                 oofRestyler.Restyle(childRestyleHint);
               } while ((outOfFlowFrame = outOfFlowFrame->GetNextContinuation()));
 
               // reresolve placeholder's context under the same parent
               // as the out-of-flow frame
               ElementRestyler phRestyler(*this, child, 0);
               phRestyler.Restyle(childRestyleHint);
             }
