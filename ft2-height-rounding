From: L. David Baron <dbaron@dbaron.org>

Compute maxDescent from height and ascender instead of from descender to avoid accumulation of rounding up.  (Bug 604836)

diff --git a/gfx/thebes/gfxFT2Utils.cpp b/gfx/thebes/gfxFT2Utils.cpp
--- a/gfx/thebes/gfxFT2Utils.cpp
+++ b/gfx/thebes/gfxFT2Utils.cpp
@@ -143,16 +143,23 @@ gfxFT2LockedFace::GetMetrics(gfxFont::Me
     gfxFloat lineHeight;
     if (os2 && os2->sTypoAscender) {
         aMetrics->emAscent = os2->sTypoAscender * yScale;
         aMetrics->emDescent = -os2->sTypoDescender * yScale;
         FT_Short typoHeight =
             os2->sTypoAscender - os2->sTypoDescender + os2->sTypoLineGap;
         lineHeight = typoHeight * yScale;
 
+        // Get more accurate values when we can, since freetype has rounded
+        // the values above to the nearest pixel.
+        if (os2->usWinAscent) {
+            aMetrics->maxAscent = os2->usWinAscent * yScale;
+            aMetrics->maxDescent = os2->usWinDescent * yScale;
+        }
+
         // maxAscent/maxDescent get used for frame heights, and some fonts
         // don't have the HHEA table ascent/descent set (bug 279032).
         if (aMetrics->emAscent > aMetrics->maxAscent)
             aMetrics->maxAscent = aMetrics->emAscent;
         if (aMetrics->emDescent > aMetrics->maxDescent)
             aMetrics->maxDescent = aMetrics->emDescent;
     } else {
         aMetrics->emAscent = aMetrics->maxAscent;
