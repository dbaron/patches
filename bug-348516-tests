Add tests for bug 348516.  Test 1 by <arno.@no-log.org>, r=dbaron.  Tests 2 and 3 by me.

diff --git a/layout/reftests/bugs/348516-1-ref.html b/layout/reftests/bugs/348516-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/348516-1-ref.html
@@ -0,0 +1,21 @@
+<html><head>
+ 
+<style>
+
+select {
+    width: 200px;
+}
+option {
+    padding: 0;
+    width: 50%;
+    background-color: cyan;
+}
+</style></head><body>
+
+<select size="3">
+<option style="margin-right: 50%;">left</option>
+<option style="margin-left: 50%;">right</option>
+<option style="margin-left: 25%; margin-right: 25%;">center</option>
+</select>
+
+</body></html>
diff --git a/layout/reftests/bugs/348516-1.html b/layout/reftests/bugs/348516-1.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/348516-1.html
@@ -0,0 +1,21 @@
+<html><head>
+ 
+<style>
+
+select {
+    width: 200px;
+}
+option {
+    padding: 0;
+    width: 50%;
+    background-color: cyan;
+}
+</style></head><body>
+
+<select size="3">
+<option style="margin-right: auto;">left</option>
+<option style="margin-left: auto;">right</option>
+<option style="margin-left: auto; margin-right: auto;">center</option>
+</select>
+
+</body></html>
diff --git a/layout/reftests/bugs/348516-2-notref.html b/layout/reftests/bugs/348516-2-notref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/348516-2-notref.html
@@ -0,0 +1,18 @@
+<html><head>
+ 
+<style>
+
+select {
+    width: 200px;
+}
+option {
+    padding: 0;
+    background-color: cyan;
+}
+</style></head><body>
+
+<select size="3">
+<option>left</option>
+</select>
+
+</body></html>
diff --git a/layout/reftests/bugs/348516-2-ref.html b/layout/reftests/bugs/348516-2-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/348516-2-ref.html
@@ -0,0 +1,19 @@
+<html><head>
+ 
+<style>
+
+select {
+    width: 200px;
+}
+option {
+    padding: 0;
+    width: 50%;
+    background-color: cyan;
+}
+</style></head><body>
+
+<select size="3">
+<option>left</option>
+</select>
+
+</body></html>
diff --git a/layout/reftests/bugs/348516-2.html b/layout/reftests/bugs/348516-2.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/348516-2.html
@@ -0,0 +1,19 @@
+<html><head>
+ 
+<style>
+
+select {
+    width: 200px;
+}
+option {
+    padding: 0;
+    width: 50%;
+    background-color: cyan;
+}
+</style></head><body>
+
+<select size="3">
+<option style="margin-right: 50%;">left</option>
+</select>
+
+</body></html>
diff --git a/layout/reftests/bugs/348516-3-notref.html b/layout/reftests/bugs/348516-3-notref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/348516-3-notref.html
@@ -0,0 +1,19 @@
+<html><head>
+ 
+<style>
+
+select {
+    width: 200px;
+}
+option {
+    padding: 0;
+    width: 50%;
+    background-color: cyan;
+}
+</style></head><body>
+
+<select size="3">
+<option>right</option>
+</select>
+
+</body></html>
diff --git a/layout/reftests/bugs/348516-3.html b/layout/reftests/bugs/348516-3.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/348516-3.html
@@ -0,0 +1,19 @@
+<html><head>
+ 
+<style>
+
+select {
+    width: 200px;
+}
+option {
+    padding: 0;
+    width: 50%;
+    background-color: cyan;
+}
+</style></head><body>
+
+<select size="3">
+<option style="margin-left: 50%;">right</option>
+</select>
+
+</body></html>
diff --git a/layout/reftests/bugs/reftest.list b/layout/reftests/bugs/reftest.list
--- a/layout/reftests/bugs/reftest.list
+++ b/layout/reftests/bugs/reftest.list
@@ -112,6 +112,10 @@ random == 328829-1.xhtml 328829-1-ref.xh
 == 346774-1b.html 346774-1-ref.html
 == 346774-1c.html 346774-1-ref.html
 == 347912-1.html 347912-1-ref.html
+== 348516-1.html 348516-1-ref.html
+== 348516-2.html 348516-2-ref.html
+!= 348516-2.html 348516-2-notref.html
+!= 348516-3.html 348516-3-notref.html
 == 348809-1a.html 348809-1-ref.html
 == 348809-1b.html 348809-1-ref.html
 == 348809-1c.html 348809-1-ref.html
